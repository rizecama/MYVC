<?php
/**
 * @version		1.0.0 camassistant $
 * @package		camassistant
 * @copyright	Copyright © 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');
// Your custom code here

$results = $this->result;
$statename = $this->statename; 
$state_list = $this->state_list;
$phone = explode('-',$results[0]->company_phone);  
$cellphone = explode('-',$results[0]->alt_phone);
$parent_comp_taxid = explode('-',$results[0]->in_house_parent_company_FEIN);
$user = JFactory::getUser();

 JHTML::_('behavior.modal');
/*echo '<pre>';
print_r($phone); exit;
*/$a = explode('(',$results[0]->company_phone);
if($a[1])
{
$b = explode(')',$a[1]);
$c = explode('-',$b[1]);
$phone[0]=$b[0];
$phone[1]=$c[0];
$phone[2]=$c[1];
}
//echo '<pre>'; print_r($a); print_r($b);print_r($c);



/*$user = JFactory::getUser();
$db = JFactory::getDBO();
$db->setQuery("SELECT company_name AS cname, tax_id AS taxid FROM #__cam_vendor_company WHERE user_id=".$user->id);
$results = $db->loadObjectList();
$db->setQuery("SELECT s.id,s.state_name as name FROM `jos_vendor_state_counties` AS sc, jos_state as s WHERE sc.user_id=".$user->id." and sc.state_id=s.id  ");
$states = $db->loadObjectList();
$db->setQuery("SELECT c.id,c.county_name as name FROM `jos_vendor_state_counties` AS sc, jos_county as c WHERE sc.user_id=".$user->id." and sc.state_id=c.id  ");
$counties =  $db->loadObjectList();*/
//$db->setQuery("SELECT s.id,s.city_name FROM `jos_vendor_state_counties` AS sc, jos_state as s WHERE sc.user_id=".$user->id." and sc.state_id=s.id  ");
// if($this->details->image == '') $this->details->image = 'noimage.gif'; 

?>
<script type="text/javascript">

function displayField(field)
{
	if(field == "Yes") 
	{
	  document.getElementById('showparent').style.display="";  
	}
	else
	{  
	  document.getElementById('showparent').style.display="none"; 
	} 
}
function validate_data2()
{

	 var fup = document.getElementById('image'); 
	 var fileName = fup.value; 
	 var ext = fileName.substring(fileName.lastIndexOf('.') + 1);
	 var frm = document.VendorForm2;
	 
	 if(frm.city.value == '')
	 {
		 alert('Please enter city');
		 frm.city.focus();
		 return false;
	 }
	  if(frm.state.value == '')
	 {
		 alert('Please enter state');
		 frm.state.focus();
		 return false;
	 }
	 if(frm.zip.value == '')
	 {
		 alert('Please enter zip');
		 frm.zip.focus();
		 return false;
	 }
	 if(frm.yearestab.value == '')
	 {
		 alert('Please enter year established ');
		 frm.yearestab.focus();
		 return false;
	 }
	 if(frm.phone_1.value == '000' || frm.phone_2.value == '000' || frm.phone_3.value == '0000')
	 {
		 alert('Please enter alternate phone number');
		 if(frm.phone_1.value == '000')
		 {
		 frm.phone_1.value = '';
		 frm.phone_1.focus();
		 return false;
		 }
		 else if(frm.phone_2.value == '000')
		 {
		 frm.phone_2.value = '';
		 frm.phone_2.focus();
		 return false;
		 }
		 else if(frm.phone_3.value == '0000')
		 {
		 frm.phone_3.value = '';
		 frm.phone_3.focus();
		 return false;
		 }
	 }
	 
	 
	 
	 
	 if(fileName != '')
     {
		 if(ext != 'jpg' && ext != 'gif' && ext != 'jpeg' && ext !='bmp' && ext != 'png' )
		  { 
		  alert("Invalid filename, please select another file");
		  return false;
		  }
	  }
	 else if(frm.eaddress.value == '')
	 {
		 alert('Please enter your maining address');
		 frm.eaddress.focus();
		 return false;
	 }
	 var eaddress=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;
	 if(mail.test(frm.eaddress.value)==false)
	 {
		 alert("Please enter the valid email");
		 frm.eaddress.focus();
		 return false;
	 } 
	 else if(frm.city.value == '')
	 {
		 alert('Please enter city');
		 frm.city.focus();
		 return false;
	 }
	 else if(frm.state.value == '')
	 {
		 alert('Please your state');
		 frm.state.focus();
		 return false;
	 }

	 else if(frm.zip.value == '')
	 {
		 alert('Please enter your zipcode');
		 frm.zip.focus();
		 return false;
	 }

	 else if(frm.phone_1.value == '000' || frm.phone_2.value == '000' || frm.phone_3.value == '0000')
	 {
		 alert('Please enter alternate phone number');
		 if(frm.phone_1.value == '000')
		 {
		 frm.phone_1.value = '';
		 frm.phone_1.focus();
		 return false;
		 }
		 else if(frm.phone_2.value == '000')
		 {
		 frm.phone_2.value = '';
		 frm.phone_2.focus();
		 return false;
		 }
		 else if(frm.phone_3.value == '0000')
		 {
		 frm.phone_3.value = '';
		 frm.phone_3.focus();
		 return false;
		 }
	 }
	 else if(document.getElementById('in_house_vendor').checked == true)
 	{
	 if(frm.name.value == '')
	 {
	 alert('Please enter parent company name');
	 frm.name.focus();
	 return false;
	 }
	 else if(frm.tax_id1.value == '' || frm.tax_id2.value == '' || frm.tax_id3.value == '')
	 {
		 alert('Please enter parent company Federal Tax ID number');
		 if(frm.tax_id1.value == '')
		 {
		 frm.tax_id1.value = '';
		 frm.tax_id1.focus();
		 return false;
		 }
		 else if(frm.tax_id2.value == '')
		 {
		 frm.tax_id2.value = '';
		 frm.tax_id2.focus();
		 return false;
		 }
		 else if(frm.tax_id3.value == '')
		 {
		 frm.tax_id3.value = '';
		 frm.tax_id3.focus();
		 return false;
		 }
	  }
    }	
	 return;
}
</script>

<div id="container_inner"  style=" padding-top:10px;">
    <div id="bedcrumb">
    <ul>
    <li class="home"><a href="/camassistant/index.php?option=com_camassistant&amp;controller=vendors&amp;task=vendor_dashboard&amp;Itemid=112">Home  </a></li>
    <li>My User Info</li>
    </ul>
    </div>
<div>
<div id="dotshead_blue">MY USER INFO</div>
<div id="i_bar">
<div id="i_bar_txt">
<span>VENDOR INFO</span>
</div>
 
<div id="i_icon"><a style="text-decoration: none;" title="Click here" class="modal" rel="{handler: 'iframe', size: {x: 680, y: 530}}" href="index2.php?option=com_content&view=article&id=71&Itemid=113"><img src="templates/camassistant_left/images/info_icon2.png" /> </a></div>

<!--<div id="i_icon"><a href="#"><img alt="info" src="images/info_icon2.png"></a></div>-->
</div>
<div class="head_greenbg2">UPDATE YOUR COMPANY INFO</div>
<div class="clear"></div>

<form enctype="multipart/form-data" action="index.php?option=com_camassistant&amp;controller=vendors&amp;Itemid=72&amp;task=thanks" method="post" name="VendorForm2" >
<table cellpadding="0" cellspacing="0" border="0">
<tr>
<td align="left">
<div id="signup-form">

<?PHP
/* added on 22-010-2011 to show the vendors company name, federal tax rate */
?>
<div class="signup">
<label>Company Name : </label>
<input name="cname"  readonly="readonly"  type="text"  style="width:275px; background-color:#666666; color:#ffffff;" value="<?PHP echo  htmlentities($results[0]->company_name); ?>" <?PHP if($user->id != '62') { ?> readonly="readonly" <?PHP } ?> />
</div>

<div class="signup">
<label>Federal Tax ID : </label>
<input name="taxid"  readonly="readonly"   type="text" style="width:275px; background-color:#666666; color:#ffffff;" value="<?PHP echo $results[0]->tax_id; ?>"  <?PHP if($user->id != '62') { ?> readonly="readonly" <?PHP } ?> />
</div>

<div class="signup">
<label>Email Address : <span class="redstar">*</span></label>
<input type="text" readonly="readonly"  style="width:275px; background-color:#666666; color:#ffffff;" name="email" value="<?php echo $this->details->email;  ?>"   />
</div>


<div class="signup">
<label>Set new password:</label>
<input name="password" type="password" style="width:275px;" />
</div>
<div class="signup">
<label>Re-enter password: </label>
<input name="password2" type="password" style="width:275px;"  />
</div>



<div class="signup">
<label>Mailing Address : </label>
<input name="eaddress"type="text" style="width:275px;" value="<?PHP echo $this->details->company_address?>" />
</div>
<div class="signup">
<label></label>
<input name="eaddresss"type="text" style="width:275px;" value="<?PHP echo $this->details->company_addresss?>" />
</div>

<div class="signup">
<label>City: <span class="redstar">*</span></label>
<input type="text" style="width: 275px;" name="city" value="<?php echo $results[0]->city; ?>"  />
</div>

<div class="signup">
<label>State : <span class="redstar">*</span></label>
<?php // print_r($results[0]->state); exit; ?>
<select name="state">
<option value="" id=""> Select State </option>
<?php for($i=0; $i< count($state_list); $i++) {   ?>
<option id="<?php echo $state_list[$i]->id;?>" value="<?php echo $state_list[$i]->id;?>" <?php if($state_list[$i]->id == $results[0]->state) {?> selected="selected" <?php } ?> ><?php echo $state_list[$i]->state; ?></option>
<?php } ?>
</select>

<!--<input type="text" style="width:126px;" name="state" value="<?php //echo $statename[0]->state_name; ?>"  />--></div>

<!--<div class="signup">
<label>Zip : <span class="redstar">*</span></label>
<input type="text" style="width:126px;" name="zip" value="<?php //echo $results[0]->zipcode; ?>"   />
</div>
-->

<div class="signup">
<label>Zip : <span class="redstar">*</span></label>
<input type="text" style="width:126px;" name="zip" value="<?php echo $results[0]->zipcode; ?>"   />
</div>


<div class="signup">
<label>Year Established :<span class="redstar">*</span></label>
<input name="yearestab" type="text" style="width:275px;" value="<?php echo $results[0]->established_year; ?>"  />
</div>

<?php ?>
<div class="signup">
<div class="cp">
<label>Company Phone No # : <span class="redstar">*</span></label>
(
<input name="phone_1" type="text" style="width:30px;" value="<?PHP echo $phone[0]; ?>"  maxlength="3" onkeyup="moveOnMax(this,'phone_2')" onkeydown="if(isNaN(this.value)) alert('Please enter valid number'); " />
)
 <input name="phone_2" type="text" style="width:30px;" value="<?PHP echo $phone[1]; ?>"  maxlength="3" onkeyup="moveOnMax(this,'phone_3')"  onkeydown="if(isNaN(this.value)) alert('Please enter valid number'); "/> - 
 <input name="phone_3" type="text" style="width:30px;" value="<?PHP echo $phone[2]; ?>"  maxlength="4" onkeyup="moveOnMax(this,'extension')"  onkeydown="if(isNaN(this.value)) alert('Please enter valid number'); "/>
</div>

<div class="ext">
<label>Ext :</label>
<input name="extension" type="text" style="width:82px;" maxlength="4" value="<?PHP if($results[0]->phone_ext != 0) echo $results[0]->phone_ext; ?>"   onkeydown="if(isNaN(this.value)) alert('Please enter valid number'); " /></div>
<div class="clear"></div>
</div>

<div class="signup">
<div class="cp">
<label>Alternate Phone # : </label>
(<input name="cell_1" type="text" style="width:30px;" value="<?PHP  echo $cellphone[0]; ?>" maxlength="3" onclick="this.value = '';" onkeyup="moveOnMax(this,'cell_2')"   onkeydown="if(isNaN(this.value)) alert('Please enter valid number'); "  />)
 <input name="cell_2" type="text" style="width:30px;" value="<?PHP echo $cellphone[1]; ?>" maxlength="3" onclick="this.value = '';" onkeyup="moveOnMax(this,'cell_3')"   onkeydown="if(isNaN(this.value)) alert('Please enter valid number'); "  /> - 
 <input name="cell_3" type="text" style="width:30px;" value="<?PHP echo $cellphone[2]; ?>" maxlength="4" onclick="this.value = '';" onkeyup="moveOnMax(this,'alt_extension')"   onkeydown="if(isNaN(this.value)) alert('Please enter valid number'); "  />
</div>

<div class="ext">
<label>Ext :</label>
<input name="alt_extension" type="text" style="width:82px;" maxlength="4" value="<?PHP if($results[0]->alt_phone_ext != 0) echo $results[0]->alt_phone_ext; ?>"   onkeydown="if(isNaN(this.value)) alert('Please enter valid number'); " /></div>
<div class="clear"></div>
</div>
</div>


<div class="signup">
<label>Company Website (optional) :</label>
<input type="text" value="<?php echo $results[0]->company_web_url; ?>"  style="width: 275px;" name="company_web_url"   />
</div>


<?php /*?><div class="signup2">
<label>Upload Your Company Logo(optional) <br/>(image file must be .jpg,bmp,or png)</label>
<input name="image" type="file" style="width:275px;" value="Browse..."/><br/><br/><span><img width="50px;" height="50px" src="<?PHP echo JURI::root().'components/com_camassistant/assets/images/vendors/'. $this->details->image ; ?>" /></span>
</div><?php */?>
<div class="signup2">
<label>Upload your Company logo :</label>
</div>
<div class="signup">
<?php if($this->details->image) { ?>
		<img   src="<?PHP echo JURI::root().'components/com_camassistant/assets/images/vendors/resized/'. $this->details->image ; ?>" />
<?php } else  {    ?>
		<img   src="<?PHP echo JURI::root().'components/com_camassistant/assets/images/vendors/resized/taylo.jpg' ?>"  />
<?php } ?>
		<input type="hidden" value="<?php echo $this->details->image; ?>" name="img_name" />
</div>
<div class="signup2">
<input type="text" id="image" class="file_input_textbox" readonly="readonly" style="vertical-align: top; margin-top:3px;">
<div style="float: left;" class="file_input_div2">
<input type="button" class="file_input_button2" style="margin-top:-2px;">
<input title="Company Logo"  type="file" onchange="javascript: document.getElementById('image').value = this.value" name="hidden_image" class="file_input_hidden">
</div>
<!--<input name="image" type="file" style="width:275px;" value="Browse..."/> --> <!--<br> -->
<div style="clear: left;">(image file must be a .gif, .jpg, .bmp or .png)</div>
<div class="clear"></div>
</div>
<div class="signup">
<!--<select name="sstates" readonly="readonly" style="width:275px;" ><option></option></select>-->
<?php /*for($i=0;$i<count($states);$i++)
{
echo $states[$i]->name."<br/>";
}*/
?> 

<div style="padding-bottom: 0px;" class="signup_check">
<label>Are you an in-house vendor for a<br> 
management company? <span class="redstar">*</span></label>

<div class="clear"></div>
Yes<input type="radio" value="Yes" name="in_house_vendor" id="in_house_vendor" onclick="javascript:displayField('Yes');" <?php if($results[0]->in_house_vendor == 'Yes') { echo "checked=checked";  } ?> >
No<input type="radio"  value="No"  name="in_house_vendor" id="in_house_vendor" onclick="javascript:displayField('No');"  <?php if($results[0]->in_house_vendor == 'No') { echo "checked=checked;"; } ?> >
<div class="clear"></div>
</div>

<?php //if($results[0]->preferred_vendors == "yes") { ?>
<div <?php if($results[0]->in_house_vendor == 'Yes') { ?>  <?php } else { ?>style="display:none;" <?php }?> id="showparent" >
	<div class="signup" style="float:left">
	<div class="state">
	<label>Parent Company Name : <span class="redstar">*</span></label>
	<input name="name" type="text" style="width:267px;" value="<?PHP echo $results[0]->in_house_parent_company; 	?>"   />
	</div>
	</div>
	
	<div class="signup" style="float:right">
	<div class="state" style="width:150px;">
	<label>Parent Company Fedral Tax ID : <span class="redstar">*</span></label>
	<input type="text" onkeydown="if(isNaN(this.value)) alert('Please enter valid number'); " onclick="this.value = '';" maxlength="3" value="<?PHP echo $parent_comp_taxid[0]; ?>" style="width: 30px; text-align: center;" name="tax_id1"  > -
		<input type="text" onkeydown="if(isNaN(this.value)) alert('Please enter valid number'); " onclick="this.value = '';" maxlength="2" value="<?PHP echo $parent_comp_taxid[1]; ?>" style="width: 20px; text-align: center;" name="tax_id2"  > - 
		<input type="text" onkeydown="if(isNaN(this.value)) alert('Please enter valid number'); " onclick="this.value = '';" maxlength="4" value="<?PHP echo $parent_comp_taxid[2]; ?>" style="width: 45px; text-align: center;" name="tax_id3"  >
	</div>
	</div>
</div>
<?php // } ?>

<div class="clear"></div>
<div class="form_checkbox">
<div class="check"></div>
<div class="checktext">
<input type="hidden" name="user_id" value="<?PHP  echo $this->user_id; ?>" readonly="readonly"  />
<input type="hidden" name="username" value="<?PHP  echo $user->username; ?>"  />
<input type="hidden" name="email" value="<?PHP  echo $user->email; ?>"  />
<input type="image" style="border:none"  src="templates/camassistant_inner/images/save.png" onclick="javascript: return validate_data2();" alt="Continue sign up!" readonly="readonly"  />  </div>
</div>
<div class="clear"></div>
</div></td>

	<td align="left" valign="top">
	<table align="left" valign="top" style="margin-left:90px;">
	
		<tr>
			<td valign="top">
				<strong>States where you are licensed to do business  :</strong><br />			</td>
		</tr>
		<tr>
			<td valign="top">
				<?php 
				//echo "<pre>"; print_r($this->statenames);
				for($i=0;$i<count($this->statenames);$i++)
				{
						echo ($this->statenames[$i][0]->state_name);
						echo '<br/>';
				}
				?>			</td>
		</tr>
		<tr>
			<td valign="top">
				<br /><strong>Counties where you are licensed to do business  :</strong><br />			</td>
		</tr>
		<tr>
			<td valign="top">
				<?php 
				//echo "<pre>"; print_r($this->countynames);
				for($i=0;$i<count($this->countynames);$i++)
				{
									echo ($this->countynames[$i][0]->County);
									echo '<br/>';
				}
				?>			</td>
		</tr>
		<tr>
			<td valign="top">
				<br /><strong>My Industry/Industries </strong>			</td>
		</tr>
		<tr>
			<td>
				<?php 
				
				for($i=0;$i<count($this->industryname);$i++)
				{
					echo ($this->industryname[$i][0]->industry_name);
					echo '<br/>';
				}
				?>			</td>
		</tr>
		<tr>
			<td>
				<br />
				<p style="font-size:12px; color:#21314D">If you need to modify the above information or need<br /> further  assistance, please call us at <br /> <strong> 561-246-3830</strong>		</p>						            </td>
		</tr>
	</table>	</td>
</tr>
</table>
</form>
</div> 
<div class="clear"></div>
</div>