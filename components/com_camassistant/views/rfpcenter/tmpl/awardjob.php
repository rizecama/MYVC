<?php
/**
 * @version		1.0.0 camsignup $
 * @package		camsignup
 * @copyright	Copyright Â© 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		anand kumar
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');
$rfpid = JRequest::getVar('rid','');
$db = & JFactory::getDBO();
$jobtype = "SELECT  jobtype FROM #__cam_rfpinfo WHERE id=".$rfpid." ";
$db->setQuery( $jobtype);
$job_type = $db->loadResult();
		if($job_type == 'yes')
		$job_type = 'basic';
		else
		$job_type = '';

$count_proposals = count($this->proposals) + count($this->alt_proposals);		
// Your custom code here

//echo "<pre>"; print_r($this->proposals);

?>
  <link rel="stylesheet" href="<?Php echo juri::base(); ?>/media/system/css/modal.css" type="text/css" />
  	<link rel="stylesheet" type="text/css" href="<?Php echo juri::base(); ?>/templates/camassistant_left/css/style.css">
  <script type="text/javascript" src="<?Php echo juri::base(); ?>/media/system/js/mootools.js"></script>
  <script type="text/javascript" src="<?Php echo juri::base(); ?>/media/system/js/modal.js"></script>

	<script type="text/javascript" src="<?Php echo juri::base(); ?>/components/com_camassistant/skin/js/jquery-1.4.4.min.js"></script>
		
	<script language="javascript" type="text/javascript">
		G = jQuery.noConflict();
	function getprice(inputString){
	//	G('').prop('checked', false);	
		G('.proposal_other').removeAttr('checked');
		G('#task_award').val('awardedsuccess') ;
		
		G('#preferredvendorsinvitations_other').hide() ;
		if (inputString=='other')
		G.post("index.php?option=com_camassistant&controller=rfpcenter&tmpl=component&task=outsidevendor&rfpno=<?php echo $_REQUEST['rid']; ?>");
		
		G.post("index.php?option=com_camassistant&controller=rfpcenter&tmpl=component&task=price", {queryString: ""+inputString+""}, function(data){
		G('#testcode').html(data);
		if(data==''){
		//G('#v_price').css('display','none');
		G('#v_price').val('');
		}else{
		//G('#v_price').css('display','block');
		G('#v_price').val(data);
		
		}
		
		});
		
		
		}
	function getpriceother(inputString){
	//	G('').prop('checked', false);	
		G('.proposal_or').removeAttr('checked');
		G('#task_award').val('outsidevendorsuccess') ;
		G.post("index.php?option=com_camassistant&controller=rfpcenter&tmpl=component&task=price_other&rfpid=<?php echo $_REQUEST['rid']; ?>", {queryString: ""+inputString+""}, function(data){
		
		G('#testcode').html(data);
		if(data==''){
		//G('#v_price').css('display','none');
		G('#v_price').val('');
		}else{
		//G('#v_price').css('display','block');
		G('#v_price').val(data);
		
		}
		
		});
		
		
		}
			
		
	function getform(inputString){
		G('#radioid0').removeAttr('checked')
		G('#radioid1').removeAttr('checked')
		
		G('.proposal_or').removeAttr('checked')
		G('#v_price').val("");
		G('#task_award').val('outsidevendorsuccess') ;
		SqueezeBox.initialize({});
		popup='index.php?option=com_camassistant&controller=rfpcenter&task=outsidevendor&rfpno=<?php echo $_REQUEST['rid']; ?>';
		//alert(popup);
		var options = $merge(options || {}, Json.evaluate("{handler: 'iframe', size: {x: 703, y:603}}"))
		SqueezeBox.fromElement(popup,options);
		
		}
	function validate(){
	//G('#radioid').removeAttr('checked');
	 /*inputString='Awarded';
	//alert(inputString);
		G.post("index.php?option=com_camassistant&controller=rfpcenter&tmpl=component&task=verfiryaward", {queryString: ""+inputString+""}, function(data){
		//G('#testcode').html(data);
		//alert(data);
		if(data==''){
		var valid = document.closedform.value;
		//var value= this.id;
		window.location.href = "index.php?option=com_camassistant&controller=rfpcenter&task=awardedsuccess";
		//window.location("index.php?option=com_camassistant&controller=rfpcenter&task=awardedsuccess&id=<?php echo $this->proposals->id; ?>");
		//G('#Awarded').html('index.php?option=com_camassistant&controller=rfpcenter&task=awardedsuccess&id=<?php echo $row->id; ?>');
		}else{
		alert('Already awarded this to other property manager');
	   // G('#Awarded').html('<font color="#FF0000">Email Already Existed</font>');
		}
		});*/
		//alert(document.closedform.radioid.checked);	
		myOption = -1; 
		var flag=0;
		var flag_o=0;
		 var radios =  document.getElementsByName('radioid[]');
		 var others =  document.getElementsByName('other[]');
		var radioo =  document.getElementsByName('radioid');
		var count_prps = <?php echo $count_proposals; ?> ;
		
		 for (var i=0; i <radios.length; i++) {
		   if (radios[i].checked) {
		   flag=1;
		  }
		 } 
		 
	 	for (var o=0; o <others.length; o++) {
		   if (others[o].checked) {
		   flag_o=1;
		  }
		}
		
		if(flag==0 && flag_o==0 ) {
		alert("You must select a Vendor to AWARD this project");
		return false;
		} 
		else{
			if( count_prps > 1 ){
					document.forms["com-form-login"].submit();
					setTimeout("document.closedform.submit()",1200);
			}
			else{
					document.forms["com-form-login"].submit();
					setTimeout("document.closedform.submit()",1200);
			}
		}
		}
		
		function cancel(){
window.location.href = "index.php?option=com_camassistant&controller=rfpcenter&task=closedrfp&Itemid=100";
		}
		//code to calculate comission - by lalitha
		
		//Ajax function to calculate commission on vendor bidding amount
		function createXMLHttpRequest() 
		{
			try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) {}
			try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch (e) {}
			try { return new XMLHttpRequest(); } catch(e) {}
			alert("XMLHttpRequest not supported");
			return null;
		}
		var xhReq = createXMLHttpRequest();

		function getcommission(amnt)
		{ 
			/*var site='<?php //echo JURI::root();?>';						
			var path='<?php //echo addslashes(JPATH_SITE);?>'; 				
			xhReq.open("GET", site+"components/com_camassistant/helpers/ajax_commision_rfp.php?&c2="+amnt+"&path="+path, true);
			xhReq.onreadystatechange = onSumcommision;
			xhReq.send(null);*/
			G.post("index.php?option=com_camassistant&controller=rfpcenter&task=getcommission", {c2: ""+amnt+""}, function(data){
			
			document.getElementById('comission').value = data;
			//document.forms["com-form-login"].submit();
			});
		}
		function onSumcommision() 
		{
			if (xhReq.readyState != 0 && xhReq.readyState != 4)  { return; }
			var serverResponse = xhReq.responseText;		
			// alert(serverResponse);
			//document.getElementById('comission').value = serverResponse;
		}
	//code to calculate comission - by lalitha
	
//Function to delete the outer vendor
	function deleteouter(rfpid,outerid){
		var cnfg = confirm("Are you sure you want to remove this vendor?");
			if(cnfg == true){
				G.post("index.php?option=com_camassistant&controller=rfpcenter&task=removeouters&vendorid="+outerid, {rfp: ""+rfpid+""}, function(data){
				if(data == 'Yes'){
					location.reload(); 
				}
				
				});
			}
			else{
			
			}
	}
///Completed

function unverified(vendorid,type){
if(type == 'unverified')
var height = '290';
else
var height = '230';
var el ='index.php?option=com_camassistant&controller=rfpcenter&task=vendortype&vendorid='+vendorid+'&type='+type;
var options = $merge(options || {}, Json.evaluate("{handler: 'iframe', size: {x: 650, y:"+height+"}}"))
SqueezeBox.fromElement(el,options);
}
	
function preferredcompliance(rfpid,vendorid,status){
el='<?php  echo Juri::base(); ?>index.php?option=com_camassistant&controller=rfp&task=getcompliance&rfpid='+rfpid+'&vendorid='+vendorid+'&status='+status+'';
	var options = $merge(options || {}, Json.evaluate("{handler: 'iframe', size: {x: 650, y:700}}"))
	SqueezeBox.fromElement(el,options);
G("#sbox-window").addClass("newclasssate");	
}	
	
function preferredcompliancebasic(vendorid,status){
el='<?php  echo Juri::base(); ?>index.php?option=com_camassistant&controller=vendorscenter&task=preferredcompliance&vendorid='+vendorid+'&status='+status+'';
	var options = $merge(options || {}, Json.evaluate("{handler: 'iframe', size: {x: 650, y:700}}"))
	SqueezeBox.fromElement(el,options);
G("#sbox-window").addClass("newclasssate");	
}
	
	</script>

<style>
#maskshare {  position:absolute;  left:0;  top:0;  z-index:9000;  background-color:#000;  display:none;}
#boxesshare .windowshare {  position:absolute;  left:0;  top:0;  width:1300px;  height:150px;  display:none;  z-index:9999;  padding:38px 10px 3px 10px;}
#boxesshare #submitshare {  width:550px;  height:250px;;  padding:20px;  background-color:#ffffff;}
#doneshare {  border: 0 none;  cursor: pointer;  float: right;  height: 30px;  margin: -31px -5px;  text-align: left;  width: 50%;}
#closeshare {  border: 0 none;  color: #000000;  cursor: pointer;  font-size: 20px;  font-weight: bold;  height: 30px;  margin: 1px 4px 0 0px;  text-align: right;  width: 50%;}

</style>
<br/>
<div align="center"><img src="templates/camassistant_left/images/award_step1.png"></div>
<p style="height:30px;"></p>
<form action="index.php?option=com_camassistant&controller=rfpcenter" name="com-form-login" method="post"  >
<div id="i_bar_terms">
<div id="i_bar_txt_terms">
<span> <font style="font-weight:bold; color:#FFF;">AWARD JOB - RFP #<?php echo $_REQUEST['rid'];//echo $this->proposals[0]->rfpno; ?> </font></span>
</div></div>

<div id="heading_vendors_award">
<div class="company_vendor_award">COMPANY</div>
<div class="apple_vendor_award">APPLE RATING</div>
<div class="compliant_vendor_award">COMPLIANCE STATUS</div>
<div class="checkbox_vendor_award">PRICE</div>
</div>
<br />
<div id="select_vendor_award">
  	<?php
	//$k = 0;
	//foreach ($this->proposals as $row) :
	
	for ($i=0, $n=count( $this->proposals ); $i < $n; $i++)
	{
		$row = &$this->proposals[$i];
		$vendorid=  $this->proposals[$i]->proposedvendorid;
	    $today = date('Y-m-d');
		$db= JFactory::getDBO();
		$alert_sql1 ="SELECT count(*) from #__cam_vendor_liability_insurence where GLI_end_date>='".$today."'and GLI_status=1 and vendor_id=".$vendorid;
		$db->Setquery($alert_sql1);
		$res1 = $db->loadResult();
		$alert_sql2 ="SELECT count(*) from #__cam_vendor_compliance_w9docs where w9_status=1  and vendor_id=".$vendorid;
		$db->Setquery($alert_sql2);
		$res2 = $db->loadResult();
		$vendor_vid =$vendorid;
		$query3 = "select U.id,U.rfpno,V.name,V.email,V.lastname,U.Alt_bid,cv.company_name,U.proposal_total_price,U.proposedvendorid,U.proposaltype,V.subscribe_type from #__cam_vendor_proposals as U LEFT JOIN #__users  as V ON  V.id=U.proposedvendorid LEFT JOIN #__cam_vendor_company as cv ON cv.user_id=U.proposedvendorid where (U.proposaltype='Submit' or U.proposaltype='resubmit') and U.Alt_bid!='yes' and V.id!='' and U.proposedvendorid='".$vendor_vid."' and U.rfpno=".$_REQUEST['rid'];
	$db->setQuery($query3);
	$proposal = $db->loadObjectList();
	
?>
<div id="preferredvendorsinvitations">
    <div class="search-panel-left_rfp_award company_vendor_award">
	   <ul>
	   <li><input type="radio" name="radioid[]" id="radioid<?php echo $i; ?>" value="<?php echo $proposal[0]->id; ?>" onclick="getprice(<?php echo $proposal[0]->id; ?>);" class="proposal_or"/>
	   </li>
        <li>
		<strong><a target="_blank" href="index.php?option=com_camassistant&controller=vendors&task=vendordetailslayout&id=<?php echo $this->proposals[$i]->proposedvendorid; ?>"><?php echo ucfirst($this->proposals[$i]->company_name); ?></a></strong></li>
        <li><?php echo $this->proposals[$i]->name. '&nbsp;'. $this->proposals[$i]->lastname ; ?> <?php echo $this->proposals[$i]->company_phone; ?> <?php if($this->proposals[$i]->phone_ext){ echo "&nbsp;Ext.&nbsp;".$this->proposals[$i]->phone_ext; } else{ echo ""; } ?>	</li>
		        <li><?php echo $this->proposals[$i]->city; ?>,&nbsp;<?php echo strtoupper($this->proposals[$i]->statename); ?></li>
        <li><a class="miniemails" href="mailto:<?php echo $this->proposals[$i]->email; ?>?cc=<?php echo $this->proposals[$i]->ccemail; ?>" style="font-weight:normal; color:gray;">Email</a></li>
        </ul>
      </div>
    <div class="search-panel-right_rfp_award apple_vendor_award">
				<img width="130" src="components/com_camassistant/assets/images/rating/vendorrating/<?php echo $this->proposals[$i]->applerating; ?>">
			
	</div>
					<div class="search-panel-image_rfp_award compliant_vendor_award">
	  	  <p align="center" style="color:; display:block; margin-bottom:7px; font-weight:bold; display:block !important;">
		  <?php
		  			if($this->proposals[$i]->special_requirements == 'fail') {
					//$text = "NON-COMPLIANT";
					$id = 'noncompliant';
					$title = 'Non-Compliant';
					}
					else if($this->proposals[$i]->special_requirements == 'success'){
					//$text = "COMPLIANT";
					$id = 'compliant';
					$title = 'Compliant';
					}
					else if($this->proposals[$i]->special_requirements == 'medium'){
					//$text = "COMPLIANT & NON-COMPLIANT";
					$id = 'mediumcompliant';
					$title = 'Compliant & Non-Compliant';
					}
					else if($this->proposals[$i]->special_requirements == 'nostandards'){
					$text = "N/A";
					$id = 'nostandards';
					$title = 'No Standards';
					}
		  ?>
		  	<?php if($job_type == 'basic') { ?>
		 			<a href="javascript:void(0);" id="<?php echo $id; ?>" onclick="preferredcompliancebasic('<?php echo $this->proposals[$i]->proposedvendorid; ?>','<?php echo $title; ?>');" title="<?php echo $title; ?>"><?php //echo $text; ?></a>
					<?php } else { ?>
					<a href="javascript:void(0);" id="<?php echo $id; ?>" onclick="preferredcompliance('<?php echo $rfpid; ?>','<?php echo $this->proposals[$i]->proposedvendorid; ?>','<?php echo $title; ?>');" title="<?php echo $title ; ?>"><?php //echo $text ; ?></a>
					
				<?php } ?>	
			 </p>
<?php
if( $this->proposals[$i]->subscribe_type == 'free' ) { ?>
<div class="unverifiedvendor_award"><a href="javascript:void(0);" onclick="unverified(<?php echo $this->proposals[$i]->proposedvendorid; ?>,'unverified');" title="Click for more info">UNVERIFIED</a></div>
<?php } else { ?>
<div class="verifiedvendor_award"><a href="javascript:void(0);" onclick="unverified(<?php echo $this->proposals[$i]->proposedvendorid; ?>,'verified');" title="Click for more info">VERIFIED</a></div>
<?php }
?>			 
	  </div>
	<div class="search-panel-middlepre_award checkbox_vendor_award">
	<a class="priceaward" href="index.php?option=com_camassistant&controller=rfpcenter&task=vendor_proposal_preview_tomanager&Alt_Prp=<?php echo $alt; ?>&Proposal_id=<?php echo $proposal[0]->id; ?>&vendor_id=<?php echo $this->proposals[$i]->proposedvendorid; ?>&rfp_id=<?php echo $rfpid; ?>&job=<?php echo $job_type; ?>" target="_blank"><strong><?php echo "$". number_format($this->proposals[$i]->proposal_total_price,2); ?></strong></a>
	
		
      </div>  
	  
    <div class="clr"></div>
  </div>
<?php
		
		$vendorid=  $this->proposals[$i]->proposedvendorid;
	    $today = date('Y-m-d');
		$db= JFactory::getDBO();
		$alert_sql1 ="SELECT count(*) from #__cam_vendor_liability_insurence where GLI_end_date>='".$today."'and GLI_status=1 and vendor_id=".$vendorid;
		$db->Setquery($alert_sql1);
		$res1 = $db->loadResult();
		$alert_sql2 ="SELECT count(*) from #__cam_vendor_compliance_w9docs where w9_status=1  and vendor_id=".$vendorid;
		$db->Setquery($alert_sql2);
		$res2 = $db->loadResult();
		$vendor_vid =$vendorid;
		$query3 = "select U.id,U.rfpno,V.name,V.email,V.lastname,V.subscribe_type,U.Alt_bid,cv.company_name,U.proposal_total_price,U.proposedvendorid,U.proposaltype from #__cam_vendor_proposals as U LEFT JOIN #__users  as V ON  V.id=U.proposedvendorid LEFT JOIN #__cam_vendor_company as cv ON cv.user_id=U.proposedvendorid where (U.proposaltype='Submit' or U.proposaltype='resubmit') and U.Alt_bid!='yes' and V.id!='' and U.proposedvendorid='".$vendor_vid."' and U.rfpno=".$_REQUEST['rid'];
	$db->setQuery($query3);
	$proposal = $db->loadObjectList();
	?>
	
<?php
	}
	//echo "<pre>"; print_r($this->alt_proposals); echo "</pre>";
    for ($k=0, $m=count( $this->alt_proposals ); $k < $m; $k++)
	{
	$row1 = &$this->alt_proposals[$k];
	
	$vendorid1=  $row1->proposedvendorid;
	//echo $k;
	$today = date('Y-m-d');
		$db= JFactory::getDBO();
		 $alert_sql ="SELECT count(*) from #__cam_vendor_occupational_license where OLN_expdate>= '".$today."' and OLN_status=1 and vendor_id=".$vendorid1;
		$db->Setquery($alert_sql);
		$res = $db->loadResult();
		
		$alert_sql1 ="SELECT count(*) from #__cam_vendor_liability_insurence where GLI_end_date>='".$today."'and GLI_status=1 and vendor_id=".$vendorid1;
		$db->Setquery($alert_sql1);
		$res1 = $db->loadResult();
		
		 $alert_sql2 ="SELECT count(*) from #__cam_vendor_professional_license where PLN_expdate>= '".$today."' and PLN_status=1 and vendor_id=".$vendorid1;
		$db->Setquery($alert_sql2);
		$res2 = $db->loadResult();
		
		 $alert_sql3 ="SELECT count(*) from #__cam_vendor_workers_companies_insurance where WCI_end_date>= '".$today."' and WCI_status=1 and vendor_id=".$vendorid1;
		$db->Setquery($alert_sql3);
		$res3 = $db->loadResult();
		
		//if($res>0 && $res1>0 && $res2>0 && $res3>0){ 
		$vendor_vid_alt =$vendorid1;
		$query3 = "select U.id,U.rfpno,V.name,V.email,V.lastname,V.subscribe_type,U.Alt_bid,cv.company_name,U.proposal_total_price,U.proposedvendorid,U.proposaltype from #__cam_vendor_proposals as U LEFT JOIN #__users  as V ON  V.id=U.proposedvendorid LEFT JOIN #__cam_vendor_company as cv ON cv.user_id=U.proposedvendorid where (U.proposaltype='Submit' or U.proposaltype='resubmit') and U.Alt_bid='yes' and V.id!='' and U.proposedvendorid='".$vendor_vid_alt."' and U.rfpno=".$_REQUEST['rid'];
	$db->setQuery($query3);
	$alt_proposal = $db->loadObjectList();
	//echo $k;
	?>
  <div id="preferredvendorsinvitations">
    <div class="search-panel-left_rfp_award company_vendor_award">
	   <ul>
	   <li><input type="radio" name="radioid[]" id="radioid<?php echo $k; ?>" value="<?php echo $alt_proposal[0]->id; ?>" onclick="getprice(<?php echo $alt_proposal[0]->id; ?>);" class="proposal_or"/>
	   </li>
        <li>
		<strong><a target="_blank" href="index.php?option=com_camassistant&controller=vendors&task=vendordetailslayout&id=<?php echo $this->alt_proposals[$k]->proposedvendorid; ?>"><?php echo ucfirst($this->alt_proposals[$k]->company_name); ?></a></strong></li>
        <li><?php echo $this->alt_proposals[$k]->name. '&nbsp;'. $this->alt_proposals[$k]->lastname ; ?> <?php echo $this->alt_proposals[$k]->company_phone; ?> <?php if($this->alt_proposals[$k]->phone_ext){ echo "&nbsp;Ext.&nbsp;".$this->alt_proposals[$k]->phone_ext; } else{ echo ""; } ?>	</li>
		        <li><?php echo $this->alt_proposals[$k]->city; ?>,&nbsp;<?php echo strtoupper($this->alt_proposals[$k]->statename); ?></li>
        <li><a class="miniemails" href="mailto:<?php echo $this->alt_proposals[$k]->email; ?>?cc=<?php echo $this->alt_proposals[$k]->ccemail; ?>" style="font-weight:normal; color:gray;">Email</a></li>
        </ul>
      </div>
    <div class="search-panel-right_rfp_award apple_vendor_award">
				<img width="130" src="components/com_camassistant/assets/images/rating/vendorrating/<?php echo $this->alt_proposals[$k]->applerating; ?>">
			
	</div>
					<div class="search-panel-image_rfp_award compliant_vendor_award">
	  	  <p align="center" style="color:; display:block; margin-bottom:7px; font-weight:bold; display:block !important;">
		  <?php
		  			if($this->alt_proposals[$k]->special_requirements == 'fail') {
					//$text = "NON-COMPLIANT";
					$id = 'noncompliant';
					$title = 'Non Complaint';
					}
					else if($this->alt_proposals[$k]->special_requirements == 'success'){
					//$text = "COMPLIANT";
					$id = 'compliant';
					$title = 'Complaint';
					}
					else if($this->alt_proposals[$k]->special_requirements == 'medium'){
					//$text = "COMPLIANT & NON-COMPLIANT";
					$id = 'mediumcompliant';
					$title = 'Complaint & Non Complaint';
					}
					else if($this->alt_proposals[$k]->special_requirements == 'nostandards'){
					$text = "N/A";
					$id = 'nostandards';
					$title = 'No Standards';
					}
					
		  ?>
		  			<?php 
					
					if($job_type == 'basic') { ?>
					<a href="javascript:void(0);" id="<?php echo $id; ?>" onclick="preferredcompliancebasic('<?php echo $this->alt_proposals[$k]->proposedvendorid; ?>','<?php echo $title; ?>');" title="<?php echo $title; ?>"><?php //echo $text; ?></a>
					
					<?php } else { ?>	
					<a href="javascript:void(0);" id="<?php echo $id; ?>" onclick="preferredcompliance('<?php echo $rfpid; ?>','<?php echo $this->alt_proposals[$k]->proposedvendorid; ?>','<?php echo $title; ?>');" title="<?php echo $title ; ?>"><?php //echo $text ; ?></a>
					
					<?php } ?>	
			 </p>

<?php
if( $this->alt_proposals[$k]->subscribe_type == 'free' ) { ?>
<div class="unverifiedvendor_award"><a href="javascript:void(0);" onclick="unverified(<?php echo $this->alt_proposals[$k]->proposedvendorid; ?>,'unverified');" title="Click for more info">UNVERIFIED</a></div>
<?php } else { ?>
<div class="verifiedvendor_award"><a href="javascript:void(0);" onclick="unverified(<?php echo $this->alt_proposals[$k]->proposedvendorid; ?>,'verified');" title="Click for more info">VERIFIED</a></div>
<?php }
?>	

			 
	  </div>
	<div class="search-panel-middlepre_award checkbox_vendor_award">
	<a class="priceaward" href="index.php?option=com_camassistant&controller=rfpcenter&task=vendor_proposal_preview_tomanager&Alt_Prp=yes&Proposal_id=<?php echo $alt_proposal[0]->id; ?>&vendor_id=<?php echo $this->alt_proposals[$k]->proposedvendorid; ?>&rfp_id=<?php echo $rfpid; ?>&job=<?php echo $job_type; ?>" target="_blank"><strong><?php echo "$". number_format($this->alt_proposals[$k]->proposal_total_price,2).'<br />(alt)'; ?></strong></a>
	
		
      </div>  
	  
    <div class="clr"></div>
  </div>
  
  
<?php	//}
}
	
	?>
	
<?php
$outers = $this->outer_proposals ;

if( $outers ){
	for( $o=0; $o<count($outers); $o++ ){
		?>
<div id="preferredvendorsinvitations">
<div class="search-panel-left_rfp_award company_vendor_award">
<ul>
<li><input type="radio" name="other[]" id="radioid<?php echo $o; ?>" value="<?php echo $outers[$o]->id; ?>" onclick="getpriceother(<?php echo $outers[$o]->id; ?>);" class="proposal_other"/></li>
<li><strong><?php echo ucfirst($outers[$o]->companyname); ?></a></strong></li>
<li><?php echo $outers[$o]->contactname; ?> <?php echo $outers[$o]->phonenumber; ?> </li>
<li><a class="miniemails" href="mailto:<?php echo $outers[$o]->emailid; ?>">Email</a></li>
<li><a id="removeouter" href="javascript:void(0);" onclick="deleteouter(<?php echo $_REQUEST['rid']; ?>,<?php echo $outers[$o]->id; ?>);">REMOVE</a></li>
</ul>
</div>
<div class="search-panel-right_rfp_award apple_vendor_award">
<p class="outerimage">N/A</p>			
</div>
<div class="search-panel-image_rfp_award compliant_vendor_award" style="margin-top:0px;">
<p>N/A</p>
</div>

<div class="search-panel-middlepre_award checkbox_vendor_award" style="margin-top:0px;">
<a class="outernumber"><strong><?php echo "$". number_format($outers[$o]->amount,2); ?></strong></a>
</div>
<div class="clr"></div>
</div>
		<?php 
	}
}
?>  	

<div id="preferredvendorsinvitations" style="border:none;">
<div class="search-panel-left_rfp_award company_vendor_award">
<ul><li><!--<input type="radio" name="radioid" id="radioid" value="other" onclick="getform('other');" class="othervendor"/>-->
<a id="outervendors" href="javascript:void(0);" onclick="getform('other');">+ Add Vendor</a></li>
</ul></div></div>

</div>
<br /><br />
<div style="padding-left:0px;">
<div style="margin-top:2px; text-align:center" >
<label style=" width:150px;"><strong>Contract Final Pricing:</strong></label></div><p style="height:8px"></p>
<div style="text-align:center"><span style="color:#7ab800; font-weight:bold; font-size:14px; margin-right:3px;">$</span><input style=" width:200px;" type="text" class="other_tfield" name="v_price" id="v_price" value=""  /></div>
<?php /*?>	<?php
		$db =& JFactory::getDBO();
			$query= "SELECT proposal_total_price,rfpno FROM #__cam_vendor_proposals where Alt_bid='yes' and rfpno='".$_REQUEST['rid']."'";
			$db->setQuery($query);
			$result = $db->loadObjectlist();
			//echo "<pre>"; print_r($result);
			?>
<?php if($row->Alt_bid=='yes') { ?>
Alternative Proposal:<?php echo $row->proposal_total_price; ?>
<?php } ?><?php */?>
</div>
<br />
<br />
<span class="blue_small_award">NOTE: </span>The Contract Final Pricing field is auto-populated once a vendor is selected. If your final pricing is different than stated above, please modify it so the email notification sent to the Vendor will contain the correct amount to include in their contract. 
<br />
<br />


<div id="topborder_row" align="center">
<a href="#" class="newcancel" onclick="cancel();"></a>
<!--<img src="images/cancel.gif" alt="Cancel" onclick="cancel();"/>-->
<a href="#" class="newaward" onClick="getcommission(document.getElementById('v_price').value); validate(); return false;"></a>
<!--<img src="images/submit.gif" style="margin-bottom:2px;" onClick=" getcommission(document.getElementById('v_price').value); validate(); return false; "/>-->
</div>
</div>

	<input type="hidden" value="<?php echo $_REQUEST['rid']; ?>" name="rfpno"  />
	<input type="hidden" value="Awarded"  id="" name="Awarded"  />
	<input type="hidden" value="" name="comission" id="comission"  />
	<input type="hidden" value="" name="awardedto" id="task_award" />
	<input type="hidden" value="awardjob_second" name="task" />
	<input type="hidden" value="" name="shareinfo" id="shareinfo" />
	</form>

<?php //exit; ?>

<div id="boxesshare" class="boxesshare">
<div id="submitshare" class="windowshare" style="top:300px; left:582px; border:6px solid #609e00; position:fixed;">
<div id="i_bar_terms">
<div id="i_bar_txt_terms">
<span> <font style="font-weight:bold; color:#FFF; font-size:14px;">UNAWARDED VENDORS</font></span>
</div></div>
<p align="center" style="color:gray; font-size:14px; border-bottom:2px dotted; text-align:justify; padding-bottom:25px;">Would you like to include the <strong>High, Low, and Awarded proposal amounts</strong> in the rejection email to the participating Vendors who were <strong>not</strong> awarded this project?</p>
<span style="border-bottom:dotted 2px gray;"></span>
<p align="center" style="color:gray; font-size:13px; padding-top:7px; text-align:justify;"><strong>Note:</strong> This information can be used by the Vendors to provide more competitive pricing in the future. Also, only the dollar amounts will be shared. No Vendor names or total number of Vendors participating will be included.</p>
<div style="padding-top:30px; text-align:center;">
<form name="edit" id="edit" method="post">
<div id="closeshare" name="closeshare" value="Cancel"><a href="javascript:void(0);" class="noawardjob"></a></div>
<div id="doneshare"  name="doneshare" value="Ok"><a href="javascript:void(0);" class="yesawardjob"></a></div>
</div>
</form>

</div>
  <div id="maskshare"></div>
</div>