<?php

/**
 * @version		1.0.0 cam assistant $
 * @package		cam_assistant
 * @copyright	Copyright Â© 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');

// Your custom code here
JHTML::_('behavior.modal');
//echo "this is file uploading form";
?>
<link rel="stylesheet" media="all" type="text/css" href="<?php echo Juri::base(); ?>components/com_camassistant/skin/css/jquery1.css" />		
<script type="text/javascript" src="<?php echo Juri::base(); ?>components/com_camassistant/skin/js/jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="<?php echo Juri::base(); ?>components/com_camassistant/skin/js/jquery-ui-1.8.6.custom.min.js"></script>
<script type="text/javascript" src="<?php echo Juri::base(); ?>components/com_camassistant/skin/js/jquery-ui-timepicker-addon.js"></script>
<script type="text/javascript" src="<?php echo Juri::base(); ?>components/com_camassistant/skin/js/jquery.elastic.js"></script>

<script type="text/javascript">
H = jQuery.noConflict();
function validate()
{
var path= document.forms["folderform"]["path"].value;
var x=document.forms["folderform"]["file"].value ;
x = x.replace("C:\\fakepath\\", "");
var filext = x.substring(x.lastIndexOf(".")+1);
if(filext=='gif' || filext=='jpg' || filext=='JPG' || filext=='png' || filext=='PNG' || filext=='doc' || filext=='DOC' || filext=='psd' || filext=='PSD' || filext=='bmp' || filext=='BMP' || filext=='GIF' || filext=='docx' || filext=='DOCX' || filext=='pdf' || filext=='PDF' || filext=='jpeg' || filext=='JPEG' || filext=='rtf' || filext=='RTF' || filext=='xls' || filext=='XLX' || filext=='ppt' || filext=='PPT' || filext=='xlsx' || filext=='DOCX' || filext=='docx' || filext=='pptx' || filext=='PPTX'){


H.post("index2.php?option=com_camassistant&controller=documents&task=checkfile&mainpath="+path+"", {uploadfile: ""+x+""}, function(data){

if(data == 'exists'){
var confirmb = confirm("Files already exists with that name.  Do you want to replace it?");
if(confirmb == true){
document.getElementById("fileexists").value = data;
document.forms["folderform"].submit();
}
else{

}
}
else{
document.getElementById("fileexists").value = '';
document.forms["folderform"].submit();
}
});
return false;


}
else{
alert("This file type cannot be uploaded");
return false;
}

if (x==null || x=="")
  {
  alert("Please upload the file");
  return false;
  }
} 
</script>

<div id="container_inner" style="padding-top:30px;"  >
<table cellpadding="0" cellspacing="0">
<tr><td>Uploading files extensions</td></tr>
<tr><td>
<?php 
for ($i=0; $i<count($this->efiles); $i++){
$efiles = $this->efiles[$i]; 
$efiles->files = str_replace(',',',&nbsp;',$efiles->files);
echo '<span style="float:left; width:50px; font-weight:bold; color:#21314D;">'.$efiles->files.'</span>';
}
?></td></tr><tr height="30"></tr></table>

<form action="" method="post" name="folderform" enctype="multipart/form-data" onsubmit="return validate()">
<table cellpadding="0" cellspacing="0">
<tr>
<td>Select File Path:</td>
<td><input type="file" name="file" value="" /></td>
</tr>
<tr height="20"></tr>
<tr>
<td></td>
<td width="100"></td>
<td>

<!--<input type="submit" value="Submit"  />-->
<input type="image" src="templates/camassistant_inner/images/submit.png" />
<!--<input type="button" value="Submit" onclick="javascript: closepopup();">-->
<input type="hidden" name="option" value="com_camassistant" />
<input type="hidden" name="controller" value="popupdocs" />
<input type="hidden" name="task" value="savefile" />
<input type="hidden" name="pid" value="<?php echo $_REQUEST['pid']; ?>" />
<input type="hidden" name="mid" value="<?php echo $_REQUEST['mid']; ?>" />
<input type="hidden" name="path" value="<?php echo $_REQUEST['path']; ?>" />
<input type="hidden" name="parentid" value="<?php echo $_REQUEST['parentid']; ?>" />
<input type="hidden" name="fileexists" value="" id="fileexists" />
</td>
</tr>

</table>
</form>
<?php exit; ?>
<div class="clear"></div>
</div>