<?php
/**
 * @version		1.0.0 camsignup $
 * @package		camsignup
 * @copyright	Copyright Â© 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		anand kumar
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');
JHTML::_('behavior.modal');
// Your custom code here
//echo "<pre>"; print_r($_REQUEST);

?>

<script type="text/javascript" >
G = jQuery.noConflict();
function verifytaxid(){
		taxid1=document.reg_form.elements['taxid1'].value;
		taxid2=document.reg_form.elements['taxid2'].value;
		
		taxid = taxid1+'-'+taxid2;
		
		G.post("index2.php?option=com_camassistant&controller=propertymanager&task=verfirytaxid1", {queryString: ""+taxid+""}, function(data){
		//alert(data);
		if(data == 'invalid'){
		alert("This Tax ID number is already used vendor. If you feel you have received this message in error, or need further assistance, please call 561-246-3830.");
		document.reg_form.elements['taxid1'].value = '';
		document.reg_form.elements['taxid2'].value = '';
		return false;
		}
		if(data == 'excluded'){
		G('#user-email').html('<font color="#FF0000">Federal TAX ID already excluded by some camfirms</font>');
		alert("Federal TAX ID already excluded by some camfirms.");
		}
		});
	}
 function isNumberKey(evt)
      {
         var charCode = (evt.which) ? evt.which : event.keyCode
         if (charCode > 31 && (charCode < 48 || charCode > 57))
            return false;

         return true;
      }

function submitform12()
{
	document.reg_form.view.value='';
	//var iChars = "!@#$%^&*()+=-[]\\\';,./{}|\":<>?";
	var re = /^(\+|-)?[1-9]\d*(\.\d*)?$/; 
  /*if(!re.test(document.reg_form.taxid1.value)) { 
  	alert("Error: taxid1 contains invalid characters!"); 
	document.reg_form.taxid1.focus(); 
	return;
  } 
  
  else  if(!re.test(document.reg_form.taxid2.value)) { 
  alert("Error: taxid2 contains invalid characters!"); 
  document.reg_form.taxid2.focus(); return;
  } else*/
 if(document.reg_form.from.value != 'invitation') {	
  if((document.reg_form.taxid1.value=='' && document.reg_form.taxid2.value==''))
	{
		alert("Please enter the value for Federal Tax ID ");
		document.reg_form.taxid1.focus();
		return;
	} else  if(document.reg_form.taxid1.value.length!='2'){ 
	
  alert("Error: taxid must be 2 numbers"); 
  document.reg_form.taxid1.focus(); return;
  } else if(document.reg_form.taxid2.value.length!='7'){ 
   alert("Error: taxid must be 7 numbers"); 
  document.reg_form.taxid2.focus(); return;
	//} else if((document.reg_form.tax_id.value!='') && (!re.test(document.reg_form.tax_id.value)))	{
		//alert("Error: CAM License contains invalid characters!"); 
  		//document.reg_form.tax_id.focus(); 
  		//return;
		
	} else if(document.reg_form.taxid1.value!='' && document.reg_form.taxid2.value=='' )
	{
		alert("No value shouldn't be empty in Federal Tax ID"); 
		if(document.reg_form.taxid2.value=='')
  		document.reg_form.taxid2.focus(); 
		else
		document.reg_form.taxid3.focus(); 
  		return;
	} else if(document.reg_form.taxid2.value!='' && document.reg_form.taxid1.value=='' )
	{
		alert("No value shouldn't be empty in Federal Tax ID"); 
  		if(document.reg_form.taxid1.value=='')
  		document.reg_form.taxid1.focus(); 
		else
		document.reg_form.taxid3.focus(); 
  		return;
	} /*else if(document.reg_form.taxid3.value!='' && (document.reg_form.taxid1.value=='' || document.reg_form.taxid2.value==''))
	{
		alert("No value shouldn't be empty in Federal Tax ID"); 
  		if(document.reg_form.taxid1.value=='')
  		document.reg_form.taxid1.focus(); 
		else
		document.reg_form.taxid2.focus();  
  		return;
		}*/ else if((document.reg_form.taxid1.value!='') && (isNaN(document.reg_form.taxid1.value))) { 
	//} else 	if((document.reg_form.taxid1.value!='') && (!re.test(document.reg_form.taxid1.value))) { 
			alert("Error: Federal Tax ID contains invalid characters!"); 
			document.reg_form.taxid1.focus(); 
			return;
		} else if((document.reg_form.taxid2.value!='') && (isNaN(document.reg_form.taxid2.value))) { 
//	} else  if((document.reg_form.taxid2.value!='') && (!re.test(document.reg_form.taxid2.value))) { 
			alert("Error: Federal Tax ID contains invalid characters!"); 
			document.reg_form.taxid2.focus(); return;
		/*} else if((document.reg_form.taxid3.value!='') && (isNaN(document.reg_form.taxid3.value))) { 
	//} else if((document.reg_form.taxid3.value!='') && (!re.test(document.reg_form.taxid3.value))) { 
			alert("Error: taxid3 contains invalid characters!"); 
			document.reg_form.taxid3.focus(); 
			return;
	}*/ //else  if((document.reg_form.tax_id.value!='')&&(document.reg_form.tax_id.value.trim()==''))  { 
			//alert("Error: CAM License contains invalid characters!"); 
			//document.reg_form.tax_id.focus(); return;
		} else  if((document.reg_form.taxid1.value!='')&&(document.reg_form.taxid1.value.trim()=='')) { 
			alert("Error: Federal Tax ID contains invalid characters!"); 
			document.reg_form.taxid1.focus(); return;
		} else  if((document.reg_form.taxid2.value!='')&&(document.reg_form.taxid2.value.trim()=='')) { 
			alert("Error: Federal Tax ID contains invalid characters!"); 
			document.reg_form.taxid2.focus(); return;
		
		} 
		
		else  { 
			document.reg_form.view.value='propertymanager';
			document.reg_form.submit();
	}
	}
	else {
	 document.reg_form.view.value='propertymanager';
			document.reg_form.submit();
	}
    /*if(document.reg_form.onsubmit && 
    !document.reg_form.onsubmit())
    {
        return;
    }*/
// }
}

function moveOnMax(field,nextFieldID){
  if(field.value.length >= field.maxLength){
    document.getElementById(nextFieldID).focus();
  }
}


</script>

<?php $camfirm_license_no1 = $_REQUEST['camfirm_license_no'];
	  $camfirm_license_no = explode('-',$camfirm_license_no1);  
	  $tax_id = $_REQUEST['tax_id'];
	  $user = JFactory::getUser();  
	  if ($user->id!='0'){ ?>
	  <script type="text/javascript" >
	  alert('Already Logged In');
	  history.back();
	  </script>
	  <?php } else {
 ?>
<div style="padding-top: 0px;" id="container_inner">
<?php $db = &JFactory::getDbo();
		$manager="SELECT introtext  FROM #__content where id='188' ";
		$db->Setquery($manager);
		$manager_signup = $db->loadResult(); 
		//echo $manager_signup; ?>
<?php /*?><div id="container_left_camp">
<img alt="How it works" src="templates/camassistant_inner/images/howit-works_green.jpg">
<ul id="list003">
<li>  Define your CAM FIRM.</li>
<li> Create an account under your CAM FIRM.</li>
<li>Add your properties under management.</li>
<li>Create RFPs easily and get apples to apples proposals.</li>
<li>Select your winning vendor and get it done!</li>
<a style="text-decoration: none;" title="Click here" class="modal" rel="{handler: 'iframe', size: {x: 680, y: 440}}" href="index2.php?option=com_content&amp;id=54"> CLICK HERE FOR VIDEO</a>

</ul>
</div><?php */?>
<div id="container_right_campmanager" style="float:none;margin:0 auto;padding-top: 40px;width:256px;">
 
   
<div style="width: 245px;" id="heading001"><span class="green-arrow_heading">SIGN-UP! </span>
</div>
<div id="signup-form">

<div class="signup">

<form action=""  method="post" name="reg_form" enctype="multipart/form-data" style="padding:0; margin:0;">
<div class="signup">
<label>Federal Tax ID#:</label>
<?php if ($camfirm_license_no=='') { ?>
<input id="taxid1" name="taxid1" type="text" onkeypress="return isNumberKey(event)" style="width:20px; text-align:center;" value="" maxlength="2" onkeyup="moveOnMax(this,'taxid2')" onkeydown="if(isNaN(this.value)) alert('Please enter valid number');"/> -
<input id="taxid2" name="taxid2"  onkeypress="return isNumberKey(event)" type="text" style="width:60px; text-align:center;" value="" maxlength="7" /> 
<?php } else { 
$len = strlen($camfirm_license_no[1]) ;
$width = $len*10 ;
	if($width) {
	$width = $width ;
	}
	else {
	$width = '60' ;
	}
?>
<input id="taxid1" name="taxid1" onkeypress="return isNumberKey(event)" type="text" style="width:20px; text-align:center;" value="<?php echo $camfirm_license_no[0]; ?>" maxlength="2" onkeyup="moveOnMax(this,'taxid2')" onkeydown="if(isNaN(this.value)) alert('Please enter valid number');"/> -
<input id="taxid2" name="taxid2" onkeypress="return isNumberKey(event)" type="text" style="width:<?php echo $width ;?>px; text-align:center;" value="<?php echo $camfirm_license_no[1]; ?>" maxlength="7" onblur="verifytaxid();"/> 
<?php } ?>
<?php if($camfirm_license_no[2]) { ?>  <input id="taxid3" name="taxid3" type="hidden" style="width:35px; text-align:center;" value="<?php echo $camfirm_license_no[2]; ?>" readonly="readonly" maxlength="4" onclick="this.value='';"/><br /><?php } ?>
<br />
<?php /*?>OR
<div class="signup">
<lael>Property Management Firm/CAM Firm Licence #:</label>
<?php //if($tax_id=='') {?>
<input name="tax_id" type="text" style="width:150px;" value="" />
<?php } else { ?>
<input name="tax_id" type="text" style="width:150px;" value="<?php echo $tax_id; ?>" />
<?php } ?>
</div><?php */?>
</div>
 <div class="clear"></div>
</div>
 <p class="greentext">For company identification purposes.</p><br/>
 

 <a href="javascript: submitform12()" class="submit_manager_signup"><img src="templates/camassistant/images/continuesignup.gif" alt="continue signup" border="0" /></a>
 <div class="clear"></div>

		<input type="hidden" name="captcha_code_val" id="captcha_code_val" value="<?php echo $string;?>" />	
		<input type="hidden" name="option" value="com_camassistant" />
		<input type="hidden" name="controller" value="propertymanager" />
		<input type="hidden" name="view" value="propertymanager" />
		<input type="hidden" name="task" value="submit_licid" />
		<input type="hidden" name="Itemid" value="105" />	
		<input type="hidden" id="from" name="from" value="<?php echo JRequest::getVar("from",''); ?>" />
</form>


</div>
</div>
<div class="clear"></div>
</div>
<?php } ?>