<?php
/**
 * @version		1.0.0 camassistant $
 * @package		camassistant
 * @copyright	Copyright © 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');
JHTML::_('behavior.modal');
//$taxids=$this->taxids;
?>
<script type="text/javascript">
<!--
	function submitProperty() {
		frm=document.propertyform;
		if(frm.property_name.value=='')
		{
			alert("Please enter Property Name");
			frm.property_name.focus();
			return;
		} else if(frm.tax_id1.value=='') {
			alert("Please enter Property Federal Tax ID");
			frm.tax_id1.focus();
			return;
		}
		else if(frm.tax_id2.value=='') {
			alert("Please enter Property Federal Tax ID");
			frm.tax_id2.focus();
			return;
		}  else if(frm.units.value == '')
 			{
 			alert('Please enter the Number of Units');
			 frm.units.focus();
			 return ;
		 }
			else if(frm.street.value=='street') {
			alert("Please enter Street");
			frm.street.focus();
			return;
		}
		else if(frm.city.value=='city') {
			alert("Please enter City");
			frm.city.focus();
			return;
		}
		else if(frm.state.value=='state') {
			alert("Please enter State");
			frm.state.focus();
			return;
		}	
	else if(frm.zip.value=='zip') {
			alert("Please enter Zipcode");
			frm.zip.focus();
			return;
		}			
		 else {
		frm.submit();
		}
		//var valid = document.formvalidator.isValid(frm);
	}
	function moveOnMax(field,nextFieldID){

  if(field.value.length >= field.maxLength){
    document.getElementById(nextFieldID).focus();
  }
}
// -->
</script>
<link rel="stylesheet" media="all" type="text/css" href="<?php echo Juri::base(); ?>components/com_camassistant/skin/css/jquery1.css" />		
<script type="text/javascript" src="<?php echo Juri::base(); ?>components/com_camassistant/skin/js/jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="<?php echo Juri::base(); ?>components/com_camassistant/skin/js/jquery-ui-1.8.6.custom.min.js"></script>
<script type="text/javascript" src="<?php echo Juri::base(); ?>components/com_camassistant/skin/js/jquery-ui-timepicker-addon.js"></script>

<script type="text/javascript">
H = jQuery.noConflict();
var site='<?php echo JURI::root();?>';
var path='<?php echo addslashes(JPATH_SITE);?>';
var xhReq = createXMLHttpRequest();
var countyCount = 0;
function createXMLHttpRequest() 
{
	try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) {}
	try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch (e) {}
	try { return new XMLHttpRequest(); } catch(e) {}
	alert("XMLHttpRequest not supported");
	return null;
}
var xhReq = createXMLHttpRequest();


function onSumResult() 
{
	if (xhReq.readyState != 0 && xhReq.readyState != 4)  { return; }
	var serverResponse = xhReq.responseText;
	//alert(serverResponse)
	document.getElementById(globvariable).innerHTML = serverResponse;
	//alert('dfg')
}
function CurrencyFormatted(amount)
{
	var i = parseFloat(amount);
	if(isNaN(i)) { i = 0.00; }
	var minus = '';
	if(i < 0) { minus = '-'; }
	i = Math.abs(i);
	i = parseInt((i + .005) * 100);
	i = i / 100;
	s = new String(i);
	if(s.indexOf('.') < 0) { s += '.00'; }
	if(s.indexOf('.') == (s.length - 2)) { s += '0'; }
	s = minus + s;
	return s;
} // function CurrencyFormatted()

function CommaFormatted(amount)
{
	var delimiter = ",";
	var a = amount.split('.',2)
	var d = a[1];
	var i = parseInt(a[0]);
	if(isNaN(i)) { return ''; }
	var minus = '';
	if(i < 0) { minus = '-'; }
	i = Math.abs(i);
	var n = new String(i);
	var a = [];
	while(n.length > 3)
	{
		var nn = n.substr(n.length-3);
		a.unshift(nn);
		n = n.substr(0,n.length-3);
	}
	if(n.length > 0) { a.unshift(n); }
	n = a.join(delimiter);
	if(d.length < 1) { amount = n; }
	else { amount = n + '.' + d; }
	amount = minus + amount;
	amount = amount.split('.',2)
	amount = amount[0];
	return amount;
	
} // function CommaFormatted()
function unitsno()
{
	var s = new String();
	s = CurrencyFormatted(document.propertyform.units.value);
	s = CommaFormatted(s);
	document.propertyform.units.value = s;
}
function county(){
var state = H("#stateid").val();
H.post("index2.php?option=com_camassistant&controller=addproperty&task=ajaxcounty", {State: ""+state+""}, function(data){
if(data.length >0) {
H("#divcounty").html(data);
}
});

}
////To check tax ids
function verifytaxid(){

		tax_two=document.propertyform.elements['tax_id1'].value;
		tax_seven=document.propertyform.elements['tax_id2'].value;
		taxid = tax_two+'-'+tax_seven;
		
		H.post("index2.php?option=com_camassistant&controller=addproperty&task=verfirytaxid", {queryString: ""+taxid+""}, function(data){
		
		if(data == 'invalid'){
		 var firstline = 'You have entered the Tax Identification for an Existing Property.  If this is your property please, contact your Administrator to have it reassigned to you.';
		 var secondline = 'If the property is not available to the Administrator, please call the CAMassistant Customer Support Team at 516-246-3830, and be prepared to provide a copy of the management agreement for the property to confirm your current status.';
		 var thirdline = firstline+'\n\n'+secondline;
 		alert(thirdline);
		document.propertyform.elements['tax_id1'].value = '';
		document.propertyform.elements['tax_id2'].value = '';
		return false;
		}
	else{
	
	}
		});
	}
//Completed

  </script>
<link href="<?php echo Juri::base();?>templates/camassistant/css/popup.css" rel="stylesheet"/>

<!--<div id="l_box" >
<div id="l_box_close"></div>
</div>-->
<div style="margin:10px; padding-left:45px;" id="l_box_topcurve">
  <div id="l_box_close"></div>
    <p>ADD/EDIT A PROPERTY</p>
</div>
<div id="vender_right" style="width:570px;">
<form action="<?php echo JRoute::_( 'index.php' );?>" method="post" name="propertyform" id="propertyform" class="form-validate">
<div class="form_row" style="margin-left:50px;height:25px;">
<div id="txt_box">&nbsp;</div>
<div class="clear"></div>
</div>
 <?php if($_REQUEST['err_msg']) { ?>
   <div class="form_row"><div style="padding:6px"><strong style="color:#FF0000">*<?php echo $_REQUEST['err_msg'];?></strong></div>	
   <div class="clear"></div></div>
   <div class="form_row">
	<div id="txt_box"></div>
	<div class="clear"></div>
   </div>
  <?php } ?>
  <div class="form_row" style="margin-left:50px;"><div class="form_text" style="width:164px;">Property Association Name<span style="color:#FF0000; font-weight:bold;">*</span>:</div><label></label><input type="text" name="property_name" value="" style="width: 300px;"/><div class="clear"></div></div>
  <div class="form_row" style="margin-left:50px;"><div class="form_text" style="width:164px;">Association Tax ID Number<span style="color:#FF0000; font-weight:bold;">*</span>:</div><label></label>
<input type="text" id="tax_id1" name="tax_id1" value="" maxlength="2" style="width:35px;"  onkeyup="moveOnMax(this,'tax_id2')" />
<input type="text" id="tax_id2" name="tax_id2" value="" maxlength="7" style="width:85px;" onblur="javascript:verifytaxid();"  onkeyup="moveOnMax(this,'')"/>

<div class="clear"></div></div>
<div class="form_row" style="margin-left:50px;"><div class="form_text" style="width:164px;">
Number of Units<span style="color:#FF0000; font-weight:bold;">*</span>: <label></label></div>
<input id="units" name="units" type="text" style="width:100px;" value="" onblur="unitsno()" />
</div>
  <div class="form_row"  style="margin-left:50px;"><div style="float:left;padding:15px 15px 15px 5px;text-align:right;"><strong>Property Association Information :</strong></div><div class="clear"></div></div>
  <div class="form_row"  style="margin-left:50px;"><div class="form_text" style="width:164px;">Mailing Address for Property<span style="color:#FF0000; font-weight:bold;">*</span>:</div><label></label>
<!--  <input type="text" name="street" value="street" onclick="javascript:this.value='';"  onblur="javascript:this.value='state';" style="width: 300px;"/>-->
  <input type="text" name="street" value="street" onclick="javascript:this.value='';" onblur="if(this.value=='') this.value = 'street';" onfocus="if(this.value=='street') this.value = '';" style="width: 300px;" />
  
  <div class="clear"></div></div>
  <div class="form_row" style="margin-left:50px;"><div class="form_text" style="width:164px;">&nbsp;</div><label></label>
<!--  <input type="text" name="city" value="city" onclick="javascript:this.value='';" style="width: 300px;"/>-->
    <input type="text" name="city" value="city" onclick="javascript:this.value='';" onblur="if(this.value=='') this.value = 'city';" onfocus="if(this.value=='city') this.value = '';" style="width: 300px;" />

  <div class="clear"></div></div>
  <div class="form_row"  style="margin-left:50px;"><div class="form_text" style="width:164px;">&nbsp;</div><label></label>
  
  <!--<input type="text" name="state" value="state" onclick="javascript:this.value='';" style="width: 300px;"/>-->
    <select name="state" style="width:300px;" id="stateid" onchange="javascript:county();" >
<option value="">Select State</option>
  <?php 
for ($i=0; $i<count($this->states); $i++){
$states = $this->states[$i];
?>
<option value="<?php echo $states->state_id?>"><?php echo $states->state_name?></option>
<?php } ?>
</select>
 
</div>
  
  
  <div class="form_row"  style="margin-left:50px;"><div class="form_text" style="width:164px;">&nbsp;</div><label></label>
  
  <!--<input type="text" name="state" value="state" onclick="javascript:this.value='';" style="width: 300px;"/>-->
   <select style="width: 300px;" name="divcounty" id="divcounty" >
<option value="">Please Select County</option>
</select>
 
  <div class="clear"></div></div>
  
  
  
  
  
  
  <div class="form_row"  style="margin-left:50px;"><div class="form_text" style="width:164px;">&nbsp;</div><label></label>
<!--  <input type="text" name="zip" value="zip code" onclick="javascript:this.value='';" style="width: 300px;"/>-->
     <input type="text" name="zip" value="zip" onclick="javascript:this.value='';" onblur="if(this.value=='') this.value = 'zip code';" onfocus="if(this.value=='zip code') this.value = '';" style="width: 300px;" />
  
  <div class="clear"></div></div>
  <div class="form_row"  style="margin-left:50px;"><div><input type="checkbox" name="share" value="1" />&nbsp;I do not want to share the high, low and awarded proposal dollar amounts to the un-awarded vendors for this property</div><div class="clear"></div></div>
<div class="form_row"  style="margin-left:50px;">
<div id="txt_box"></div>
<div class="clear"></div>
</div>
<div class="form_row"  style="margin-left:50px;">
<div align="right">
<img border="0" vspace="10" onclick="javascript:submitProperty();" alt="Submit Text" src="templates/camassistant_left/images/save.gif" style="cursor:pointer;">
</div>
<div class="clear"></div>
</div>   

<input type="hidden" name="option" value="com_camassistant" />
<input type="hidden" name="controller" value="rfp" />
<input type="hidden" name="task" value="submit_property" />
<input type="hidden" name="company_id" value="<?php echo $this->company_id;?>" />
<?php echo JHTML::_( 'form.token' ); ?>
</form>
</div>
<?php exit;?>