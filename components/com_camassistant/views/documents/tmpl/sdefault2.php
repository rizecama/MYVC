<?php

/**
 * @version		1.0.0 cam assistant $
 * @package		cam_assistant
 * @copyright	Copyright Â© 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');

// Your custom code here
JHTML::_('behavior.modal');
$taxid = JRequest::getVar( 'taxid','' );
//echo "this is Shared default-2 file";
if($_REQUEST['type']=='shared'){
$type='shared';
} else{
$type='';
}
?>
<div id="bedcrumb" style="float:left">
<ul>

<li class="home"><a href="index.php?option=com_camassistant&controller=vendors&task=vendor_dashboard&Itemid=112">Home  </a></li>
<li><a href="index.php?option=com_camassistant&controller=documents&Itemid=76">My Company Documents</a></li>
<li><a href="index.php?option=com_camassistant&controller=documents&task=sdocs&Itemid=76">Shared Company Documents  </a></li>
<li><?php echo $_REQUEST['propertyname']; ?></li>
</ul>
</div>
<div style="float:right" ><br/>
<a href="index.php?option=com_camassistant&controller=documents&task=sdocs&Itemid=76"><img src="templates/camassistant_left/images/back.png" alt="info" /></a></div>
<div class="clear"></div>
<!-- eof dotshead -->
<div id="i_bar">
<div id="i_bar_txt">
<span><?php echo $_REQUEST['propertyname']; ?>   </span>
</div>
<div id="i_icon"><?php 
 $user = JFactory::getUser();  
if ($user->user_type=='12') { ?>
<a style="text-decoration: none;" title="Click here" class="modal" rel="{handler: 'iframe', size: {x: 680, y: 530}}" href="index2.php?option=com_content&amp;view=article&amp;id=89&amp;Itemid=113"><img src="templates/camassistant_left/images/info_icon2.png" /> </a>
<?php } else { ?>
<a style="text-decoration: none;" title="Click here" class="modal" rel="{handler: 'iframe', size: {x: 680, y: 530}}" href="index2.php?option=com_content&amp;view=article&amp;id=80&amp;Itemid=113"><img src="templates/camassistant_left/images/info_icon2.png" /> </a>
<?php } ?></div>
</div>
<div class="table_pannel">
<div class="table_panneldiv">
<form name="docform" action="index.php">
<input type="hidden" name="option" value="" />
<input type="hidden" name="controller" value="" />
<input type="hidden" name="task" value="" />
<input type="hidden" name="spid" value="" />
<input type="hidden" name="smid" value="" />
<input type="hidden" name="spath" value="" />
<input type="hidden" name="doc_title" value="" />
<input type="hidden" name="second" value="" />
<table width="100%" cellpadding="0" cellspacing="4" class="vendortable">
  <tr class="vendorfirsttr">
    <td width="62" align="center" valign="top">SELECT</td>
    <td width="456" align="left" valign="top">NAME</td>
    <td width="141" align="center" valign="top" colspan="2">OPTIONS</td>
    </tr>
	
  <?php 
  
  if(count($this->sfiles)){
//  print_r($this->pfiles);
for ($i=0; $i<count($this->sfiles); $i++){
$sfiles = $this->sfiles[$i]; 
$file = substr($sfiles->sdocTitle,-4,-3);
if($file!='.') {

?>
<tr class="table_blue_rowdots2">
<td align="center" valign="bottom"><a href="index.php?option=com_camassistant&controller=documents&Itemid=<?php echo $_REQUEST['Itemid']; ?>&task=sopenfiles&spid=<?php print_r($sfiles->property_id); ?>&smid=<?php print_r($sfiles->property_manager_id); ?>&spath=<?php print_r($sfiles->docPath); ?>&fileplace=<?php echo $_REQUEST['propertyname']."-->".$sfiles->sdocTitle;?>&type=<?php echo $type; ?>&Itemid=<?php echo $_REQUEST['Itemid']; ?>&taxid=<?php echo $taxid; ?>"><img src="images/folder_icon.png"  alt="folder" /></a></td>

<td align="left" valign="middle"><a href="index.php?option=com_camassistant&controller=documents&Itemid=<?php echo $_REQUEST['Itemid']; ?>&task=sopenfiles&spid=<?php print_r($sfiles->property_id); ?>&smid=<?php print_r($sfiles->property_manager_id); ?>&spath=<?php print_r($sfiles->docPath); ?>&fileplace=<?php echo $_REQUEST['propertyname']."-->".$sfiles->sdocTitle;?>&type=<?php echo $type; ?>&Itemid=<?php echo $_REQUEST['Itemid']; ?>&taxid=<?php echo $taxid; ?>"><?php echo str_replace('_',' ',$sfiles->sdocTitle); ?></a></td>

<td align="center" valign="middle">
<a href="index.php?option=com_camassistant&controller=documents&Itemid=<?php echo $_REQUEST['Itemid']; ?>&task=sopenfiles&spid=<?php print_r($sfiles->property_id); ?>&smid=<?php print_r($sfiles->property_manager_id); ?>&spath=<?php print_r($sfiles->docPath); ?>&fileplace=<?php echo $_REQUEST['propertyname']."-->".$sfiles->sdocTitle;?>&type=<?php echo $type; ?>&Itemid=<?php echo $_REQUEST['Itemid']; ?>&taxid=<?php echo $taxid; ?>">OPEN</a>
</td>

<td>
<script type="text/javascript">
function folderdelete(){
var result = confirm('Are you sure you want to delete this folder "<?php print_r($sfiles->sdocTitle); ?>" and the internal files?');

	if(result == true)
	{
		var frm = document.docform;
		frm.option.value='com_camassistant';
		frm.controller.value='documents';
		frm.task.value='delete';
		//frm.view.value='documents';
		frm.spid.value=<?php print_r($sfiles->property_id); ?>;
		frm.smid.value=<?php print_r($sfiles->property_manager_id); ?>;
		frm.spath.value='<?php print_r($sfiles->docPath); ?>';
		frm.doc_title.value='<?php print_r($sfiles->sdocTitle); ?>';
		
		frm.submit();
	}
	if(result == false) 
	{
		//alert('No action taken');
		window.location.href;
		//window.location = "http://www.google.com/"
		//return false;
	}
}
</script>
<!--<a href="index.php?option=com_camassistant&controller=documents&Itemid=82?controller=documents&task=delete&spid=<?php //print_r($sfiles->property_id); ?>&smid=<?php //print_r($sfiles->property_manager_id); ?>&spath=<?php //print_r($sfiles->docPath); ?>&title=<?php //print_r($sfiles->sdocTitle); ?>">DELETE</a>
-->

<a href="javascript:folderdelete();">DELETE</a>
</td>
</tr>
<?php } else { ?>
<tr class="table_blue_rowdots2">
<?php $ext = substr(strrchr($sfiles->sdocTitle, "."), 1); ?>
<?php 
$path = $sfiles->docPath;
$title = $sfiles->sdocTitle;
$path=str_replace($title,"",$path);
$path=str_replace("//","",$path);

 ?>
<td align="center" valign="bottom"><a href="index.php?option=com_camassistant&controller=documents&task=open&doc_title=<?php print_r($sfiles->sdocTitle); ?>&path=<?php echo $path; ?>&Itemid=76 "><img src="templates/camassistant_inner/images/images_<?php echo $ext; ?>.png" /></a>
</td>
<td align="left" valign="middle"><a href="index.php?option=com_camassistant&controller=documents&task=open&doc_title=<?php print_r($sfiles->sdocTitle); ?>&path=<?php echo $path; ?>&Itemid=76 "><?php echo str_replace('_',' ',$sfiles->sdocTitle); ?></a>
</td>
<td align="center" valign="middle"><a href="index.php?option=com_camassistant&controller=documents&task=open&doc_title=<?php print_r($sfiles->sdocTitle); ?>&path=<?php echo $path; ?>&Itemid=76 ">OPEN</a></td>

<td>
<script type="text/javascript">
function filedelete(){
var result = confirm('Are you sure you want to delete this file "<?php print_r($sfiles->sdocTitle); ?>" ?');

	if(result == true)
	{
		var from = document.docform;
		from.option.value='com_camassistant';
		from.controller.value='documents';
		from.task.value='deletefile';
		from.spid.value=<?php print_r($sfiles->property_id); ?>;
		from.smid.value=<?php print_r($sfiles->property_manager_id); ?>;
		from.spath.value='<?php print_r($sfiles->docPath); ?>';
		from.doc_title.value='<?php print_r($sfiles->sdocTitle); ?>';
		from.second.value='second';
		from.submit();
	}
	else 
	{
		//alert('No action taken');
		return false;
	}
}
</script>

 <a  href="#" onclick="javascript:filedelete();">DELETE</a>
 
<!--<a href="index.php?option=com_camassistant&controller=documents&Itemid=82?controller=documents&task=delete&spid=<?php //print_r($sfiles->property_id); ?>&smid=<?php //print_r($sfiles->property_manager_id); ?>&spath=<?php //print_r($sfiles->docPath); ?>&title=<?php //print_r($sfiles->sdocTitle); ?>">DELETE</a>-->

</td>
</tr>
<?php } 

} }
 else { ?>
<tr>
<td>&nbsp;</td>
<td width="20"></td>
<td width="500"><?php echo "No files in this folder"; ?></td>

<td>

</td>
</tr>
<?php } ?>
 <tr class="table_blue_rowdot">
   <td align="center" valign="bottom">&nbsp;</td>
   <td align="left" valign="top">&nbsp;</td>
   <td align="left" valign="top" colspan="2">&nbsp;</td>
   </tr>
</table>
</form>
<?php 
if($_REQUEST['type'] == 'shared'){
$val = 'components/com_camassistant/doc/sharedfiles/';
$type = 'shared';
}
else{
$val = 'components/com_camassistant/doc/'; 
}
if($sfiles->property_id ==''){
$sfiles->property_id = $_REQUEST['spid'];
} 
if($sfiles->property_manager_id ==''){
$sfiles->property_manager_id = $_REQUEST['smid'];
} 
?>
<?php 
$_REQUEST['propertyname'] = ereg_replace(' ','_',$_REQUEST['propertyname']);
$taxid = JRequest::getVar( 'taxid','' );
?>
<div class="table_bottomlinks2">
<ul>
<li  style=" background:none;"><img src="images/new_folder.png" alt="add a new folder" width="45" height="39" align="absmiddle" /><a class="modal" id="links1"  title="Add Folder"  href="index.php?option=com_camassistant&controller=documents&task=saddfolder&parentid=<?php if($type=='shared') { ?> 1<?php } else { ?> 0 <?php } ?>&spid=<?php print_r($sfiles->property_id); ?>&smid=<?php print_r($sfiles->property_manager_id); ?>&spath=<?php echo $val.$_REQUEST['propertyname'].'_'.$taxid; ?>&type=<?php echo $type; ?>&Itemid=<?php echo $_REQUEST['Itemid']; ?> " rel="{handler: 'iframe', size: {x: 400, y: 200}}" >Add a folder</a></li>
<li><img src="images/upload_folder.png" alt="Upload a file to this folder" width="37" height="36" align="middle" /><a class="modal" id="links1"  title="Upload File"  href="index.php?option=com_camassistant&controller=documents&task=saddfile&parentid=0&spid=<?php print_r($sfiles->property_id); ?>&smid=<?php print_r($sfiles->property_manager_id); ?>&spath=<?php echo $val.$_REQUEST['propertyname'].'_'.$taxid; ?>&propertyname=<?php echo $_REQUEST['propertyname']; ?>&Itemid=<?php echo $_REQUEST['Itemid']; ?>" rel="{handler: 'iframe', size: {x: 500, y: 250}}" >Upload a file</a></li> 
</ul>
</div>
</div></div>




<div class="clear"></div>
