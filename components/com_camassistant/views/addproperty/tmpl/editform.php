<?php
/**
 * @version		1.0.0 camassistant $
 * @package		camassistant
 * @copyright	Copyright ï¿½ 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');
JHTML::_('behavior.modal');
//echo ' ';
$user = JFactory::getUser();
$usertype = $user->user_type;
$userid = $user->id;
if($user->dmanager == 'yes'){
$db=&JFactory::getDBO();
$propertyid = JRequest::getVar('pid','');
$paths = "SELECT property_manager_id FROM #__cam_property WHERE  id='".$propertyid."'  ";
$db->setQuery($paths);
$userid = $db->loadResult();
}
$propertyid = JRequest::getVar('pid','');
$db=&JFactory::getDBO();
$ptypepro = "SELECT pro_type FROM #__cam_property WHERE  id='".$propertyid."'  ";
$db->setQuery($ptypepro);
$pro_type_proper = $db->loadResult();

?>
<script type="text/javascript">
function validate_data()
{
 var frm = document.addproperty;
 var rate_value = '<?php echo $pro_type_proper; ?>';
 if(rate_value == ''){
 rate_value = 'ass'
 }
 /*if (document.getElementById('ass').checked) {
  var rate_value = document.getElementById('ass').value;

}
if (document.getElementById('single').checked) {
  var rate_value = document.getElementById('single').value;
}*/

if(rate_value == 'ass'){
         var fup = document.getElementById('property_image'); 
 var fileName = fup.value;
 var ext = fileName.substring(fileName.lastIndexOf('.') + 1);
    if(frm.property_name.value == '')
    {
    alert('Please enter property name');
    frm.property_name.focus();
    return ;
    }
    else if(frm.street.value == '')
    {
    alert('Please enter property address');
    frm.street.focus();
    return ;
    }
    else if(frm.city.value == '')
    {
    alert('Please enter city');
    frm.city.focus();
    return ;
    }
    else if(frm.state.value == '0'||frm.state.value == '')
    {

    alert('Please select state');
    frm.state.focus();
    return ;
    }
    else if(frm.divcounty.value == '0'||frm.divcounty.value == '')
    {

    alert('Please select County');
    frm.divcounty.focus();
    return ;
    }
    else if(frm.zip.value == '')
    {
    alert('Please enter zipcode');
    frm.zip.focus();
    return ;
    }
    else if(frm.tax_id1.value == '')
    {
    alert('Please enter the TaxID');
    frm.tax_id1.focus();
    return ;
    }
    else if(frm.tax_id2.value == '')
    {
    alert('Please enter the TaxID');
    frm.tax_id2.focus();
    return ;
    }
    else if(document.getElementById('units').value == '')
    {
    alert('Please enter the Number of Units');
    frm.units.focus();
    return ;
    }
	else if(H('#manageridselected_ass').val() == ''){
	alert('Please select manager to manages this property');
    return ;
	}
	
	/*else if( H(".rep").is(':checked') ){
				ccmail = H('.ccemails').val() ;
				if(ccmail == ''){
				alert("Please enter separate email addresses with a semi-colon (;)");
				return ;
				}
				else{
					
					var ccemail = (ccmail).split('.com');
					
					var s = ccemail;
					var re = /,/g;
					for( var c = 0; re.exec(s); ++c );
					var mail=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+);	
					
					if(ccemail != '' && c>1){
						for (var i =1; i < ccemail.length-1; i++)
						 {		
						   if(ccemail[i].charAt(0) != ";"){
							 alert('Please separate the CC Emails with Semi colon(;)');
							 return ;  
							}
							else{
							
							}	
						 }	
						}
				}
			}*/
			
			
    if(ext == 'bmp'){
	  alert("Image file must be a .gif, .jpg, or .png.");
	  frm.property_image.focus();
	  return ;
	 }
	 
 else{ 
 tax_two=document.addproperty.elements['tax_id1'].value;
		tax_seven=document.addproperty.elements['tax_id2'].value;
		taxid = tax_two+'-'+tax_seven;
		H.post("index2.php?option=com_camassistant&controller=addproperty&task=verfirytaxid_edit", {queryString: ""+taxid+""}, function(data){
		
		if(data == 'invalid'){
		 var firstline = 'You have entered the Tax Identification for an Existing Property.  If this is your property please, contact your Administrator to have it reassigned to you.';
		 var secondline = 'If the property is not available to the Administrator, please call the CAMassistant Customer Support Team at 516-246-3830, and be prepared to provide a copy of the management agreement for the property to confirm your current status.';
		 var thirdline = firstline+'\n\n'+secondline;
 		alert(thirdline);
		document.addproperty.elements['tax_id1'].value = tax_two;
		document.addproperty.elements['tax_id2'].value = tax_seven;
		return;
		}
	else{
	frm.submit();
	}
		});
		}	
} else {
     var fup = document.getElementById('property_images'); 
		
		 var fileName = fup.value;
		 var ext = fileName.substring(fileName.lastIndexOf('.') + 1);
		
    if(frm.property_names.value == '')
    {
    alert('Please enter property name');
    frm.property_names.focus();
    return ;
    }
    else if(frm.streets.value == '')
    {
    alert('Please enter property address');
    frm.streets.focus();
    return ;
    }
    else if(frm.citys.value == '')
    {
    alert('Please enter city');
    frm.citys.focus();
    return ;
    }
    else if(frm.states.value == '0'||frm.states.value == '')
    {

    alert('Please select state');
    frm.states.focus();
    return ;
    }
    else if(frm.divcountys.value == '0'||frm.divcountys.value == '')
    {

    alert('Please select County');
    frm.divcountys.focus();
    return ;
    }
    else if(frm.zips.value == '')
    {
    alert('Please enter zipcode');
    frm.zips.focus();
    return ;
    }
    else if(frm.tax_id3s.value == '')
    {
    alert('Please enter property identification number');
    frm.tax_id3s.focus();
    return ;
    }
    else if(document.getElementById('unitss').value == '')
    {
    alert('Please enter the Number of Units');
    frm.unitss.focus();
    return ;
    }
	else if(H('#manageridselected_single').val() == ''){
	alert('Please select manager to manages this property');
    return ;
	}
	
	/*else if( H(".rep").is(':checked') ){
				ccmailsingle = H('.ccemailssingle').val() ;
				if(ccmailsingle == ''){
				alert("Please enter separate email addresses with a semi-colon (;)");
				return ;
				}
				else{
					var ccemail = (ccmailsingle).split('.com');
					var s = ccemail;
					var re = /,/g;
					for( var c = 0; re.exec(s); ++c );
					var mail=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+);	
					if(ccemail != '' && c>1){
						for (var i =1; i < ccemail.length-1; i++)
						 {		
						   if(ccemail[i].charAt(0) != ";"){
							 alert('Please separate the CC Emails with Semi colon(;)');
							 return ;  
							}
							else{
							
							}	
						 }	
						}
				}
			}*/
			
			
    if(ext == 'bmp'){
	  alert("Image file must be a .gif, .jpg, or .png.");
	  frm.property_images.focus();
	  return ;
	 }
	 
 else{ 
                tax_seven1=document.addproperty.elements['tax_id3s'].value;
				id=document.getElementById('id').value;
		taxid = tax_seven1;
		H.post("index2.php?option=com_camassistant&controller=addproperty&task=verfirytaxid_edit&pid="+id+"", {queryString: ""+taxid+""}, function(data){
		if(data == 'invalid'){
		 var firstline = 'You have entered the Tax Identification for an Existing Property.  If this is your property please, contact your Administrator to have it reassigned to you.';
		 var secondline = 'If the property is not available to the Administrator, please call the CAMassistant Customer Support Team at 516-246-3830, and be prepared to provide a copy of the management agreement for the property to confirm your current status.';
		 var thirdline = firstline+'\n\n'+secondline;
 		alert(thirdline);
		document.addproperty.elements['tax_id1s'].value = tax_two;
		document.addproperty.elements['tax_id2s'].value = tax_seven;
                document.addproperty.elements['tax_id3s'].value = tax_seven1;
		return;
		}
	else{
	frm.submit();
	}
		});
		}	
}
 //return;
} 

function CurrencyFormatted(amount)
{
	var i = parseFloat(amount);
	if(isNaN(i)) { i = 0.00; }
	var minus = '';
	if(i < 0) { minus = '-'; }
	i = Math.abs(i);
	i = parseInt((i + .005) * 100);
	i = i / 100;
	s = new String(i);
	if(s.indexOf('.') < 0) { s += '.00'; }
	if(s.indexOf('.') == (s.length - 2)) { s += '0'; }
	s = minus + s;
	return s;
} // function CurrencyFormatted()

function CommaFormatted(amount)
{
	var delimiter = ",";
	var a = amount.split('.',2)
	var d = a[1];
	var i = parseInt(a[0]);
	if(isNaN(i)) { return ''; }
	var minus = '';
	if(i < 0) { minus = '-'; }
	i = Math.abs(i);
	var n = new String(i);
	var a = [];
	while(n.length > 3)
	{
		var nn = n.substr(n.length-3);
		a.unshift(nn);
		n = n.substr(0,n.length-3);
	}
	if(n.length > 0) { a.unshift(n); }
	n = a.join(delimiter);
	if(d.length < 1) { amount = n; }
	else { amount = n + '.' + d; }
	amount = minus + amount;
	amount = amount.split('.',2)
	amount = amount[0];
	return amount;
	
} // function CommaFormatted()

  G = jQuery.noConflict();
function format_val(id,fieldname,fieldvalue){	
G.post("index2.php?option=com_camassistant&controller=proposals&task=vendor_proposal_edit_format_val", {id: ""+id+"",fieldname: ""+fieldname+"",fieldvalue:""+fieldvalue+""}, function(data){
//alert(data);
if(data.length >0) {
var x= fieldname+id;
G("#"+id).val(data);
//E("#task_price1").val(data); 
}
});
}
function add_commas(x,id)
{
	var val = parseFloat(x).toFixed(2)+'',
      rgx = /(\d+)(\d{3}[\d,]*\.\d{2})/;
  while (rgx.test(val)) {
    val = val.replace(rgx, '$1' + ',' + '$2');
  }
document.getElementById(id).value = val;
}

function unitsno()
{
	var s = new String();
	s = CurrencyFormatted(document.addproperty.units.value);
	s = CommaFormatted(s);
	document.addproperty.units.value = s;
}

</script>
<script type="text/javascript">
H = jQuery.noConflict();
var site='<?php echo JURI::root();?>';
var path='<?php echo addslashes(JPATH_SITE);?>';
var xhReq = createXMLHttpRequest();
var countyCount = 0;
function createXMLHttpRequest() 
{
	try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) {}
	try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch (e) {}
	try { return new XMLHttpRequest(); } catch(e) {}
	alert("XMLHttpRequest not supported");
	return null;
}
var xhReq = createXMLHttpRequest();


function onSumResult() 
{
	if (xhReq.readyState != 0 && xhReq.readyState != 4)  { return; }
	var serverResponse = xhReq.responseText;
	//alert(serverResponse)
	document.getElementById(globvariable).innerHTML = serverResponse;
	//alert('dfg')
}
function county(){
var state = H("#stateid").val();
H.post("index2.php?option=com_camassistant&controller=addproperty&task=ajaxcounty", {State: ""+state+""}, function(data){
if(data.length >0) {
H("#divcounty").html(data);
}
});

}
  </script>
  <script type="text/javascript">
  H(document).ready(function() {	
	H('#deleteimage').click(function(e) {
		var cnf = confirm("Are you sure you want to delete the image for this property ?");
			if(cnf == true){
				var pid = H("#id").val();
				H.post("index2.php?option=com_camassistant&controller=addproperty&task=removeproperty", {Pid: ""+pid+""}, function(data){
				if(data) {
					alert("Property Image has been deleted.");
					location.reload();
				}
				});
			}
			else{
				
			}
	});
});	
  </script>
  <script type="text/javascript">
  //Functio to verify taxid by sateesh on 01-08-11
/*function verifytaxid(){

		tax_two=document.addproperty.elements['tax_id1'].value;
		tax_seven=document.addproperty.elements['tax_id2'].value;
		
		first=document.addproperty.elements['first'].value;
		second=document.addproperty.elements['second'].value;
		id=document.addproperty.elements['id'].value;
		taxid = tax_two+'-'+tax_seven;
		H.post("index2.php?option=com_camassistant&controller=addproperty&task=verfirytaxid_edit", {queryString: ""+taxid+"",pid: ""+id+""}, function(data){
		if(data == 'invalid'){
		 var firstline = 'You have entered the Tax Identification for an Existing Property.  If this is your property please, contact your Administrator to have it reassigned to you.';
		 var secondline = 'If the property is not available to the Administrator, please call the CAMassistant Customer Support Team at 516-246-3830, and be prepared to provide a copy of the management agreement for the property to confirm your current status.';
		 var thirdline = firstline+'\n\n'+secondline;
 		alert(thirdline);
		document.addproperty.elements['tax_id1'].value = first;
		document.addproperty.elements['tax_id2'].value = second;
		return false;
		}
	else{
	H('#user-email').html('<font color="green">Property Association Tax ID Number accepted.</font>');
	}
		});
	}*/
  //Functio to verify taxid by sateesh on 01-08-11 completed	
  function showforma(){
	document.getElementById('signup-form-a').style.display='';
        document.getElementById('signup-form-s').style.display='none';
	}
    function showforms(){
        document.getElementById('signup-form-s').style.display='';
        document.getElementById('signup-form-a').style.display='none';
    }
	function showccemails(){
		H('.yesboard').show();	
	}
	function hideccemails(){
		H('.yesboard').hide();	
	}
	
	</script>
<?php
if($usertype == '11'){
echo "No permission";
} else {
?>
<div id="vender_right2">

<!-- eof dotshead -->
<div id="i_bar">
<div id="i_bar_txt" style="text-align:center; margin-left:30px;">
<span><strong>PROPERTY INFO:</strong>   </span>
</div>
<div id="i_icon"><a style="text-decoration: none;" title="Click here" class="modal" rel="{handler: 'iframe', size: {x: 680, y: 530}}" href="index2.php?option=com_content&amp;view=article&amp;id=79&amp;Itemid=113"><img src="images/info_icon2.png" alt="info" /></a></div>
</div>

<form action="index.php?option=com_camassistant&amp;controller=addpropetry&amp;task=editproperty&Itemid=75" method="post" name="addproperty" style="padding:0px; margin:0px;" enctype="multipart/form-data" >
<!-- sof table pan -->
<div class="table_pannel">



  <?php 
 //echo "<pre>"; print_r($this->details); 
for ($i=0; $i<count($this->details); $i++){
$details = $this->details[$i];
 

 $tax = $details->tax_id;
$tax4= explode('-',$tax);
$tax1= $tax4[0];
$tax2= $tax4[1];
$tax3= $tax4[2];

//echo '<pre>'; print_r($tax3);
//$tax1 = substr($tax, 0, -8);
//$tax2 = substr($tax, 3);

?>

<?php /*?><div class="signup" style="width:auto;">
<table cellpadding="0">
<tr><td colspan="2"><label>Please select the type of property you are adding:</label></td></tr>
<tr><td><input type="radio" onclick="javascript:showforma()" value="ass" <?php if($details->pro_type=='ass' || $details->pro_type==''){ ?> checked <?php } ?> id="ass" name="pro_type" disabled></td><td><strong>Association </strong>(Any property with a Tax-ID number)</td></tr>
<tr><td><input type="radio" onclick="javascript:showforms()" value="single" <?php if($details->pro_type=='single'){ ?> checked <?php } ?> id="single" name="pro_type" disabled></td><td><strong>Single Unit/Building</strong> (Any property without a Tax-ID number)</td></tr></table>
</div><br/><?php */?>

<?php if($details->pro_type){ ?>
<input type="hidden" name="pro_type" value="<?php echo $details->pro_type; ?>">
<?php } else { ?>
<input type="hidden" name="pro_type" value="ass">
<?php } ?>
<?php if($details->pro_type=='ass' || $details->pro_type==''){ ?>
<div id="signup-form-a">
<div class="signup">
<?php 
	if( $details->property_name_origin == '' )
		$propertyname = str_replace('_',' ',$details->property_name);
	else
		$propertyname = $details->property_name_origin;
?>

<label>Property Association Name: <span class="redstar">*</span> </label>
<input name="property_name" type="text" style="width:275px;" value="<?php echo $propertyname; ?>" />


</div>

<div class="signup">
<label>Property Address:<span class="redstar">*</span></label>
<input name="street" type="text" style="width:275px;" value="<?php echo $details->street;?>"/>
</div>

<div class="signup">
<label>City:<span class="redstar">*</span></label>
<input name="city" type="text" style="width:275px;" value="<?php echo $details->city;?>" />
</div>

<div class="signup">
<label>State:<span class="redstar">*</span> </label>
<select name="state" style="width:282px;" id="stateid" onchange="javascript:county();" >
<option value="">Please Select State</option>
  <?php 

for ($i=0; $i<count($this->states); $i++){
$states = $this->states[$i];
?>

<option value="<?php echo $states->state_id?>" <?php if($states->state_id==$details->state) echo "selected";?>><?php echo $states->state_name?></option>
<?php } ?>
</select>
</div>

<div class="signup">
<label>Please Select County:<span class="redstar">*</span> </label>
<select style="width: 282px;" name="divcounty" id="divcounty" >
 <?php 

for ($i=0; $i<count($this->details); $i++){
$detail = $this->details[$i];
?>
<option value="<?php echo $detail->cid?>" <?php if($detail->divcounty==$detail->cid) echo "selected";?>><?php echo $detail->County?></option>
<?php } ?>
</select>
</div>



<div class="signup">
<label>Zip Code:<span class="redstar">*</span> </label>
<input name="zip" type="text" style="width:275px;" value="<?php echo $details->zip;?>" maxlength="5"/>
</div>

<div class="signup">
<label>Time Zone:<span class="redstar">*</span> </label>
<select style="width: 340px;" name="timezone" id="timezone" >
<option <?php if( $details->timezone == 'eat'){ echo "selected='selected'"; } ?> value="est">(GMT -5:00) Eastern Time (US &amp; Canada), Bogota, Lima</option>
<option <?php if( $details->timezone == 'cen'){ echo "selected='selected'"; } ?> value="cen">(GMT -6:00) Central Time (US &amp; Canada), Mexico City</option>
<option <?php if( $details->timezone == 'mou'){ echo "selected='selected'"; } ?> value="mou">(GMT -7:00) Mountain Time (US &amp; Canada)</option>
<option <?php if( $details->timezone == 'pac'){ echo "selected='selected'"; } ?> value="pac">(GMT -8:00) Pacific Time (US &amp; Canada)</option>
<option <?php if( $details->timezone == 'ala'){ echo "selected='selected'"; } ?> value="ala">(GMT -9:00) Alaska</option>
<option <?php if( $details->timezone == 'haw'){ echo "selected='selected'"; } ?> value="haw">(GMT -10:00) Hawaii</option>
<option <?php if( $details->timezone == 'eni'){ echo "selected='selected'"; } ?> value="eni">(GMT -12:00) Eniwetok, Kwajalein</option>
<option <?php if( $details->timezone == 'midw'){ echo "selected='selected'"; } ?> value="midw">(GMT -11:00) Midway Island, Samoa</option>
<option <?php if( $details->timezone == 'car'){ echo "selected='selected'"; } ?> value="car">(GMT -4:30) Caracas</option>
<option <?php if( $details->timezone == 'atl'){ echo "selected='selected'"; } ?> value="atl">(GMT -4:00) Atlantic Time (Canada), La Paz, Santiago</option>
<option <?php if( $details->timezone == 'new'){ echo "selected='selected'"; } ?> value="new">(GMT -3:30) Newfoundland</option>
<option <?php if( $details->timezone == 'bra'){ echo "selected='selected'"; } ?> value="bra">(GMT -3:00) Brazil, Buenos Aires, Georgetown</option>
<option <?php if( $details->timezone == 'mid'){ echo "selected='selected'"; } ?> value="mid">(GMT -2:00) Mid-Atlantic</option>
<option <?php if( $details->timezone == 'azo'){ echo "selected='selected'"; } ?> value="azo">(GMT -1:00 hour) Azores, Cape Verde Islands</option>
<option <?php if( $details->timezone == 'wes'){ echo "selected='selected'"; } ?> value="wes">(GMT) Western Europe Time, London, Lisbon, Casablanca, Greenwich</option>
<option <?php if( $details->timezone == 'bru'){ echo "selected='selected'"; } ?> value="bru">(GMT +1:00 hour) Brussels, Copenhagen, Madrid, Paris</option>
<option <?php if( $details->timezone == 'kal'){ echo "selected='selected'"; } ?> value="kal">(GMT +2:00) Kaliningrad, South Africa, Cairo</option>
<option <?php if( $details->timezone == 'bag'){ echo "selected='selected'"; } ?> value="bag">(GMT +3:00) Baghdad, Riyadh, Moscow, St. Petersburg</option>
<option <?php if( $details->timezone == 'teh'){ echo "selected='selected'"; } ?> value="teh">(GMT +3:30) Tehran</option>
<option <?php if( $details->timezone == 'abu'){ echo "selected='selected'"; } ?> value="abu">((GMT +4:00) Abu Dhabi, Muscat, Yerevan, Baku, Tbilisi</option>
<option <?php if( $details->timezone == 'kab'){ echo "selected='selected'"; } ?> value="kab">(GMT +4:30) Kabul</option>
<option <?php if( $details->timezone == 'eka'){ echo "selected='selected'"; } ?> value="eka">(GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent</option>
<option <?php if( $details->timezone == 'mum'){ echo "selected='selected'"; } ?> value="mum">(GMT +5:30) Mumbai, Kolkata, Chennai, New Delhi</option>
<option <?php if( $details->timezone == 'kath'){ echo "selected='selected'"; } ?> value="kath">(GMT +5:45) Kathmandu</option>
<option <?php if( $details->timezone == 'alm'){ echo "selected='selected'"; } ?> value="alm">(GMT +6:00) Almaty, Dhaka, Colombo</option>
<option <?php if( $details->timezone == 'yan'){ echo "selected='selected'"; } ?> value="yan">(GMT +6:30) Yangon, Cocos Islands</option>
<option <?php if( $details->timezone == 'ban'){ echo "selected='selected'"; } ?> value="ban">(GMT +7:00) Bangkok, Hanoi, Jakarta</option>
<option <?php if( $details->timezone == 'bei'){ echo "selected='selected'"; } ?> value="bei">(GMT +8:00) Beijing, Perth, Singapore, Hong Kong</option>
<option <?php if( $details->timezone == 'tok'){ echo "selected='selected'"; } ?> value="tok">(GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk</option>
<option <?php if( $details->timezone == 'ade'){ echo "selected='selected'"; } ?> value="ade">(GMT +9:30) Adelaide, Darwin</option>
<option <?php if( $details->timezone == 'eas'){ echo "selected='selected'"; } ?> value="eas">(GMT +10:00) Eastern Australia, Guam, Vladivostok</option>
<option <?php if( $details->timezone == 'mag'){ echo "selected='selected'"; } ?> value="mag">(GMT +11:00) Magadan, Solomon Islands, New Caledonia</option>
<option <?php if( $details->timezone == 'auk'){ echo "selected='selected'"; } ?> value="auk">(GMT +12:00) Auckland, Wellington, Fiji, Kamchatka</option>
</select>
</div>

<div class="signup">
<label></label>
<input type="checkbox" id="location" name="location" style="width:0px;" value="loc" <?php if( $details->location == 'loc' || $details->location == '' ){ echo 'checked="checked"';} ?>>Location observes Daylight Savings
</div>

<div class="signup">
<label>Property Association Tax ID Number: <span class="redstar">*</span> </label>
<input id="tax_id1" name="tax_id1" type="text" style="width:20px; text-align:center;" value="<?php echo $tax1; ?>" maxlength="2" /> - 
<input id="tax_id2" name="tax_id2" type="text" style="width:90px; text-align:center;" value="<?php echo $tax2; ?>" maxlength="7" /><br />
<input type="hidden" name="first" value="<?php echo $tax1; ?>" />
<input type="hidden" name="second" value="<?php echo $tax2; ?>" />
</div>

<div class="signup">
<label>Number of Units:<span class="redstar">*</span> </label>
<input id="units" name="units" type="text" style="width:100px;" value="<?php echo $details->units; ?>" onblur="unitsno()"/>
</div>


<div class="signup">
<label>Who manages this property?:<span class="redstar">*</span> </label>
<select name="manageridass" style="width:282px;" id="manageridselected_ass">
<option value="">Select Manager</option>
  <?php 
for ($m=0; $m<count($this->managers_all); $m++){
$mans = $this->managers_all[$m];
if($mans->id == $details->property_manager_id)
	$selected = 'selected="selected"';
	else
	$selected = '';
?>
<option <?php echo $selected; ?>  value="<?php echo $mans->id; ?>" ><?php echo $mans->name.'&nbsp;'.$mans->lastname; ?></option>
<?php } ?>
</select>
</div>
<br />
<div class="signup">
<label>Upload Property Image:</label>
<p style="height: 40px;"></p>
<input type="file" name="property_image" id="property_image" style="width:276px; padding-left:4px;" value="" />
<input type="hidden" value="<?php echo $details->property_image; ?>" name="first_image" />
</div>
<br />
<?php /*?><div class="signup" style="width:350px;">
<label style="width:620px;">Would you like to copy any Board Members, listed for this property in the My Board Members page, on Proposal Reports once a request has ended?</label>
<div class="clear"></div>
<table cellpadding="0" cellspacing="0">
<tr><td width="10"><input type="radio" value="no" name="boards" <?php if( $detail->copy == 'no' || $detail->copy == '' ) { echo "checked='checked'" ; } ?> /></td><td>No</td></tr>
<tr><td width="10"><input type="radio" value="yes" name="boards" <?php if( $detail->copy == 'yes' ) { echo "checked='checked'" ; } ?> /></td><td>Yes</td></tr>
</table>
</div><?php */?>


<br />
<?php if($details->property_image) {
$path2 = $siteURL."components/com_camassistant/assets/images/property_pictures/";
		$path1 = $details->property_image;
		$image = $path2.$path1;	
		$image = str_replace(' ','%20',$image);
		$apath= getimagesize($image);
		$height_orig=$apath[1];
		$width_orig=$apath[0];
		$aspect_ratio = (float) $height_orig / $width_orig;
		$thumb_width =200;
		$thumb_height = round($thumb_width * $aspect_ratio) ;
		if($thumb_height == 0){
		$thumb_height = '307';
		}		
		echo "<img  width=".$thumb_width." height=".$thumb_height." src='components/com_camassistant/assets/images/property_pictures/".$details->property_image."'>";
?>
<div class="signup">
<a style="margin-left:90px; margin-top:20px;" href="javascript:void(0)" id="deleteimage"><img style="margin-top:20px;" src="templates/camassistant_left/images/close-icon.png"></a> &nbsp;&nbsp;
</div>

<?php } ?>
</div>
<?php } else { ?>
<div id="signup-form-s">
<div class="signup">
<?php 
	if( $details->property_name_origin == '' )
		$propertyname = str_replace('_',' ',$details->property_name);
	else
		$propertyname = $details->property_name_origin;
?>
		
<label>Property Name: <span class="redstar">*</span> </label>
<input name="property_names" type="text" style="width:275px;" value="<?php echo $propertyname; ?>" />


</div>

<div class="signup">
<label>Property Address:<span class="redstar">*</span></label>
<input name="streets" type="text" style="width:275px;" value="<?php echo $details->street;?>"/>
</div>

<div class="signup">
<label>City:<span class="redstar">*</span></label>
<input name="citys" type="text" style="width:275px;" value="<?php echo $details->city;?>" />
</div>

<div class="signup">
<label>State:<span class="redstar">*</span> </label>
<select name="states" style="width:282px;" id="stateid1" onchange="javascript:county();" >
<option value="">Please Select State</option>
  <?php 

for ($i=0; $i<count($this->states); $i++){
$states = $this->states[$i];
?>

<option value="<?php echo $states->state_id?>" <?php if($states->state_id==$details->state) echo "selected";?>><?php echo $states->state_name?></option>
<?php } ?>
</select>
</div>

<div class="signup">
<label>Please Select County:<span class="redstar">*</span> </label>
<select style="width: 282px;" name="divcountys" id="divcounty1" >
 <?php 
//print_r($this->details);exit;
for ($i=0; $i<count($this->details); $i++){
$detail = $this->details[$i];
?>
<option value="<?php echo $detail->cid?>" <?php if($detail->divcounty==$detail->cid) echo "selected";?>><?php echo $detail->County?></option>
<?php } ?>
</select>
</div>



<div class="signup">
<label>Zip Code:<span class="redstar">*</span> </label>
<input name="zips" type="text" style="width:275px;" value="<?php echo $details->zip;?>" maxlength="5"/>
</div>

<div class="signup">
<label>Time Zone:<span class="redstar">*</span> </label>
<select style="width: 340px;" name="timezones" id="timezones" >
<option <?php if( $details->timezone == 'eat'){ echo "selected='selected'"; } ?> value="est">(GMT -5:00) Eastern Time (US &amp; Canada), Bogota, Lima</option>
<option <?php if( $details->timezone == 'cen'){ echo "selected='selected'"; } ?> value="cen">(GMT -6:00) Central Time (US &amp; Canada), Mexico City</option>
<option <?php if( $details->timezone == 'mou'){ echo "selected='selected'"; } ?> value="mou">(GMT -7:00) Mountain Time (US &amp; Canada)</option>
<option <?php if( $details->timezone == 'pac'){ echo "selected='selected'"; } ?> value="pac">(GMT -8:00) Pacific Time (US &amp; Canada)</option>
<option <?php if( $details->timezone == 'ala'){ echo "selected='selected'"; } ?> value="ala">(GMT -9:00) Alaska</option>
<option <?php if( $details->timezone == 'haw'){ echo "selected='selected'"; } ?> value="haw">(GMT -10:00) Hawaii</option>
<option <?php if( $details->timezone == 'eni'){ echo "selected='selected'"; } ?> value="eni">(GMT -12:00) Eniwetok, Kwajalein</option>
<option <?php if( $details->timezone == 'midw'){ echo "selected='selected'"; } ?> value="midw">(GMT -11:00) Midway Island, Samoa</option>
<option <?php if( $details->timezone == 'car'){ echo "selected='selected'"; } ?> value="car">(GMT -4:30) Caracas</option>
<option <?php if( $details->timezone == 'atl'){ echo "selected='selected'"; } ?> value="atl">(GMT -4:00) Atlantic Time (Canada), La Paz, Santiago</option>
<option <?php if( $details->timezone == 'new'){ echo "selected='selected'"; } ?> value="new">(GMT -3:30) Newfoundland</option>
<option <?php if( $details->timezone == 'bra'){ echo "selected='selected'"; } ?> value="bra">(GMT -3:00) Brazil, Buenos Aires, Georgetown</option>
<option <?php if( $details->timezone == 'mid'){ echo "selected='selected'"; } ?> value="mid">(GMT -2:00) Mid-Atlantic</option>
<option <?php if( $details->timezone == 'azo'){ echo "selected='selected'"; } ?> value="azo">(GMT -1:00 hour) Azores, Cape Verde Islands</option>
<option <?php if( $details->timezone == 'wes'){ echo "selected='selected'"; } ?> value="wes">(GMT) Western Europe Time, London, Lisbon, Casablanca, Greenwich</option>
<option <?php if( $details->timezone == 'bru'){ echo "selected='selected'"; } ?> value="bru">(GMT +1:00 hour) Brussels, Copenhagen, Madrid, Paris</option>
<option <?php if( $details->timezone == 'kal'){ echo "selected='selected'"; } ?> value="kal">(GMT +2:00) Kaliningrad, South Africa, Cairo</option>
<option <?php if( $details->timezone == 'bag'){ echo "selected='selected'"; } ?> value="bag">(GMT +3:00) Baghdad, Riyadh, Moscow, St. Petersburg</option>
<option <?php if( $details->timezone == 'teh'){ echo "selected='selected'"; } ?> value="teh">(GMT +3:30) Tehran</option>
<option <?php if( $details->timezone == 'abu'){ echo "selected='selected'"; } ?> value="abu">((GMT +4:00) Abu Dhabi, Muscat, Yerevan, Baku, Tbilisi</option>
<option <?php if( $details->timezone == 'kab'){ echo "selected='selected'"; } ?> value="kab">(GMT +4:30) Kabul</option>
<option <?php if( $details->timezone == 'eka'){ echo "selected='selected'"; } ?> value="eka">(GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent</option>
<option <?php if( $details->timezone == 'mum'){ echo "selected='selected'"; } ?> value="mum">(GMT +5:30) Mumbai, Kolkata, Chennai, New Delhi</option>
<option <?php if( $details->timezone == 'kath'){ echo "selected='selected'"; } ?> value="kath">(GMT +5:45) Kathmandu</option>
<option <?php if( $details->timezone == 'alm'){ echo "selected='selected'"; } ?> value="alm">(GMT +6:00) Almaty, Dhaka, Colombo</option>
<option <?php if( $details->timezone == 'yan'){ echo "selected='selected'"; } ?> value="yan">(GMT +6:30) Yangon, Cocos Islands</option>
<option <?php if( $details->timezone == 'ban'){ echo "selected='selected'"; } ?> value="ban">(GMT +7:00) Bangkok, Hanoi, Jakarta</option>
<option <?php if( $details->timezone == 'bei'){ echo "selected='selected'"; } ?> value="bei">(GMT +8:00) Beijing, Perth, Singapore, Hong Kong</option>
<option <?php if( $details->timezone == 'tok'){ echo "selected='selected'"; } ?> value="tok">(GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk</option>
<option <?php if( $details->timezone == 'ade'){ echo "selected='selected'"; } ?> value="ade">(GMT +9:30) Adelaide, Darwin</option>
<option <?php if( $details->timezone == 'eas'){ echo "selected='selected'"; } ?> value="eas">(GMT +10:00) Eastern Australia, Guam, Vladivostok</option>
<option <?php if( $details->timezone == 'mag'){ echo "selected='selected'"; } ?> value="mag">(GMT +11:00) Magadan, Solomon Islands, New Caledonia</option>
<option <?php if( $details->timezone == 'auk'){ echo "selected='selected'"; } ?> value="auk">(GMT +12:00) Auckland, Wellington, Fiji, Kamchatka</option>
</select>

</div>

<div class="signup">
<label></label>
<input type="checkbox" id="locations" name="locations" style="width:0px;" value="loc" <?php if( $details->location == 'loc' || $details->location == '' ){ echo 'checked="checked"'; } ?>>Location observes Daylight Savings 
</div>


<?php
$einnumber = $this->einnumner;
$ein = explode('-',$einnumber);
?>
<div class="signup" style="width:400px;">
<label style="width:500px;">Property Identification Number (first two fields are your company's EIN#):<span class="redstar">*</span> </label>
<input id="" name="" type="text" readonly="readonly" style="width:30px; text-align:center;" value="<?php echo $ein[0]; ?>" maxlength="2" /> -
<input id="" name="" type="text" readonly="readonly" style="width:90px; text-align:center;" value="<?php echo $ein[1]; ?>" maxlength="7" /> 
<?php if($ein[2]){ ?>
- <input id="" name="" type="text" readonly="readonly" style="width:30px; text-align:center;" value="<?php echo $ein[2]; ?>" /> 
<?php } ?>
-
<input id="tax_id2" name="tax_id3s" type="text" style="width:150px; text-align:center;" value="<?php echo $tax1; ?>" maxlength="20" /><br />
<input type="hidden" name="first" value="<?php echo $tax1; ?>" />
</div>

<div class="signup">
<label>Number of Units:</label>
<input id="unitss" name="unitss" type="text" style="width:100px;" value="<?php echo $details->units; ?>" onblur="unitsno()"/>
</div>


<div class="signup">
<label>Who manages this property?:<span class="redstar">*</span> </label>
<select name="managerid" style="width:282px;" id="manageridselected_single">
<option value="">Select Manager</option>
  <?php 
for ($m=0; $m<count($this->managers_all); $m++){
$mans = $this->managers_all[$m];
	if($mans->id == $details->property_manager_id)
	$selected = 'selected="selected"';
	else
	$selected = '';
?>
<option <?php echo $selected; ?> value="<?php echo $mans->id; ?>"><?php echo $mans->name.'&nbsp;'.$mans->lastname; ?></option>
<?php } ?>
</select>
</div>
<br />
<div class="signup">
<label>Upload Property Image: </label>
<input type="file" name="property_images" id="property_images" style="width:276px; padding-left:4px;" value="" />
<input type="hidden" value="<?php echo $details->property_image; ?>" name="first_image" />
</div>
<br />
<?php /*?><div class="signup" style="width:350px;">
<label style="width:620px;">Would you like to copy any Board Members, listed for this property in the My Board Members page, on Proposal Reports once a request has ended?</label>
<div class="clear"></div>
<table cellpadding="0" cellspacing="0">
<tr><td width="10"><input type="radio" value="no" name="board" <?php if( $details->copy == 'no' || $details->copy == '' ) { echo "checked='checked'" ; } ?> /></td><td>No</td></tr>
<tr><td><input type="radio" value="yes" name="board" <?php if( $details->copy == 'yes' ) { echo "checked='checked'" ; } ?> /></td><td>Yes</td></tr>
</table>
</div><?php */?>

<br />
<?php if($details->property_image) {
$path2 = $siteURL."components/com_camassistant/assets/images/property_pictures/";
		$path1 = $details->property_image;
		$image = $path2.$path1;	
		$image = str_replace(' ','%20',$image);
		$apath= getimagesize($image);
		$height_orig=$apath[1];
		$width_orig=$apath[0];
		$aspect_ratio = (float) $height_orig / $width_orig;
		$thumb_width =200;
		$thumb_height = round($thumb_width * $aspect_ratio) ;
		if($thumb_height == 0){
		$thumb_height = '307';
		}		
		echo "<img  width=".$thumb_width." height=".$thumb_height." src='components/com_camassistant/assets/images/property_pictures/".$details->property_image."'>";
?>
<div class="signup">
<a style="margin-left:90px; margin-top:20px;" href="javascript:void(0)" id="deleteimage"><img style="margin-top:20px;" src="templates/camassistant_left/images/close-icon.png"></a> &nbsp;&nbsp;
</div>

<?php } ?>
</div>
<?php } ?>

<div class="clear"></div><br />
<!--<div><input type="checkbox" value="1" name="share">&nbsp;I do not want to share the high, low and awarded proposal dollar amounts to the un-awarded vendors for this property</div>-->
<div id="topborder_row" align="center">
<!--<a href="#"><img src="templates/camassistant_left/images/discardchanges.gif" alt="discard changes" width="182" height="48" /></a>-->
<input type="hidden" name="controller" />
<a class="cancel_property" href="index.php?option=com_camassistant&controller=addproperty&Itemid=75"></a>
<a class="save_property" href="javascript: validate_data();"></a></div>

<input type="hidden" name="userid" value="<?php echo $userid; ?>" />
<input type="hidden" name="usertype" value="<?php echo $usertype; ?>" />
<input type="hidden" name="id" id="id" value="<?php echo $details->id; ?>" />

<input type="hidden" name="companyid" value="<?php echo $details->company_id; ?>" />
<input type="hidden" name="controller" value="addproperty" />
<input type="hidden" name="task" value="editproperty" />
</form>
<?php } ?>
<div class="clear"></div>
</div>





<!-- eof table pan -->

</div>

<?php } ?>
