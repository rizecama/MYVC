<?php
/**
 * @version		1.0.0 camassistant $
 * @package		camassistant
 * @copyright	Copyright © 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');
$property = $this->property;
$propertyownerinfo = $this->propertyownerinfo;
//echo '<pre>';print_r($property);exit;
$pid = JRequest::getVar("pid",'');
$phone = explode('-',$property->phone);
$altphone = explode('-',$property->altphone);
$fax = explode('-',$property->fax);
$tax_id = explode('-',$property->tax_id);

$accept = JRequest::getVar('accept','');
$plink = JRequest::getVar('plink','');
$filename = $property->property_image;
if($filename)
{
	   $path2 = $siteURL."components/com_camassistant/assets/images/property_pictures/";
		$path1 = $filename;
		$image = $path2.$path1;	
		$image = str_replace(' ','%20',$image);
		$apath= getimagesize($image);
		$height_orig=$apath[1];
		$width_orig=$apath[0];
		$aspect_ratio = (float) $height_orig / $width_orig;
		$thumb_width =438;
		$thumb_height = round($thumb_width * $aspect_ratio) ;
		if($thumb_height == 0){
		$thumb_height = '307';
		}		
		
		}	
$Itemid = JRequest::getVar('Itemid',''); 
?>
<script type="text/javascript" src="<?php echo Juri::base(); ?>components/com_camassistant/skin/js/jquery-1.4.4.min.js"></script>
<script type="text/javascript">
G = jQuery.noConflict();
function validate_data2()
{
var frm = document.property_edit;
if(frm.property_name.value == '')
    {
    alert('Please enter property name');
    frm.property_name.focus();
    return ;
    }
   /* else if(frm.ein1.value == '')
    {
    alert('Please enter ein number');
    frm.ein1.focus();
    return ;
    }
	else if(frm.ein2.value == '')
    {
    alert('Please enter ein number');
    frm.ein2.focus();
    return ;
    }*/
    else if(frm.board_position.value == '')
    {
    alert('Please select your relation ship');
    frm.board_position.focus();
    return ;
    }
    else if(frm.streeaddress.value == '')
    {
    alert('Please enter property address');
    frm.streeaddress.focus();
    return ;
    }
	else if(frm.city.value == '')
    {
    alert('Please enter city');
    frm.city.focus();
    return ;
    }
    else if(frm.state.value == '0'||frm.state.value == '')
    {

    alert('Please select state');
    frm.state.focus();
    return ;
    }
    else if(frm.zipcode.value == '')
    {
    alert('Please enter zipcode');
    frm.zipcode.focus();
    return ;
    }
    
    else if(frm.divcounty.value == '0'||frm.divcounty.value == '')
    {

    alert('Please select County');
    frm.divcounty.focus();
    return ;
    }
    
	else{
	G("#property_edit").submit();
	}
}


function county(){
var state = G("#stateid").val();
G.post("index2.php?option=com_camassistant&controller=addproperty&task=ajaxcounty", {State: ""+state+""}, function(data){
if(data.length >0) {
G("#divcounty").html(data);
}
});

}

function getpopuppics(pid){
el='<?php  echo Juri::base(); ?>index2.php?option=com_camassistant&controller=addproperty&task=editpropertypic&pid='+pid;
var options = $merge(options || {}, Json.evaluate("{handler: 'iframe', size: {x: 500, y:350}}"))
SqueezeBox.fromElement(el,options);
}
function cancel()
{
window.location="index.php?option=com_camassistant&controller=addproperty&Itemid=75";
}
</script>
<script type="text/javascript">
L = jQuery.noConflict();
L(document).ready(function(){
L('#property_name').keyup(function(){
		if( L(this).val() == '' )
		L( this ).prev().addClass( 'active' );
		else
		L( this ).prev().removeClass( 'active' );
		
	});	
	
L('#board_position').change(function(){
		if( L(this).val() != '0' )
		L( this ).prev().removeClass( 'active' );
		else
		L( this ).prev().addClass( 'active' );
		
	});
	
L('#streeaddress').keyup(function(){
		if( L(this).val() == '' )
		L( this ).prev().addClass( 'active' );
		else
		L( this ).prev().removeClass( 'active' );
		
	});	
L('#city').keyup(function(){
		if( L(this).val() == '' )
		L( this ).prev().addClass( 'active' );
		else
		L( this ).prev().removeClass( 'active' );
		
	});		
L('#stateid').change(function(){
		if( L(this).val() != '0' )
		L( this ).prev().removeClass( 'active' );
		else
		L( this ).prev().addClass( 'active' );
		
	});
L('#zipcode').keyup(function(){
		if( L(this).val() == '' )
		L( this ).prev().addClass( 'active' );
		else
		L( this ).prev().removeClass( 'active' );
		
	});
L('#divcounty').change(function(){
		if( L(this).val() != '0' )
		L( this ).prev().removeClass( 'active' );
		else
		L( this ).prev().addClass( 'active' );
		
	});
L('#timezone').change(function(){
		if( L(this).val() != '0' )
		L( this ).prev().removeClass( 'active' );
		else
		L( this ).prev().addClass( 'active' );
		
	});
L('#units').keyup(function(){
		if( L(this).val() == '' )
		L( this ).prev().addClass( 'active' );
		else
		L( this ).prev().removeClass( 'active' );
		
	});
L('#phone_1').keyup(function(){
		if( L(this).val() == '' )
		L( this ).prev().addClass( 'active' );
		else
		L( this ).prev().removeClass( 'active' );
		
	});			
	
					
	});
</script>

<div class="acount_status">
<div class="account_border ttl1">Property Status</div>
<div class="newtopborder1"></div>
<div class="property_linkask">
<div class="client_linkask">
<label><img src="templates/camassistant_left/images/property_unlink.png"> </label>
<div class="unlinkmangerss">This Property is not Linked with a Manager</div>
</div>
</div>
</div>
<div id="container_inner" class="property_status">
<div  style="margin-top:20px;">
 <div class="ttl1">Property Information</div>
<div class="newtopborder1"></div>
</div>
<form enctype="multipart/form-data"  method="post" name="property_edit" id="property_edit">
<div class="clear"></div>
<?php //echo "<pre>"; print_r($this->details); ?>
<div id="signup-form">
<?php if($filename) {?>
<div class="signUp-left">
<div class="signup">
<span id="prop_list">
<input type="file" class="file_class" name ="property_image"/>
<div id = "uplaod_pimage"><a class="uploadimagetextes" href="javascript:void(0);" onclick="getpopuppics(<?php echo $pid;?>)" ><img src="components/com_camassistant/assets/images/property_pictures/<?php echo $filename?>"></a></div>
</span>
</div>
</div>
<?php } else { ?>
<div class="signUp-left">
<div class="signup">
<span id="prop_list">
<input type="file" class="file_class" name ="property_image"/>
<a id = "uplaod_pimage" href="javascript:void(0);" onclick="getpopuppics(<?php echo $pid;?>)" ><span class="uploadimagetextes" >Click here to upload an image of your property</span></a>
</span>
</div>
</div>
<?php } ?>
<div class="signUp-right">
<div class="signup">
<label class="editpropertyownerredicons">Property Name:</label>
<input name="property_name" type="text" style="width:328px;"  id="property_name" value="<?PHP echo str_replace('_',' ',$property->property_name)?>"/>
</div>

<div class="signup">
<label class="editpropertyownerredicons">Title (your relation to this property):</label>
<select name="board_position" id="board_position" style="width:335px;" >
<option value="Owner" <?PHP if($property->boardposition == 'owner'){?> selected="selected" <?PHP } ?>>Owner</option>
<option value="President" <?PHP if($property->boardposition == 'President'){?> selected="selected" <?PHP } ?>>President</option>
<option value="Vice President" <?PHP if($property->boardposition == 'Vice President') {?> selected="selected" <?PHP } ?>>Vice President</option>
<option value="Treasurer" <?PHP if($property->boardposition == 'Treasurer') { ?> selected="selected" <?PHP } ?>>Treasurer</option>
<option value="Secretary" <?PHP if($property->boardposition == 'Secretary') { ?> selected="selected" <?PHP } ?>>Secretary</option>
<option value="Director" <?PHP if($property->boardposition == 'Director') { ?> selected="selected" <?PHP } ?>>Director</option>

</select>
</div>

</div>

<div class="form-sm">

<div class="signup">
<label class="editpropertyownerredicons">Street Address:  </label>
<input name="streeaddress" type="text" id="streeaddress" value="<?PHP echo $property->street?>"/>
</div>
<div class="signup">
<label class="editpropertyownerredicons">City:  </label>
<input name="city" type="text" id="city" value="<?PHP echo $property->city?>"/>
</div>
<div class="signup col_2">
<div class="state">
<label class="editpropertyownerredicons">State: </label>
<select name="state"  id="stateid" onchange="javascript:county();" >
<option value="">Select State</option>
  <?php 

for ($i=0; $i<count($this->states); $i++){
$states = $this->states[$i];
?>

<option value="<?php echo $states->state_id?>" <?php if($states->state_id== $property->state) echo "selected";?>><?php echo $states->state_name?></option>
<?php } ?>
</select>
</div>
<div class="zip">
<label class="editpropertyownerredicons">Zip Code:</label>
<input name="zipcode" type="text" id="zipcode" maxlength="5"   value="<?PHP echo $property->zip?>"/>
</div>
</div>
<div class="signup">
<div class="state">
<label class="editpropertyownerredicons">County: </label>
<select  name="divcounty" id="divcounty" >
<?php 

for ($i=0; $i<count($this->details); $i++){
$detail = $this->details[$i];
?>
<option value="<?php echo $detail->cid?>" <?php if($detail->divcounty==$detail->cid) echo "selected";?>><?php echo $detail->County?></option>
<?php } ?>
</select>
</div>
</div>
<div class="signup">
<label class="editpropertyownerredicons">Time Zone:  </label>
<select  name="timezone"  id="timezone" >
<option <?php if( $property->timezone == 'eat'){ echo "selected='selected'"; } ?> value="est">(GMT -5:00) Eastern Time (US &amp; Canada), Bogota, Lima</option>
<option <?php if( $property->timezone == 'cen'){ echo "selected='selected'"; } ?> value="cen">(GMT -6:00) Central Time (US &amp; Canada), Mexico City</option>
<option <?php if( $property->timezone == 'mou'){ echo "selected='selected'"; } ?> value="mou">(GMT -7:00) Mountain Time (US &amp; Canada)</option>
<option <?php if( $property->timezone == 'pac'){ echo "selected='selected'"; } ?> value="pac">(GMT -8:00) Pacific Time (US &amp; Canada)</option>
<option <?php if( $property->timezone == 'ala'){ echo "selected='selected'"; } ?> value="ala">(GMT -9:00) Alaska</option>
<option <?php if( $property->timezone == 'haw'){ echo "selected='selected'"; } ?> value="haw">(GMT -10:00) Hawaii</option>
</select>
</div>
<div class="signup checkBox" >
<input type="checkbox" value="loc" name="location" <?php if( $property->location == 'loc' || $property->location == '' ){ echo 'checked="checked"';} ?> id="location"> Location observes Daylight Savings
</div>
<div class="signup units">
<label class="editpropertyownerredicons">No. of Units (if applicable):  </label>
<input name="units" type="text" id="units" value="<?php echo $property->units;?>"/>
</div>

<div class="signup">
<div class="cp">
<label class="editpropertyownerredicons">Phone: </label>
<input id="phone_1" name="phone_1" type="text"  id="phone_1" maxlength="3" class="sm-input"  value="<?PHP echo $phone[0]; ?>"  />
 <input id="phone_2" name="phone_2" type="text"  maxlength="3" class="sm-input" value="<?PHP echo $phone[1]; ?>" ); "/> - 
 <input id="phone_3" name="phone_3" type="text"   maxlength="4" class="sm-input" value="<?PHP echo $phone[2]; ?>" "/> |
</div>

<div class="ext">
<label style=" margin-left:-45px; margin-top:-9px;"">Ext:</label>
<input name="extension" type="text" maxlength="4"   class="sm-input"  style=" margin-left:-45px;" value="<?PHP echo $property->pext ?>"   /></div>
<div class="clear"></div>
</div>																			
<div class="signup">
<div class="cp">
<label style="padding: 15px 0 3px 0px;">Alt. Phone: </label>
<input id="altphone_1" name="altphone_1" type="text"  maxlength="3" class="sm-input" value="<?PHP echo $altphone[0]; ?>" />
 <input id="altphone_2" name="altphone_2" type="text"   maxlength="3" class="sm-input" value="<?PHP echo $altphone[1]; ?>" "/> - 
 <input id="altphone_3" name="altphone_3" type="text"  maxlength="4" class="sm-input" value="<?PHP echo $altphone[2]; ?>"  "/> |
</div>

<div class="ext">
<label style=" margin-left:-45px;">Ext:</label>
<input name="altextension" type="text" maxlength="4"   style=" margin-left:-45px;" class="sm-input" value="<?php echo $property->altext?>"  /></div>
<div class="clear"></div>
</div>																			
<div class="signup">

<label style="padding: 15px 0 3px 0px;">Fax:</label>
<input id="fax_1" name="fax_1" type="text"  class="sm-input" maxlength="3" value="<?PHP echo $fax[0]; ?>" />
 <input id="fax_2" name="fax_2" type="text"   class="sm-input" maxlength="3" value="<?PHP echo $fax[1]; ?>"  "/> - 
 <input id="fax_3" name="fax_3" type="text"   class="sm-input" maxlength="4" value="<?PHP echo $fax[2]; ?>"  "/>
</div>


</div>



<div class="clear"></div>
<div class="form_checkbox">
<div class="check"></div>
<div class="inner_client-heading">
        <div class="ttl1">Your Permissions</div>
		<div class="newtopborderper"></div>
      </div><!-- inner_client-heading -->
      <div class="linknotetoowner">Note: This feature is currently unavailable. If you choose to LINK your Property with a Manager then the below details will be activated to display your current permission levels.</div>
	      <div class="blockmanagerdetails"> 
          <div class="client_permission_block">
            <div class="form-ttl-sm" style="color: #ccc;">Copied on Vendor proposals?</div>
            <div>When you end a request, your client will receive an automatic email notification with a link to download a copy of the proposal report, which will contain every Vendor's submitted proposal.</div>
            <div><input type="radio" name="vendor_proposals"  checked="checked"  disabled value="1" > <label>Yes</label> 
            <input type="radio" name="vendor_proposals" onclick="return false;"  value="0"> <label>No</label></div>
          </div><br/><!-- client_permission_block -->
          
          <div class="client_permission_block">
            <div class="form-ttl-sm" style="color: #ccc;">Access to "My Vendor" list?</div>
            <div >Your client will have "read-only" access to your "My Vendors" list or "Corporate Preferred Vendors" list (Master Account holders only). This allows them the ability to view contact information, compliance statuses, and more.  Note:  They will not be able to remove, add, or edit your list.</div>
            <div><input type="radio" name="myvendor_list"  value="1" checked="checked" disabled> <label>Yes</label> 
            <input type="radio" name="myvendor_list" value="0" onclick="return false";> <label>No</label></div><br/>
          </div><!-- client_permission_block -->
          
          <div class="client_permission_block">
            <div class="form-ttl-sm" style="color: #ccc;">Ability to invite Vendors to requests?</div>
            <div >Your Client will be able to invite Vendors to participate in requests that you submitted for this property only.  Note: They will not be able to uninvite vendors, send reminders, or end bidding.</div>
            <div><input type="radio" name="invite_vendors" checked="checked"  disabled value="1"> <label>Yes</label> 
            <input type="radio" name="invite_vendors" value="0" onclick ="return false;" > <label>No</label></div><br/>
          </div><!-- client_permission_block -->
          
          <div class="client_permission_block">
            <div class="form-ttl-sm" style="color: #ccc;">Requires approval before submitting requests?</div>
            <div >Your Client will be required to approve the submission of a request before it is delivered to Vendors. If a project is not approved, the Client will be able to submit feedback so your request may be revised and then resubmitted for approval.</div>
            <div><input type="radio" name="approval_request"checked="checked"  disabled value="1" > <label>Yes</label> 
            <input type="radio" name="approval_request"   onclick="return false"  value="0" > <label>No</label></div><br/>
          </div><!-- client_permission_block -->
          
          <div class="client_permission_block">
            <div class="form-ttl-sm" style="color: #ccc;">Requires approval before awarding requests?</div>
            <div>Your Client will be required to approve the awarding of a request to a Vendor before notifications are delivered to all participating Vendors.  If an award is not approved, the Client will be able to submit feedback so the awarding may be revised and then resubmitted for approval.</div>
            <div><input type="radio"  name="approval_awarding" checked="checked"  disabled value="1"> <label>Yes</label> 
            <input type="radio" name="approval_awarding" value="0"  onclick="return false;"> <label>No</label></div><br/>
          </div><!-- client_permission_block -->
  </div>


<div class="checktext">
<input type="hidden" name="user_id" value="<?PHP  echo $this->user_id; ?>" />
<a  href="javascript:void(0)" class="manager_cancel" onclick="cancel()"></a>
<a  href="javascript:void(0)" class="manager_submit" onclick="javascript: return validate_data2();"></a>
 </div>
</div>

<input type="hidden" value="com_camassistant" name="option" />
<input type="hidden" value="addproperty" name="controller" />
<input type="hidden" value="propertyowner_editform" name="task" />
<input type="hidden" value="" id="image_name" name="image_name" />
<input type="hidden" value="<?php echo $pid; ?>"  name="pid" />

<div class="clear"></div>
</div>

</form>
</div> 
<div class="clear"></div>
</div>
