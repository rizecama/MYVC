<?php
/**
 * @version		1.0.0 camassistant $
 * @package		camassistant
 * @copyright	Copyright Â© 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');

jimport( 'joomla.application.component.view' );


class addpropertyViewaddproperty extends Jview
{
	function display($tpl = null){
		// global $mainframe;
		$task = JRequest::getVar("task",'');
		$properties	=& $this->get('Data');
		//echo "<pre>";
	//echo '<pre>';print_r($properties);exit;
		
		$pagination = & $this->get( 'Pagination' );
		$from = JRequest::getVar("from",'');
		
		//$this->assignRef('pagination',	$pagination);
		$this->assignRef('properties', $properties);
		if($task == 'addproperty')
		//For board members
	   {
	   $model = $this->getModel('addproperty');
	 	$bmembers = $model->getbmembers();
		$this->assignRef('bmembers1',$bmembers);
		$einnumner = $model->getcompanyinfo();
		$this->assignRef('einnumner',$einnumner);
		$managers_all = $model->managemanagers();
		$this->assignRef('managers_all',$managers_all);
		$this->setLayout('addform');
		}
      
		if($task =='boardmemberslist') {
	   $model = $this->getModel('addproperty');
		$boardmembers = $model->getboardmembers();

		$this->assignRef('boardmembers',$boardmembers);
		$this->setLayout('boardmembers');
		}
		if($task =='addboardmember') {

		 $model = $this->getModel('addproperty');
		$rows= $model->getProperties();
		//print_r($rows);
		$row1[0] = new stdClass();
		$row1[0]->value = "";
		$row1[0]->text = "Select Propety";
		$rows=array_merge($row1,$rows);
		$this->assignRef('propertyList',$rows);
		//$this->assignRef('boardmembers',$boardmembers);
		$this->setLayout('addboardmember');
		}

		//Completed


		//Custmers list
		//$custmers2=array();
		$user =& JFactory::getUser();
		$user_id = $user->get('id');
		$user_name = $user->get('name');
		$lastname = $user->get('lastname');
		$user_type = $user->get('user_type');
		
			$custmers = & $this->get( 'custmers' );
			
			$this->assignRef('custmers',$custmers);
		
		
			$stateslist = & $this->get( 'statelist' );
			$this->assignRef('statelist',$stateslist);
		//Completed
		// Getting countries list
		$states = & $this->get( 'states' );
		$this->assignRef('states',	$states);
		//Completed
		// Getting boardmembers list
		$bmembers = & $this->get( 'boardmembers' );
		$this->assignRef('bmembers',$bmembers);
		//Completed

		//For edit the proeprty


		if($task == 'view'){
	   $model = $this->getModel('addproperty');
	 	$bmembers = $model->getbmembers();
		$details = & $this->get( 'Pdetails' );
		$this->assignRef('details',	$details);
		$this->assignRef('bmembers1',$bmembers);
		$einnumner = $model->getcompanyinfo();
		$this->assignRef('einnumner',$einnumner);
		$managers_all = $model->managemanagers();
		$this->assignRef('managers_all',$managers_all);
		$this->setLayout('editform');
		}
		
		//sreenu
		
	  
		
			
		if($task=='reasign')
		{
		$pinfo = & $this->get( 'propertyinfo' );
		$this->assignRef('pinfo',	$pinfo);
		$this->assignRef('pid',	$_REQUEST['pid']);
			if($from == ''){
			$this->setLayout('reassignproperty');
			}
			else{
			$this->setLayout('reassignpropertypopup');
			}
		
		}
		//sreenu
		
		
		
		
		
			
      if($user_type == '16')
      {
     
      if($task == 'proaddproperty')
		//For board members
	   {
	   $model = $this->getModel('addproperty');
	 	$bmembers = $model->getbmembers();
		$this->assignRef('bmembers1',$bmembers);
		$einnumner = $model->getcompanyinfo();
		$this->assignRef('einnumner',$einnumner);
		$managers_all = $model->managemanagers();
		$this->assignRef('managers_all',$managers_all);
		$this->setLayout('proaddform');
		}
		else if($task=='editpropertymanager')
		{
		$db = Jfactory::getDBO();
		$pid = JRequest::getVar("pid",'');
		$model  = $this->getModel('addproperty');
		$property = $model->propertyowner_property($pid);
		$this->assignRef('property',$property);
		$details = & $this->get( 'Pdetails' );
		$this->assignRef('details',	$details);
		$propertyownerinfo = $model->propertyownerinfo();
		$this->assignRef('propertyownerinfo',$propertyownerinfo);
		$states = $model->getStates();
		 $this->assignRef('states',	$states);
		 $county = $model->county1( $pid );
         $this->assignRef('county',	$county);
		$this->setLayout('editpropertymanager');
			}
			
	else if($task=='editpropertyowner')
		{
		
		 $db = Jfactory::getDBO();
		 $pid = JRequest::getVar("pid",'');
		 $model  = $this->getModel('addproperty');
		 $manager_propertydetails = $model->manager_propertydetails($pid);
		 $this->assignRef('propertydetails', $manager_propertydetails);
		 $property_per = $model->property_per($pid);
		 $this->assignRef('property_per', $property_per);
		 $managerinfo = $model->linkedpropertymanager_info($pid);
		 $states = $model->getStates();
		 $this->assignRef('states',	$states);
		 $county = $model->county1( $pid );
         $this->assignRef('county',	$county);
		 $this->assignRef('managerinfo', $managerinfo);
		 $this->setLayout('editpropertyowner');
			}
			
		else if($task=='uploadpropertypic')
		{
		$this->setLayout('logouploadbox');
		parent::display($tpl);
			}
	   else if($task=='editpropertypic')
		{
		$this->setLayout('editpropertypic');
		parent::display($tpl);
		}
		
		else if($task=='addpropertypic')
		{
		$this->setLayout('addpropertypic');
		parent::display($tpl);
		}
		
			
	 else  if($task=='sendmangerinvitation')
		{
		
		 $db = Jfactory::getDBO();
		 $pid = JRequest::getVar("pid",'');
		 $pname = JRequest::getVar("pnmae",'');
		 $model  =$this->getModel('addproperty');
	     $get_propertydetails = $model->get_propertydetails($pid);
	     $get_propertyownerinfo = $model->get_propertyownerinfo($pid);
		 $this->assignRef('propertyinfo', $get_propertydetails);
		 $this->assignRef('propertyowner_info', $get_propertyownerinfo);
			$this->setLayout('sendmangerinvitation');
			}	
 
     else
     $this->setLayout('newproperty');
   }			
			parent::display($tpl);
			//singnup process 2
		}
}
?>
