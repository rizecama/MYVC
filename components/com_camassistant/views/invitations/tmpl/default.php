<?php
/**
 * @version		1.0.0 cam assistant $
 * @package		cam_assistant
 * @copyright	Copyright © 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');
JHTML::_('behavior.modal');
	?>
	<style type="text/css">
.generaloptions  li {
  list-style-type: none;
  margin-top:7px;
  }
 .pre_general li {
  list-style-type: none;
  margin-top:7px;
  }
  .pre_auto li {
  list-style-type: none;
  margin-top:7px;
  }
  .pre_workers li {
  list-style-type: none;
  margin-top:7px;
  }
  .pre_umbrella li {
  list-style-type: none;
  margin-top:7px;
  }
  .pre_general {
  width: 100%;
  list-style-type:none;
  margin:0px;
}
 .pre_auto {
  width: 100%;
  list-style-type:none;
  margin:0px;  
}
 .pre_workers {
  width: 100%;
  list-style-type:none;
  margin:0px;  
}
 .pre_umbrella {
  width: 100%;
  list-style-type:none;
  margin:0px;  
}
 .pre_lic {
  width: 100%;
  list-style-type:none;
  margin:0px;  
}

</style>
<style type="text/css">
.checkbox {
	width: 19px;
	height: 18px;
	padding: 3px 1px 0 0;
	background: url(checkbox.png) no-repeat;
	display: block;
	clear: left;
	float: left;
}
/*.radio {
	background: url(radio.png) no-repeat;
}*/
.select {
	position: absolute;
	width: 158px; /* With the padding included, the width is 190 pixels: the actual width of the image. */
	height: 21px;
	padding: 0 24px 0 8px;
	color: #fff;
	font: 12px/21px arial,sans-serif;
	background: url(select.png) no-repeat;
	overflow: hidden;
}

</style>
<script type="text/javascript" src="components/com_camassistant/skin/js/jquery-1.4.4.min.js"></script>
<script type="text/javascript">
var checkboxHeight = "25";
var radioHeight = "25";
var selectWidth = "190";

document.write('<style type="text/css">input.styled { display: none; } select.styled { position: relative; width: ' + selectWidth + 'px; opacity: 0; filter: alpha(opacity=0); z-index: 5; } .disabled { opacity: 0.5; filter: alpha(opacity=50); }</style>');

var Custom = {
	init: function() {
		var inputs = document.getElementsByTagName("input"), span = Array(), textnode, option, active;
		for(a = 0; a < inputs.length; a++) {
			if((inputs[a].type == "checkbox" || inputs[a].type == "radio") && inputs[a].className.indexOf("styled") > -1) {
				span[a] = document.createElement("span");
				span[a].className = inputs[a].type;

				if(inputs[a].checked == true) {
					if(inputs[a].type == "checkbox") {
						position = "0 -" + (checkboxHeight*2) + "px";
						span[a].style.backgroundPosition = position;
					} else {
						position = "0 -" + (radioHeight*2) + "px";
						span[a].style.backgroundPosition = position;
					}
				}
				inputs[a].parentNode.insertBefore(span[a], inputs[a]);
				inputs[a].onchange = Custom.clear;
				if(!inputs[a].getAttribute("disabled")) {
					span[a].onmousedown = Custom.pushed;
					span[a].onmouseup = Custom.check;
				} else {
					span[a].className = span[a].className += " disabled";
				}
			}
		}
		inputs = document.getElementsByTagName("select");
		for(a = 0; a < inputs.length; a++) {
			if(inputs[a].className.indexOf("styled") > -1) {
				option = inputs[a].getElementsByTagName("option");
				active = option[0].childNodes[0].nodeValue;
				textnode = document.createTextNode(active);
				for(b = 0; b < option.length; b++) {
					if(option[b].selected == true) {
						textnode = document.createTextNode(option[b].childNodes[0].nodeValue);
					}
				}
				span[a] = document.createElement("span");
				span[a].className = "select";
				span[a].id = "select" + inputs[a].name;
				span[a].appendChild(textnode);
				inputs[a].parentNode.insertBefore(span[a], inputs[a]);
				if(!inputs[a].getAttribute("disabled")) {
					inputs[a].onchange = Custom.choose;
				} else {
					inputs[a].previousSibling.className = inputs[a].previousSibling.className += " disabled";
				}
			}
		}
		document.onmouseup = Custom.clear;
	},
	pushed: function() {
		element = this.nextSibling;
		if(element.checked == true && element.type == "checkbox") {
			this.style.backgroundPosition = "0 -" + checkboxHeight*3 + "px";
		} else if(element.checked == true && element.type == "radio") {
			this.style.backgroundPosition = "0 -" + radioHeight*3 + "px";
		} else if(element.checked != true && element.type == "checkbox") {
			this.style.backgroundPosition = "0 -" + checkboxHeight + "px";
		} else {
			this.style.backgroundPosition = "0 -" + radioHeight + "px";
		}
	},
	check: function() {
		element = this.nextSibling;
		if(element.checked == true && element.type == "checkbox") {
			this.style.backgroundPosition = "0 0";
			element.checked = false;
		} else {
			if(element.type == "checkbox") {
				this.style.backgroundPosition = "0 -" + checkboxHeight*2 + "px";
			} else {
				this.style.backgroundPosition = "0 -" + radioHeight*2 + "px";
				group = this.nextSibling.name;
				inputs = document.getElementsByTagName("input");
				for(a = 0; a < inputs.length; a++) {
					if(inputs[a].name == group && inputs[a] != this.nextSibling) {
						inputs[a].previousSibling.style.backgroundPosition = "0 0";
					}
				}
			}
			element.checked = true;
		}
	},
	clear: function() {
		inputs = document.getElementsByTagName("input");
		for(var b = 0; b < inputs.length; b++) {
			if(inputs[b].type == "checkbox" && inputs[b].checked == true && inputs[b].className.indexOf("styled") > -1) {
				inputs[b].previousSibling.style.backgroundPosition = "0 -" + checkboxHeight*2 + "px";
			} else if(inputs[b].type == "checkbox" && inputs[b].className.indexOf("styled") > -1) {
				inputs[b].previousSibling.style.backgroundPosition = "0 0";
			} else if(inputs[b].type == "radio" && inputs[b].checked == true && inputs[b].className.indexOf("styled") > -1) {
				inputs[b].previousSibling.style.backgroundPosition = "0 -" + radioHeight*2 + "px";
			} else if(inputs[b].type == "radio" && inputs[b].className.indexOf("styled") > -1) {
				inputs[b].previousSibling.style.backgroundPosition = "0 0";
			}
		}
	},
	choose: function() {
		option = this.getElementsByTagName("option");
		for(d = 0; d < option.length; d++) {
			if(option[d].selected == true) {
				document.getElementById("select" + this.name).childNodes[0].nodeValue = option[d].childNodes[0].nodeValue;
			}
		}
	}
}
window.onload = Custom.init;
</script>
<script type="text/javascript">
G = jQuery.noConflict();
G(document).ready( function(){
	G('.proposal_opener').click(function(){
	managerid=G(this).attr('data');
	if(!G(this).hasClass("active")){
	getproposals(managerid);
	G('.proposal_opener').removeClass('active');
	G(this).addClass('active');
	}else{
	G('#proposaldetails_'+managerid).slideUp('slow').html('');
	G('.table_blue_rowdots_submitted').removeClass('active');
	G(this).removeClass('active');
	
	}
	G('#proposaldetails_'+managerid).removeClass('loader');

});

});

function getproposals(managerid){
G = jQuery.noConflict();
G('#proposaldetails_'+managerid).addClass('loader');
G.post("index2.php?option=com_camassistant&controller=invitations&task=getinsurancestandards", {managerid: ""+managerid+""}, function(data){

if(data) {
G('#proposaldetails_'+managerid).removeClass('loader');
G('.prop_details').slideUp();
G('.table_blue_rowdots_submitted').removeClass('active');
G('#table_blue_rowdots'+managerid).addClass('active');
G('#proposaldetails_'+managerid).html(data).slideDown('slow');
Custom.init();
//G('#getproposals_'+rfpid).hide();
//G('#getproposalshide_'+rfpid).show();
G('#proposaldetails_'+managerid).show();
}
else{
G('#proposaldetails_'+managerid).removeClass('loader');
G('#proposaldetails_'+managerid).html("No proposals for this RFP");
}
		});
}


</script>	
<?php 
$user =& JFactory::getUser(); 
if($user->user_type != 11)
{ ?>
<div align="center" style="color:#0066FF; font-size:15px"> You are not authorized to view this page.</div>
<?php } else { ?>
<div id="bedcrumb" style="display:none">
<ul>
<br/>
<li class="home"><a href="index.php?option=com_camassistant&controller=vendors&task=vendor_dashboard&Itemid=112">Home</a> </li>
<li>Invitations</li>
<!--<li><a href="#">Proposals Under Review</a></li> -->
</ul>
</div>
<p style="height:20px;"></p>
<p>The following Manager-users have set specific, company-wide Vendor compliance standards and have current, managed properties in your service area.  You can proactively agree to any Terms & Conditions and revise your insurance and licensing standards to become compliant with their unique standards.  To see how your current compliance documents match up against a user’s requirements, please click the “+” icon to expand for more details.</p>
<p style="height:16px;"></p>

<div id="i_bar_terms">
<div id="i_bar_txt_terms">
<span> <font style="font-weight:bold; color:#FFF;">TERMS &amp; CONDITIONS </font></span>
</div></div>
<div class="table_pannel">
<div class="table_panneldiv">
<table width="100%" cellspacing="4" cellpadding="0" class="titleheadings">
  <tbody><tr class="table_green_row">
    <td width="270" valign="middle" align="center">COMPANY NAME</td>
	<td width="205" valign="middle" align="center">TERMS & CONDITIONS</td>
    <td width="270" valign="middle" align="center">SIGNATURE STATUS</td>
  </tr>
</tbody></table>
    <table width="99%" cellspacing="0" cellpadding="0" style="margin:0px 4px"><tbody>
	<?PHP for ($i=0; $i<count($this->masterpending); $i++){
		  $pinvitations = $this->masterpending[$i];
		 if( $pinvitations->counties_match == 'yes' ){
  	?>
	<tr id="" class="table_blue_rowdots_submitted">
	<td width="230" valign="middle" align="center"><?PHP echo $pinvitations->comp_name; ?></td>
	<td width="175" valign="middle" align="center"><a href="index.php?option=com_camassistant&controller=invitations&task=gettermspopup&managerid=<?php echo $pinvitations->cust_id; ?>&cname=<?php echo $pinvitations->comp_name; ?>&status=<?php echo $pinvitations->terms; ?>" rel="{handler: 'iframe', size: {x: 650, y: 500}}" class="modal" id="compliant1">Terms & Conditions</a></a></td>
	<td valign="middle" align="center" style="font-weight:bold;">
	<?PHP 
		if( $pinvitations->terms == 'acc' ) 
		$image = "<font color='#008000'>ACCEPTED</fotn>";
		if( $pinvitations->terms == 'dec' ) 
		$image = "<font color='red'>DECLINED</font>";
		if( $pinvitations->terms == 'no' ) 
		$image = 'UNREAD';
	?>
	 <?php echo $image; ?> </td>
	</tr>
	<?PHP } } ?>
	
	<tr class="">
	<td valign="top" align="center"></td>
	<td valign="middle" align="left"></td>
	<td valign="top" align="left"></td>
	<td valign="top" align="left"></td>
	</tr>
</tbody></table>
<div class="clear"></div>
</div>
</div>

<p style="height:40px;"></p>




















<div id="i_bar_insurenace">
<div id="i_bar_txt_terms">
<span> <font style="font-weight:bold; color:#FFF;">COMPLIANCE STATUSES</font></span>
</div></div>
<p>The following Manager Users have set compliance standards for Vendors.  You can check your compliance status by clicking on the green “+” icon. Please keep in mind that most Manager-users set their compliance standards on a per-project basis and will not appear on this list. </p>
<p style="height:16px;"></p>

<div class="table_pannel">
<div class="table_panneldiv">
<table width="100%" cellspacing="4" cellpadding="0" class="titleheadings">
  <tbody><tr class="table_green_row">
  	<td width="15" valign="middle" align="center"></td>
    <td width="270" valign="middle" align="center">COMPANY NAME</td>
	<td width="190" valign="middle" align="center"><span style="margin-left:20px;">MANAGER NAME</span></td>
    <td width="270" valign="middle" align="right"><span style="margin-right:20px;">COMPLIANCE STATUS</span></td>
  </tr>
</tbody></table>
    <table width="99%" cellspacing="0" cellpadding="0" style="margin:0px 4px"><tbody>
	<?PHP for ($i=0; $i<count($this->pending); $i++){
		  $pinvitations = $this->pending[$i];
		  if($pinvitations->permission != 'yes'){
		  	if( $pinvitations->counties_match == 'yes' ){	
  	?>
	<tr id="table_blue_rowdots806328" class="table_blue_rowdots_submitted">
	<td width="15" valign="middle" align="center">
	<a href="javascript:void(0);" data="<?php echo $pinvitations->userid; ?>" class="proposal_opener" id="getproposals_<?php echo $pinvitations->userid; ?>"></a>
	</td>
	<td width="230" valign="middle" align="center"><?PHP echo $pinvitations->comp_name; ?></td>
	<td width="160" valign="middle" align="center"><?PHP echo $pinvitations->name.' '.$pinvitations->lastname; ; ?></td>
	<td valign="middle" align="center">
	<?PHP 
		if( $pinvitations->final_status == 'fail' ) 
		$image = "<img src='templates/camassistant_left/images/close-icon_vendor.png'/>";
		if( $pinvitations->final_status == 'success' ) 
		$image = "<img src='templates/camassistant_left/images/right-icon_vendor.png'/>";
		if( $pinvitations->final_status == 'no' ) 
		$image = 'N/A';
	?>
	 <span style="margin-left:45px;"><?php echo $image; ?></span> </td>
	</tr>
	<tr><td colspan="4"><div class="prop_details" style="background:none repeat scroll 0 0 #F0F0F0;" id="proposaldetails_<?php echo $pinvitations->userid; ?>"></div></td></tr>
	<?PHP  } } } ?>
	
	<tr class="">
	<td valign="top" align="center"></td>
	<td valign="middle" align="left"></td>
	<td valign="top" align="left"></td>
	<td valign="top" align="left"></td>
	</tr>
</tbody></table>
<div class="clear"></div>
</div>
</div>
<?php } ?>
