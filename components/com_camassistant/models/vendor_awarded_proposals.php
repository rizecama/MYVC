<?php
/**
 * @version		1.0.0 camassistant $
 * @package		camassistant
 * @copyright	Copyright Â© 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */
// no direct access
	defined('_JEXEC') or die('Restricted access');
	require_once('libraries/tcpdf/config/lang/eng.php');
	require_once('libraries/tcpdf/tcpdf.php');
	ini_set('zlib.output_compression','Off');
	$COM = $this->COM_docs_summary;
	//echo "<pre>"; print_r($COM); exit;
	
	
	class MYPDF extends TCPDF {
	
	// Page footer
	public function Footer() {
		// Position at 1.5 cm from bottom
		$this->SetY(-15);
		// Page number
		$this->SetFontSize(8);
		$this->Cell(207, 0, 'Proposal Report Page '.$this->getAliasNumPage().' of '.$this->getAliasNbPages(), 0, 2, 'C');
		$this->SetFontSize(7);
		$this->Cell(0, 5, 'Copyright 2012 CAMassistant.com', 0, 0, 'C');
	}
	
	public function Header() {
		// Position at 1.5 cm from top
		$this->SetY(-15);
	}
}
	$pdf = new MYPDF(PDF_PAGE_ORIENTATION, PDF_UNIT, PDF_PAGE_FORMAT, true, 'UTF-8', false);
	$pdf->SetCreator(PDF_CREATOR);
	// set default header data
	$pdf->SetHeaderData(PDF_HEADER_LOGO, PDF_HEADER_LOGO_WIDTH, PDF_HEADER_TITLE, PDF_HEADER_STRING);
	
	// set header and footer fonts
	$pdf->setHeaderFont(Array(PDF_FONT_NAME_MAIN, '', PDF_FONT_SIZE_MAIN));
	$pdf->setFooterFont(Array(PDF_FONT_NAME_DATA, '', PDF_FONT_SIZE_DATA));
	
	// set default monospaced font
	$pdf->SetDefaultMonospacedFont(PDF_FONT_MONOSPACED);
	
	//set margins
	$pdf->SetMargins(PDF_MARGIN_LEFT, PDF_MARGIN_TOP, PDF_MARGIN_RIGHT);
	$pdf->SetHeaderMargin(PDF_MARGIN_HEADER);
	$pdf->SetFooterMargin(PDF_MARGIN_FOOTER);
	//set auto page breaks
	$pdf->SetAutoPageBreak(TRUE, PDF_MARGIN_BOTTOM);
	//$pdf->SetDrawColor(204, 204, 204);
	//set image scale factor
	$pdf->setImageScale(PDF_IMAGE_SCALE_RATIO); 
	//set some language-dependent strings
	$pdf->setLanguageArray($l); 
	
	$pdf->SetFont('dejavusans', '', 10);// set font
	$pdf->AddPage(); // add a page
	// Your custom code here
	JHTML::_('behavior.modal');
	$from = JRequest::getVar('from','');
	$document =& JFactory::getDocument();
	$document->addStyleSheet('templates/camassistant_left/css/style.css');
	$RFP_info = $this->RFPinfo;
	$RFP_info->id = sprintf('%06d', $RFP_info->id);
	//echo '<pre>'; print_r($RFP_info); exit;	
	$BID_info = $this->BIDinfo;
	$BID_Vendors_info = $this->BiddedVendorsInfo;
	//echo '<pre>'; print_r($BID_Vendors_info); exit;

	//calculation to no of pages iteration in pdf
	$remainder = count($BID_Vendors_info)%4;
	$quotient = intval(count($BID_Vendors_info)/4);
	$total = count($BID_Vendors_info);
	
	if($remainder == 0)
	$loop_iterator = $quotient;
	else
	$loop_iterator = $quotient+1;
	
	//code to max, min bid values of propsal
	$Max_bid = number_format($BID_info->Max_Bid, 2, '.', ',');
	$Min_bid = number_format($BID_info->Min_Bid, 2, '.', ',');
	$Avg_bid = number_format($BID_info->Average_Bid, 2, '.', ',');
	$com_phone = explode('-',$RFP_info->comp_phno) ;
	
	// create new PDF document
	$pdf = new MYPDF(PDF_PAGE_ORIENTATION, PDF_UNIT, PDF_PAGE_FORMAT, true, 'UTF-8', false);
	// set font
	$pdf->SetFont('dejavusans', '', 12);
	//Image Quality
	$pdf->setJPEGQuality(200);
	// add a page
	$pdf->AddPage();
	$pat = JPATH_SITE.DS.'components'.DS.'com_camassistant'.DS.'assets'.DS.'images'.DS;
	$x = 15;
	$y = 35;
	$w = 30;
	$h = 30;
	//$tem = JPATH_SITE.DS.'templates'.DS.'camassistant_left'.DS.'images'.DS;
	//$pdf->Image($tem."mc_headicons.jpg", 186, 10, 20, 4, '', '', '', true, 150);
	//$pdf->Image(imagepath, x, y, width, height, 'type', 'link', 'align', resize=true, dpi=150);
	//echo '<pre>'; print_r($RFP_info); exit;
	
	
	$db = JFactory::getDBO();
	$state="SELECT state_name FROM #__state where id='".$RFP_info->comp_state."'";
	$db->Setquery($state);
	$state_name = $db->loadResult();
	
	$ind_solicited ="SELECT industry_name FROM #__cam_industries where id='".$RFP_info->industry_id."'";
	$db->Setquery($ind_solicited);
	$ind_solicited = $db->loadResult();

	$altproposals_submitted="SELECT count(*) FROM #__cam_vendor_proposals where rfpno='".$RFP_info->id."' AND proposaltype='submit' AND Alt_bid='yes'";
	$db->Setquery($altproposals_submitted);
	$altproposals_submitted = $db->loadResult();
	
	$RFP_info->work_perform = explode(',',$RFP_info->work_perform,2) ;
	$RFP_info->work_perform = $RFP_info->work_perform[0].'<br />'.$RFP_info->work_perform[1];
	//echo '<pre>'; print_r($RFP_info->work_perform); exit;
	
	
   if(count($BID_Vendors_info)>0)
	{
	
	/********************************************************** code to display vendor info htmlcontent ***************************************************/
	
	for($loop_start=0, $loop_stop=1; $loop_start<$loop_iterator; $loop_start++,$loop_stop++)
    {
		if($RFP_info->comp_logopath == ''){
		
				//Start -- if manager logo is empty then disply mgntfirm logo by anil_17-08-2011
				if($RFP_info->comp_id != '0'){
 				$db = JFactory::getDBO();
				$compid_sql = "SELECT comp_id FROM #__cam_customer_companyinfo where cust_id=".$RFP_info->cust_id;
				$db->Setquery($compid_sql);
				$compid = $db->loadResult(); 
				$custid_sql = "SELECT cust_id FROM #__cam_camfirminfo where id=".$compid;
				$db->Setquery($custid_sql);
				$custid = $db->loadResult(); 
				$logopath_sql = "SELECT comp_logopath FROM #__cam_customer_companyinfo where cust_id=".$custid;
				$db->Setquery($logopath_sql);
				$RFP_info->comp_logopath = $db->loadResult();
				}
				if($RFP_info->comp_logopath == ''){
				$RFP_info->comp_logopath = 'noimage2.gif';
				}
				//End -- if manager logo is empty then disply mgntfirm logo by anil_17-08-2011
				
		}
		$db = JFactory::getDBO();
		$namef = "SELECT name,lastname FROM #__users where id=".$RFP_info->cust_id;
		$db->Setquery($namef);
		$namelast = $db->loadObjectlist(); 
		$fullname=$namelast[0]->name.' '.$namelast[0]->lastname;
		// Start checking whether the file exists in the path or not anil_16-08-2011
		$filename = $pat.'properymanager/'.$RFP_info->comp_logopath;
		/* anil_27-08-2011 */
		$apath=getimagesize($filename);
		$height_orig=$apath[1];
		$width_orig=$apath[0];
		$aspect_ratio = (float) $height_orig / $width_orig;
		
		if($width_orig <= $height_orig ){
		if($width_orig <= '31'){
		$aspect_ratio = (float) $height_orig / $width_orig;
		$width = $width_orig;
		$height = $height = round($width * $aspect_ratio);
		$height_user = $height;
		} 
		else {
				$aspect_ratio = (float) $width_orig / $height_orig;
				$height = 18;
				$width = round($height * $aspect_ratio);
				$height_user = $height;
				}
		}
		else if($height_orig <= $width_orig ){
		if( height_orig <= '18'){
		$aspect_ratio = (float) $width_orig / $height_orig;
		$width = round($height * $aspect_ratio);
		$height = $height_orig;
		$height_user = $height_orig;
		} 
		else {
				//echo "anil"; exit;
				$aspect_ratio = (float) $height_orig / $width_orig;
				$width = 31;
				$height = round($width * $aspect_ratio);
				$height_user = $height;
				} 
		}
		//$width2 = $width*3;
		/* anil_27-08-2011 */		
if (!file_exists($filename)) {
   $RFP_info->comp_logopath = 'noimage2.gif';
   } // End checking whether the file exists in the path or not anil_16-08-2011
		$htmlcontent = '<table width="550px" border="0" cellspacing="0" cellpadding="0" align="center" style="padding-top:40px">';
						$pdf->Image('https://camassistant.com/live/components/com_camassistant/assets/images/properymanager/'.$RFP_info->comp_logopath, 10, 10, $width, $height, "", "", "", true, 550,'', false, false, 0, false, false, false);
		$htmlcontent .= '<tr><td width="235px" height="50" align="left" ></td>
							<td width="315px" align="right" style="text-align: right; font-size:21px;"><img width="50" height="14" src="templates/camassistant_left/images/mc_headicons.jpg" /><br/><strong><br/>'.$RFP_info->comp_name.'</strong><br />
		'.$RFP_info->mailaddress.'<br />'.$RFP_info->comp_city.',  '.$state_name.' '.$RFP_info->comp_zip.'<br /><strong>P</strong>: ('.$com_phone[0].')&nbsp;'.$com_phone[1].'-'.$com_phone[2].'</td></tr>
		
						<tr style="font-size:21px;">
							<td colspan="2" width="275px" align="left"><strong><br /><br /><br />PROPOSAL REPORT FOR:</strong><br />
							'.str_replace('_',' ',$RFP_info->property_name).'<br />'
							.$RFP_info->street.'<br />'
							.substr($RFP_info->city, 0, -1).',&nbsp;'.strtoupper($RFP_info->state).'  '.$RFP_info->zip.'</td>
						 </tr>
						<tr><td>&nbsp;</td></tr>
						<tr style="font-size:21px;">';
						
						$htmlcontent .='<td width="340px" align="left" style="width:500px; float:left;"><hr width="340px" /><strong><br />Summary Details For RFP No.'.$RFP_info->id.':</strong><br />Reference Name: '.$RFP_info->projectName.'<br />Industry Solicited: '.$ind_solicited.'<br/>RFP Close Date & Time: '.$RFP_info->proposalDueDate.'   '.$RFP_info->proposalDueTime.'<br />Location where work is to be performed: '.$RFP_info->work_perform.'<br />Projected Contract Term: '.$RFP_info->frequency.'</td>
							<td style="width:300px; font-size:21px; text-align:left;"><hr width="210px" /><strong><br />Proposal Overview Details:</strong><br />Proposals Submitted:  <strong>'.$BID_info->Submitted.'</strong><br />Alt.Proposals Submitted:  <strong>'.$altproposals_submitted.'</strong><br />High Bid: <strong>$'.$Max_bid.'</strong><br />Low Bid: <strong>$'.$Min_bid.'</strong><br />Average Bid: <strong>$'.$Avg_bid.'</strong><br />
							</td>
						</tr>
						<tr style="height:5px;"><td align="left" colspan="2" style="font-size:5px;"><hr width="550px" /><br /></td></tr>
						';
		/***eof table pan****/
		
		/**** sof table pan****/
			$htmlcontent .= '<tr valign="middle"><td colspan="2"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr>';
							  $cnt=count($BID_Vendors_info);
							  if($cnt>0)
							  {
							  for($v=(4*$loop_start); $v<(4*$loop_stop); $v++) {
							  if($v<$total){
							  $full = $total-$remainder;
							  if( $v < $full){
			$htmlcontent .=  '<td width="22%" align="left" valign="middle">';
								} else if($remainder == 1){
			$htmlcontent .=  '<td width="22%" align="left" valign="middle">';								
								}
								else if($remainder == 2){
			$htmlcontent .=  '<td width="22%" align="left" valign="middle">';								
								}
								else if($remainder == 3){
			$htmlcontent .=  '<td width="22%" align="left" valign="middle">';								
								}
								else if($remainder == 0){
			$htmlcontent .=  '<td width="100%" align="left" valign="middle">';								
								}
			$htmlcontent .=   '<table width="100%" border="1" cellspacing="0" cellpadding="3">';
							  if($v%2 == 0)
							  $class = "#21314d";  
							  else 
							  $class = "#7ab800";
							  $vid = $v+1;
	
							  if($BID_Vendors_info[$v]->company_name == '')
							  $BID_Vendors_info[$v]->company_name = '---';
			$htmlcontent .= '<tr align="center"><td bgcolor="'.$class.'" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px; height:15px;">VENDOR '.$vid.'</td></tr>';
			//if($BID_Vendors_info[$v]->image != '') $image = $BID_Vendors_info[$v]->image; else $image = 'noimage1.gif'; 
			
					// Start checking whether the file exists in the path or not anil_16-08-2011
							if($BID_Vendors_info[$v]->image != ''){ 
								$vendor_image = $pat.'vendors/pdf_resized/'.$BID_Vendors_info[$v]->image;
								if (!file_exists($vendor_image)) { 
									$image = 'noimage1.gif'; 
									} else 
									$image = $BID_Vendors_info[$v]->image; 
							 } else { $image = 'noimage1.gif'; }
					// End checking whether the file exists in the path or not anil_16-08-2011
	$BID_Vendors_info[$v]->company_phone = explode('-',$BID_Vendors_info[$v]->company_phone) ;
	$BID_Vendors_info[$v]->company_phone = '('.$BID_Vendors_info[$v]->company_phone[0].') '.$BID_Vendors_info[$v]->company_phone[1].'-'.$BID_Vendors_info[$v]->company_phone[2];
	$altphone = "Alt.Phone: ";
	$altphoneext = "Alt.Extension: ";
	$BID_Vendors_info[$v]->alt_phone = explode('-',$BID_Vendors_info[$v]->alt_phone) ;
	$BID_Vendors_info[$v]->alt_phone = '('.$BID_Vendors_info[$v]->alt_phone[0].') '.$BID_Vendors_info[$v]->alt_phone[1].'-'.$BID_Vendors_info[$v]->alt_phone[2];
	$cellphone = "Mobile Phone: ";
	$BID_Vendors_info[$v]->cellphone = explode('-',$BID_Vendors_info[$v]->cellphone) ;
	$BID_Vendors_info[$v]->cellphone = $cellphone.'('.$BID_Vendors_info[$v]->cellphone[0].') '.$BID_Vendors_info[$v]->cellphone[1].'-'.$BID_Vendors_info[$v]->cellphone[2];
	/*$phone ='Phone: ';
	$BID_Vendors_info[$v]->phone = explode('-',$BID_Vendors_info[$v]->phone) ;
	$BID_Vendors_info[$v]->phone = $phone.'('.$BID_Vendors_info[$v]->phone[0].') '.$BID_Vendors_info[$v]->phone[1].'-'.$BID_Vendors_info[$v]->phone[2];*/
	//print_r($BID_Vendors_info[$v]->proposal_total_price); exit;
	$BID_Vendors_info[$v]->proposal_total_price = number_format( $BID_Vendors_info[$v]->proposal_total_price , 2 , '.' ,',' );
	$db = JFactory::getDBO();
	$vstate="SELECT state_name FROM #__state where id='".$BID_Vendors_info[$v]->state."'";
	$db->Setquery($vstate);
	$vstate = $db->loadResult();
	//echo '<pre>'; print_r($vstate); exit; 
	//echo '<pre>'; print_r($BID_Vendors_info[$v]); exit;
	//echo "<pre>"; print_r($BID_Vendors_info[$v]->company_phone); exit;
	//echo $image; exit;
		$rateimage= 'https://camassistant.com/live'.DS.'components'.DS.'com_camassistant'.DS.'assets'.DS.'images'.DS.'rating'.DS;
			$db = JFactory::getDBO();
			$rating = "SELECT rating_sum FROM #__content_rating where content_id =".$BID_Vendors_info[$v]->proposedvendorid;
			$db->Setquery($rating);
			$rating = $db->loadResult();
			if ($rating > 0 && $rating <= 0.50)
			{ $rate_image = $rateimage.'5.png'; }
			elseif ($rating > 0.50 && $rating <= 1.00)
			{ $rate_image = $rateimage.'10.png'; }
			elseif ($rating > 1.00 && $rating <= 1.50)
			{ $rate_image = $rateimage.'15.png'; }
			elseif ($rating > 1.50 && $rating <= 2.00)
			{ $rate_image = $rateimage.'20.png'; }
			elseif ($rating > 2.00 && $rating <= 2.50)
			{ $rate_image = $rateimage.'25.png'; }
			elseif ($rating > 2.50 && $rating <= 3.00)
			{ $rate_image = $rateimage.'30.png'; }
			elseif ($rating > 3.00 && $rating <= 3.50)
			{ $rate_image = $rateimage.'35.png'; } 
			elseif ($rating > 3.50 && $rating <= 4.00)
			{ $rate_image = $rateimage.'40.png'; }
			elseif ($rating > 4.00 && $rating <= 4.50)
			{ $rate_image = $rateimage.'45.png'; }
			elseif ($rating > 4.50 && $rating <= 5.00)
			{ $rate_image = $rateimage.'50.png'; }
			else 
			{ $rate_image = $rateimage.'40.png'; }
			//print_r($rate_image); exit;
			$htmlcontent .= '<tr><td align="center"><img src="components/com_camassistant/assets/images/vendors/pdf_resized/'.$image.'"  />  </td></tr>';
			$htmlcontent .= '<tr valign="baseline"><td height="30" align="center" style="font-size:19px ; text-align: center; vertical-align:middle">'.$BID_Vendors_info[$v]->company_name.'</td></tr>'; 
			/*  '.$rating=plgVotitaly($BID_Vendors_info[$v]->proposedvendorid,$limitstart).' */
			/* <img src="templates/camassistant_left/images/rating.gif" width="75" height="15" /> */
			$htmlcontent .= '<tr><td border="0" style="font-size:19px ;text-align: center;">
			Vendor Apple Rating:<br>
			<img src="'.$rate_image.'" /></td></tr>
							<tr><td height="15" style="font-size:19px ; text-align: center; ">'.$BID_Vendors_info[$v]->company_address.',<br />'.$BID_Vendors_info[$v]->city.',<br />'.$vstate.' '.$BID_Vendors_info[$v]->zipcode.'</td>  </tr>
							<tr><td height="15" style="font-size:19px ; text-align: center; ">In-House Vendor? <strong>'. $BID_Vendors_info[$v]->in_house_vendor.'</strong></td></tr>
							
							<tr><td height="15" style="font-size:19px ; text-align: center; ">Company Phone: '. $BID_Vendors_info[$v]->company_phone.'</td>  </tr>';
							 if($BID_Vendors_info[$v]->phone_ext != '') $phone_ext = 'Extension: '.$BID_Vendors_info[$v]->phone_ext; else $phone_ext = 'Extension: N/A'; 
			 $htmlcontent .= '<tr><td height="15" style="font-size:19px ; text-align: center; ">'.$phone_ext.'</td></tr>';
							if($BID_Vendors_info[$v]->alt_phone != '') $alt_ext = $altphone.$BID_Vendors_info[$v]->alt_phone; else $alt_ext = 'Alt.Phone: N/A';
			 $htmlcontent .= '<tr><td height="15" style="font-size:19px ; text-align: center; ">'.$alt_ext.'</td></tr>';
							 if($BID_Vendors_info[$v]->alt_phone_ext != '') $alt_phone_ext = $altphoneext.$BID_Vendors_info[$v]->alt_phone_ext; else $alt_phone_ext = 'Alt.Extension: N/A';
			 $htmlcontent .= '<tr><td  height="15" style="font-size:19px ; text-align: center; ">'.$alt_phone_ext.'</td></tr>
							 <tr><td height="15" style="font-size:19px ; text-align: center;">Year Business Established: '.$BID_Vendors_info[$v]->established_year.'</td>
		  </tr>
							<tr><td height="30" style="font-size:19px ;text-align: center; ">Contact: '.$BID_Vendors_info[$v]->name.' '.$BID_Vendors_info[$v]->lastname.'</td></tr>
							<tr><td height="15" style="font-size:19px ;text-align: center; ">E-mail: '.$BID_Vendors_info[$v]->email.'</td></tr>';		
							/*if($BID_Vendors_info[$v]->extension != '') $extension = 'Extension: '.$BID_Vendors_info[$v]->extension; else $extension = 'Extension: N/A';
			  $htmlcontent .= '<tr><td height="15" style="font-size:19px ;text-align: center; ">'.$extension.'</td></tr>';*/
							if($BID_Vendors_info[$v]->cellphone != '') $cellphone = $BID_Vendors_info[$v]->cellphone; else $cellphone = 'Mobile Phone: N/A';
			 $htmlcontent .= '<tr><td height="15" style="font-size:19px ;text-align: center; ">'.$cellphone.'</td></tr>';
							if($v%2 == 0) $class = "#7ab800";  else $class = "#21314d";
		   $htmlcontent .= '<tr><td height="15" bgcolor="'.$class.'" style="color:#FFF; font-size:21px; font-weight:bold; font-family:ArialBlack; text-align: center; ">TOTAL AMOUNT PROPOSED</td></tr>';
							/*if($v%2 == 0) */
							$class = "color:#21314d; font-size:21px; font-weight:bold; font-family:ArialBlack; text-align: center; ";
							/*else $class = "color:#7ab800; font-size:21px; font-weight:bold;  font-family:ArialBlack;text-align:center";*/
							$addexp="SELECT count(*) FROM #__cam_rfpsow_addexception where rfp_id='".$RFP_info->id."' AND vendor_id='".$BID_Vendors_info[$v]->proposedvendorid."' ";
							$db->Setquery($addexp);
							$addexp = $db->loadResult();
							//echo '<pre>'; print_r($addexp); exit;
			$EXCEPTION_summary = $this->EXCEPTION_summary;
						$cnt_excep=count($EXCEPTION_summary);  
								 for($star=0; $star<$cnt_excep; $star++)
								 {
									 $cnt_Excep = count($EXCEPTION_summary[$star]->task_exception); 
									 for($star1=0; $star1<$cnt_Excep; $star1++)
									 {
									    if($EXCEPTION_summary[$star]->task_exception[$star1]->vendor_id == $BID_Vendors_info[$v]->proposedvendorid  )
										{
										//echo $EXCEPTION_summary[$star]->task_exception[$star1]->add_exception;
										  if($EXCEPTION_summary[$star]->task_exception[$star1]->add_exception != '')
									      {
										  $as[] = 'yes';
										  }
										  else
										  {
										  $as[] = '';	
										  }
										   
									  }
									 } 
								 
								} 
								if(in_array('yes',$as)){
								$ast = '<font color="red">* </font>';
								}
							
							if ($addexp >'0'){
							$BID_Vendors_info[$v]->proposal_total_price = $BID_Vendors_info[$v]->proposal_total_price.'<font style="color:#FF0000;"> '.$ast.'</font>';
							}
		  $htmlcontent .= '<tr><td height="15" style="'.$class.'">$'.$BID_Vendors_info[$v]->proposal_total_price.'</td></tr>
						<tr><td height="15" style="font-size:19px ;text-align: center;">Alternate Proposal Provided?</td></tr>';
							$db = JFactory::getDBO();
							$sql = "SELECT proposal_total_price FROM #__cam_vendor_proposals where Alt_bid = 'yes' AND rfpno = ".sprintf('%d', $RFP_info->id)." AND proposedvendorid 	=".$BID_Vendors_info[$v]->proposedvendorid;
							$db->Setquery($sql);
							$Alt_Price = $db->loadResult();  
							if($Alt_Price != '') 
							{$res = 'Yes'; } else $res = 'No';
			$htmlcontent .=  '<tr><td height="15" style="font-size:19px ;text-align: center; color:#464646; font-weight:bold;  font-family:ArialBlack;">'.$res.'</td></tr>';
			if($Alt_Price != '')
			$Alt_Price = number_format( $Alt_Price ,2,'.',',' );
			//echo '<pre>'; print_r($Alt_Price); 
			if($Alt_Price != '') $Alt_Price = 'Alt.Price: $'.$Alt_Price; else $Alt_Price = 'Alt.Price: N/A';
			$htmlcontent .= '<tr><td height="15" style="font-size:19px ; text-align: center; color:#464646; font-weight:bold; font-family:ArialBlack;">'.$Alt_Price.'</td>
		  </tr>';				 
			$htmlcontent .= '</table></td>';
								}//inner if loop
							  }//end for loop 
							 }//if loop 
			$htmlcontent .= '</tr></table></td></tr></table>';
			
			$htmlcontent .= '<br /><table><tr><td style="font-size:23px; align:left;"><font color="red">*</font>Designates exception for 1 or more line items. 	Please see vendor notes for details.</td></tr></table>';  
//		echo '<pre>';	print_r($htmlcontent); exit;
			$style = array('color' => array(220, 220, 220));
			$style7 = array('width' => 0.1, 'color' => array(220, 220, 220));
			$pdf->SetLineStyle($style7);
		$pdf->writeHTML($htmlcontent, true, 0, true, 0); 
		// add a page
		//$pdf->AddPage();
		 
		
		if($loop_start < $loop_iterator-1){
		$pdf->AddPage();
		}
		/************************************************************End of 4th Page TASKS SUMMARY*************************************************************/
     }//end - for($loop_start=0, $loop_stop=1; $loop_start<count($BID_Vendors_info); $loop_start++,$loop_stop++)
	/********************************************************** code to display vendor info htmlcontent ***************************************************/ 
	
/***************************************** RFP LINE ITEMS AND VENDOR RESPONSES ****************************************/
		$pdf->AddPage();
		$TASKS_summary = $this->TASKS_summary;
		$DOCS_summary = $this->DOCS_summary;
		$NOTES_summary = $this->NOTES_summary;
		$EXCEPTION_summary = $this->EXCEPTION_summary;
		$RFP_NOTES_summary = $this->RFP_NOTES_summary;
		$vendors_cnt = $this->vendors_cnt;
		//echo "<pre>"; print_r($TASKS_summary); exit;
			$htmlcontent3 = '<table width="550px" border="0" cellspacing="0" cellpadding="3" align="center" style="padding-top:40px">'.
			$pdf->Image($pat.'properymanager/'.$RFP_info->comp_logopath, 10, 10, $width, $height, "", "", "", true, 550,'', false, false, 0, false, false, false); 
			$htmlcontent3 ='<tr><td width="235px" height="50" align="left" ></td>
							<td width="315px" align="right" style="text-align: right; font-size:21px;"><img width="50" height="12" src="templates/camassistant_left/images/mc_headicons.jpg" /><br/><strong><br/>'.$RFP_info->comp_name.'</strong><br />
		'.$RFP_info->mailaddress.'<br />'.$RFP_info->comp_city.', '.$state_name.' '.$RFP_info->comp_zip.'<br /><strong>P</strong>: ('.$com_phone[0].')'.$com_phone[1].'-'.$com_phone[2].'</td>
			</tr>';
		
			$htmlcontent3 .='<tr><td width="100%" colspan="2" height="15" bgcolor="#7ab800" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px ; text-align: center; ">RFP TASKS REQUESTED</td></tr>';
			
			$htmlcontent3 .= '<tr><td width="100%" colspan="2">';
							 $line_cnt=count($RFP_NOTES_summary);
							 if($line_cnt>0)
							 { 
							 for($li=0; $li<$line_cnt; $li++)
							 {
							 $lid = $li+1;
							 if($RFP_NOTES_summary[$li]->title == '')
							 $RFP_NOTES_summary[$li]->title = 'NONE';
			$htmlcontent3 .='<tr><td colspan="2" style="font-size:20px; text-align: left;"><span style="color:#21314d; font-weight:bold;"><br /><br />LINE ITEM #'.$lid.':</span> '.$RFP_NOTES_summary[$li]->task_desc.'<p style="color:#7ab800; font-weight:bold;">Attachment #'.$lid.': '.$RFP_NOTES_summary[$li]->title.'</p></td></tr>';
			
							// for($v=(6*$loop_start); $v<(6*$loop_stop); $v++)
							for($v=0; $v<count($BID_Vendors_info); $v++)
							{
							 $x = 0;
							 if($v%2 == 0)
							 $class = "#7ab800";  
							  else 
							  $class = "#21314d";
							 $vid = $v+1;
			$htmlcontent3 .='<table width="100%" border="0" cellpadding="3" cellspacing="3">';
			$htmlcontent3 .='<tr><td height="15" width="22%"  bgcolor="'.$class.'" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px ; text-align: center; ">VENDOR '.$vid.' NOTES:</td></tr>';
			/******************************************code to display NOTES*******************************************/
							$cnt_tasks=count($NOTES_summary); 
							if($cnt_tasks>0)
							{
							$flag = 0;
							$htmlcontent3 .= '<tr><td border="1" width="100%" height="15" style="font-size:19px ;text-align: left; ">';
								 for($T=0; $T<$cnt_tasks; $T++)
								 {
								   if($RFP_NOTES_summary[$li]->task_id == $NOTES_summary[$T]->task_id)
								   {
									 $cnt_notes = count($NOTES_summary[$T]->task_notes); 
									 //echo "<pre>"; print_r($NOTES_summary[$T]->task_notes); 
									 for($N=0; $N<$cnt_notes; $N++)
									 {
										if($NOTES_summary[$T]->task_notes[$N]->vendor_id == $BID_Vendors_info[$v]->proposedvendorid  )
										{
										  if($NOTES_summary[$T]->task_notes[$N]->add_notes != '')
									      {
										  $htmlcontent3 .= '<b>NOTES :</b><p>'.nl2br($NOTES_summary[$T]->task_notes[$N]->add_notes).'</p>';		
										  }
										  else
										  {
										  $htmlcontent3 .= '<b>NOTES : </b><p>NONE</p>';		
										  }
									    }
									 } 

								 } 
								} 
							}
				/******************************************code to display EXCEPTION *******************************************/
				$cnt_excep=count($EXCEPTION_summary); 
					if($cnt_excep>0)
							{
							$flag = 0;
								 for($E=0; $E<$cnt_excep; $E++)
								 {
								   if($RFP_NOTES_summary[$li]->task_id == $EXCEPTION_summary[$E]->task_id)
								   {
									 $cnt_Excep = count($EXCEPTION_summary[$E]->task_exception); 
									 for($F=0; $F<$cnt_Excep; $F++)
									 {
									    if($EXCEPTION_summary[$E]->task_exception[$F]->vendor_id == $BID_Vendors_info[$v]->proposedvendorid  )
										{
										  if($EXCEPTION_summary[$E]->task_exception[$F]->add_exception != '')
									      {
										  $htmlcontent3 .= '<p style="color:#FF0000"><b>EXCEPTION(S) :</b>&nbsp;<br />'.nl2br($EXCEPTION_summary[$E]->task_exception[$F]->add_exception).'</p>';		
										  }
										  else
										  {
										  $htmlcontent3 .= '<p style="color:#FF0000"><b>EXCEPTION(S) :</b>&nbsp;NONE</p>';		
										  }
									  }
									 } 
								 } 
								} 
							}
				/******************************************code to display vendor uploaded files *******************************************/	
				$cnt_uploades=count($TASKS_summary); 
					if($cnt_uploades>0)
							{
							$flag = 0;
								 for($A=0; $A<$cnt_uploades; $A++)
								 {
								   if($RFP_NOTES_summary[$li]->task_id == $TASKS_summary[$A]->task_id)
								   {
									 $cnt_Attachments = count($TASKS_summary[$A]->vendor_uploads); 
									 for($B=0; $B<$cnt_Attachments; $B++)
									 {
									    if($TASKS_summary[$A]->vendor_uploads[$B]->vendor_id == $BID_Vendors_info[$v]->proposedvendorid  )
										{
										  if($TASKS_summary[$A]->vendor_uploads[$B]->upload_doc != '')
									      {
										  $htmlcontent3 .= '<p><b>ATTACHMENT(S) :</b>&nbsp;<br />'.$TASKS_summary[$A]->vendor_uploads[$B]->title.'</p>';		
										  }
										  else
										  {
										  $htmlcontent3 .= '<p><b>ATTACHMENT(S) :</b>&nbsp;NONE</p>';		
										  }
									  }
									 } 
								 } 
								} 
							}	
				/******************************************code to display vendor line item prices *******************************************/	
				$cnt_prices=count($TASKS_summary); 
					if($cnt_prices>0)
							{
							$flag = 0;
								 for($TP=0; $TP<$cnt_prices; $TP++)
								 {
								   if($RFP_NOTES_summary[$li]->task_id == $TASKS_summary[$TP]->task_id)
								   {
									 $cnt_Task_Prices = count($TASKS_summary[$TP]->task_price); 
									 for($B=0; $B<$cnt_Task_Prices; $B++)
									 {
									    if($TASKS_summary[$TP]->task_price[$B]->vendor_id == $BID_Vendors_info[$v]->proposedvendorid  )
										{
										  if($TASKS_summary[$TP]->task_price[$B]->item_price != '')
									      {
										  $htmlcontent3 .= '<p><b>LINE ITEM PRICE :</b>&nbsp;<br />$ '.$TASKS_summary[$TP]->task_price[$B]->item_price.'</p>';		
										  }
										  else
										  {
										  $htmlcontent3 .= '<p><b>LINE ITEM PRICE :</b>&nbsp;NONE</p>';		
										  }
									  }
									 } 
								 } 
								} 
							}	
											
									
							$htmlcontent3 .='</td></tr>';
							$htmlcontent3 .= '</table>';
							}//end inner for loop 
							}//end main for loop 
							}//if($line_cnt>0)
		    $htmlcontent3 .= '</td></tr>';
			$htmlcontent3 .= '</table>'; 
			
			
		// echo $htmlcontent3; exit;
		$pdf->writeHTML($htmlcontent3, true, 0, true, 0);	
		// add a page
		//$pdf->AddPage();				 
		/**************************************************END RFP LINE ITEMS AND VENDOR RESPONSES*************************************************************/
		$pdf->AddPage();
		// $vendors_cnt = $vendor_ids;
		// $count=count($vendors_cnt);
		 $vendors_cnt = $this->vendors_cnt; 
		
			$htmlcontentotherprice = '<table width="100%" border="0" cellspacing="0" cellpadding="3" align="center" style="padding-top:40px">';
								
			$htmlcontentotherprice .='<tr><td colspan="2" height="15" bgcolor="#21314d" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px ; text-align: center; ">All other items, charges & fees not itemized above</td></tr>';
			//$htmlcontentotherprice .='<tr><td colspan="2"><table border="1" width="100%" cellspacing="0" cellpadding="3"><tr><td style="font-size:19px; text-align: left; ">';	
			
							$htmlcontentotherprice .= '<br/><br/>';
							$count=count($vendors_cnt);
							if($vendors_cnt>0){ 
														
							for($z=0; $z<count($vendors_cnt); $z++) { 
							
							$db =& JFactory::getDBO();
							 $other_price_sql = "SELECT `price_other_items` FROM #__cam_vendor_proposals  where rfpno='".$RFP_info->id."' AND proposedvendorid  ='".$vendors_cnt[$z]->proposedvendorid. "' AND Alt_bid != 'yes' "; 
							$db->setQuery($other_price_sql); 
							$other_price_d = $db->loadResult(); 
							if(!$other_price_d)
							$other_price_d = '0.00';
							else
							$other_price_d = number_format( $other_price_d , 2 , '.' ,',' );
							
					//echo "PRICE".$other_price_d;
							//exit;
							$cnt = $z+1;
							 if($z%2 == 0)
							 $class = "#7ab800";  
							  else 
							  $class = "#21314d";
							  if($z != 0)
							$htmlcontentotherprice .= '<br/>';
							$htmlcontentotherprice .=  '<tr><td bgcolor="'.$class.'" style="color:#ffffff; font-color:#ffffff; font-weight:bold; font-family:ArialBlack; font-size:16px; height:15px; border:1px solid gray; text-align: left;" width="10%">VENDOR '.$cnt.':</td><td width="20%" style="text-align: left;"  style="border:1px solid gray; color:gray; font-size:16px; font-weight:bold;">$ '.$other_price_d.' </td></tr>';
									
							 } 

							}
		//	$htmlcontentotherprice .='</td></tr></table>'; 
		    $htmlcontentotherprice .= '</table>';	
			
//echo 'anand__';
	//echo $htmlcontentotherprice; 		exit;
		$pdf->writeHTML($htmlcontentotherprice, true, 0, true, 0);	
		/*********************************************SPECIAL REQUIREMENTS COMPLIANCE DOCS************************/
		/*$SPL_REQ_DETAILS = $this->SPLRequirements_details;
		$cat = $this->SPLReq_Category;
		$main = $SPL_REQ_DETAILS['main'];
		$sub = $SPL_REQ_DETAILS['sub'];
		$child = $SPL_REQ_DETAILS['child'];
		$price = $SPL_REQ_DETAILS['price'];*/
		//$COM = $this->COM_docs_summary_new;
		$Review_reqCatList = $this->Review_reqCatList;
		$cat = $Review_reqCatList['main'];
		$main = $Review_reqCatList['main'];
		$sub = $Review_reqCatList['sub'];
		$child = $Review_reqCatList['child'];
		$child_price=array();
		
	    error_reporting('E_WARNING)');
		// add a page
		$pdf->AddPage();
			$htmlcontent4 = '<table width="550px" border="0" cellspacing="0" cellpadding="3" align="center" style="padding-top:40px">';
						//$pdf->Image($pat.'properymanager/'.$RFP_info->comp_logopath, 10, 10, "70", "24", "", "", "", true, 100);
			//$htmlcontent4 .= '<tr><td width="205px" height="50" align="left" ></td><td width="345px" style="text-align: left; font-size:21px;"><img width="50" height="12" src="templates/camassistant_left/images/mc_headicons.jpg" /><br/><strong><br/>'.$RFP_info->comp_name.'</strong><br />'.$RFP_info->mailaddress.'<br />'.$RFP_info->comp_city.','.$RFP_info->comp_state.$RFP_info->comp_zip.'<br /><strong>P</strong>: ('.$com_phone[0].')'.$com_phone[1].'-'.$com_phone[2].'</td></tr>';
						
		//$htmlcontent4 .='<tr style="height:5px;"><td align="left" colspan="2" style="font-size:5px;"><hr /><br /></td></tr>';
								
			$htmlcontent4 .='<tr><td colspan="2" height="15" bgcolor="#21314d" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px ; text-align: center; ">SPECIAL REQUIREMENTS -- Vendors meet the following requirements:</td></tr>';
			$htmlcontent4 .='<tr><td colspan="2"><table border="1" width="100%" cellspacing="0" cellpadding="3"><tr><td style="font-size:19px; text-align: left; ">';	
			for($c=0; $c<count($cat); $c++)
							{
								 for($m=0; $m<count($main); $m++)
								 {
									if($cat[$c]->main_id == $main[$m]->main_id)
									{
										$htmlcontent4 .= '<span style="padding-left:0px;font-weight:bold;height:15px;">'.ucwords($main[$m]->main_title).'</span><br/>'; 
										for($s=0; $s<count($sub); $s++)
										{
											if($main[$m]->main_id==$sub[$s]->main_id)
											{
											$htmlcontent4 .= '<span style="padding-left:25px;font-weight:normal;height:15px;">&nbsp;&nbsp;'.ucwords($sub[$s]->sub_title).'</span><br/>';
											if($sub[$s]->sub_id==12)
											$htmlcontent4 .= '<span style="padding-left:25px;font-weight:normal;height:15px;"> &nbsp;&nbsp; Minimum Liability Insurance Amount Required:<b>$'.$sub[$s]->price.'</b></span> <br/>';
												for($ch=0; $ch<count($child); $ch++)
												{
													if($sub[$s]->sub_id==$child[$ch]->sub_id)
													{
													$htmlcontent4 .= '<span style="padding-left:45px;font-weight:normal;height:15px;">&nbsp;&nbsp;'.ucwords($child[$ch]->child_title).'</span>';
													if($child[$ch]->child_id==14)
													{
													$child_price=explode('/',$child[$ch]->price);
													$htmlcontent4 .= '<span style="padding-left:30px;font-weight:normal;height:15px;font-weight:bold"> $'.$child_price[0].'/$'.$child_price[1].'/$'.$child_price[2].'</span><br/>';
													} else {
													$htmlcontent4 .= '<br/>';
													}
													}
												}
											}
											
										}
									}
								  }
 						} //for($c=0; $c<count($cat); $c++)	
							$htmlcontent4 .= '<br/><br/>';
							$count=count($vendors_cnt);
							if($count>0){ for($v=0; $v<$count; $v++) { 
							$cnt = $v+1;
							 if($v%2 == 0)
							 $class = "#7ab800";  
							  else 
							  $class = "#21314d";
							  if($v != 0)
							$htmlcontent4 .= '<p></p>';
							$htmlcontent4 .=  '<table width="11%" cellpadding="3"><tr align="center"><td colspan="2" bgcolor="'.$class.'" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px;">VENDOR '.$cnt.':</td></tr></table>';
							if($v !=0)
							$htmlcontent4 .= '<p style="height:20px;"></p>';
							  					 /*if($COM[$v]['OLN'] != '')
												 $htmlcontent4 .= '<br/>OLN License: '.$COM[$v]['OLN'].'<br/>'; 
												 if($COM[$v]['PLN'] != '')
												 $htmlcontent4 .= 'PLN License: '.$COM[$v]['PLN'].'<br/>'; 
												 if($COM[$v]['GLI'] != '')
												 $htmlcontent4 .= 'GLI Insurance: '.$COM[$v]['GLI'].'<br/>'; 
												 if($COM[$v]['WCI'] != '')
												 $htmlcontent4 .= 'WCI Insurance: '.$COM[$v]['WCI'].'<br/>'; 
												 if($COM[$v]['W9'] != '')
												 $htmlcontent4 .= 'W9: '.$COM[$v]['W9'].'<br/>';  
												 if($COM[$v]['WARRANTY'] != 'nofiles')
												 $htmlcontent4 .= 'WARRANTY-FILE: '.$COM[$v]['WARRANTY'].'<br/>'; 
											     $htmlcontent4 .= 'WARRANTY-TEXT: '.$COM[$v]['WARRANTYTEXT']; */ 
												 if($COM[$v]['OLN'] != '')
												 $htmlcontent4 .= '<br/>Occupational License: '.$COM[$v]['OLN'].'<br/>'; 
												 if($COM[$v]['PLN'] != '')
												 $htmlcontent4 .= 'Professional License: '.$COM[$v]['PLN'].'<br/>'; 
												 if($COM[$v]['GLI'] != '')
												 $htmlcontent4 .= 'General Liability Insurance: '.$COM[$v]['GLI'].'<br/>'; 
												 if($COM[$v]['WCI'] != '')
												 $htmlcontent4 .= 'Workers Comp Insurance: '.$COM[$v]['WCI'].'<br/>'; 
												 if($COM[$v]['W9'] != '')
												 $htmlcontent4 .= 'W-9: '.$COM[$v]['W9'].'<br/>'; 
												 if($COM[$v]['WARRANTY'] != ''){ 
												 $htmlcontent4 .= 'WARRANTY-INFO: '.$COM[$v]['WARRANTY'].'<br/>'; 
												 } else {
												  $htmlcontent4 .= 'WARRANTY-INFO: No Files <br/>'; 
												 }
												 if($COM[$v]['WARRANTYtext'] != ''){
												 $htmlcontent4 .= 'Warranty: '.$COM[$v]['WARRANTYtext']; 
												 } else {
												  $htmlcontent4 .= 'Warranty: No text entered. If no attachment is provided, please contact vendor.'; 
												 }
												 
		$add_notes = 'SELECT add_notes FROM #__cam_rfpsow_addnotes WHERE spl_req="Yes" AND rfp_id = '.$BID_Vendors_info[$v]->rfpno.' AND vendor_id= '.$BID_Vendors_info[$v]->proposedvendorid.' AND Alt_bid!="yes"';
		  $db->Setquery($add_notes);
		  $add_notes1 = $db->loadResult();
		  //echo '<pre>'; print_r( $add_notes1);
		   if($add_notes1 != '')
		 $htmlcontent4 .= '<br /><br />NOTES:'.nl2br($add_notes1); 
		  else
		 $htmlcontent4 .= '<br /><br />NOTES:None'; 
		  $add_exception = 'SELECT add_exception FROM #__cam_rfpsow_addexception WHERE spl_req="Yes" AND rfp_id = '.$BID_Vendors_info[$v]->rfpno.' AND vendor_id= '.$BID_Vendors_info[$v]->proposedvendorid. ' AND Alt_bid!="yes"';
		  $db->Setquery($add_exception);
		  $add_exception1 = $db->loadResult();
		   // echo '<pre>'; print_r( $add_exception1);
		   if($add_exception1 != '')
		 $htmlcontent4 .= '<br /><br /><span style="color:#FF0000">EXCEPTION(S):'.nl2br($add_exception1).'</span>'; 
			 else
		$htmlcontent4 .= '<br /><br /><span style="color:#FF0000">EXCEPTION(S):None</span>'; 					 }
							 }
			$htmlcontent4 .='</td></tr></table>'; 
		    $htmlcontent4 .= '</td></tr></table>';	
		//echo $htmlcontent4; exit;
		$pdf->writeHTML($htmlcontent4, true, 0, true, 0);
	/********************************************END OF CODE SPECIAL REQUIREMENTS COMPLIANCE DOCS************************/
	} //end - if(count($BID_Vendors_info)>0)
	
	
	/******************************************************** CODE TO ALTERNATE PROPOSALS *****************************************************************/
	$BID_Vendors_info = $this->Alt_BiddedVendorsInfo; 
	$remainder = count($BID_Vendors_info)%4;
	$quotient = intval(count($BID_Vendors_info)/4);
	$total = count($BID_Vendors_info);
	if($remainder == 0)
	$loop_iterator = $quotient;
	else
	$loop_iterator = $quotient+1;
	if(count($BID_Vendors_info)>0)
	{
	  // add a page
		$pdf->AddPage();
	/********************************************************** code to display vendor info htmlcontent ***************************************************/
	
	for($loop_start=0, $loop_stop=1; $loop_start<$loop_iterator; $loop_start++,$loop_stop++)
    {
		if($RFP_info->comp_logopath == '')
		$RFP_info->comp_logopath = 'noimage2.gif';
		$htmlcontent = '<table width="550px" border="0" cellspacing="0" cellpadding="3" align="center" style="padding-top:40px">';
						$pdf->Image($pat.'properymanager/'.$RFP_info->comp_logopath, 10, 10, $width, $height, "", "", "", true, 550,'', false, false, 0, false, false, false);
		$htmlcontent .= '<tr><td width="235px" height="70px" align="left" ></td>
							<td width="315px" align="right" style="text-align: right; font-size:21px;"><img width="50" height="12" src="templates/camassistant_left/images/mc_headicons.jpg" /><br/><strong><br/>'.$RFP_info->comp_name.'</strong><br />
		'.$RFP_info->mailaddress.'<br />'.$RFP_info->comp_city.',  '.$state_name.' '.$RFP_info->comp_zip.'<br /><strong>P</strong>: ('.$com_phone[0].')'.$com_phone[1].'-'.$com_phone[2].'</td></tr>
		
						<tr style="font-size:21px; ">
							<td colspan="2" width="275px"  align="left"><strong><br />PROPOSAL REPORT FOR:</strong><br />
							'.str_replace('_',' ',$RFP_info->property_name).'<br />'
							.$RFP_info->street.'<br />'
							.$RFP_info->city.',  '.$RFP_info->state.'  '.$RFP_info->zip.'</td>
						 </tr>
						
						<tr style="font-size:21px;">';
						
						$htmlcontent .='<td width="340px" align="left" style="width:500px; float:left;"><hr width="340px" /><strong><br />Summary Details For RFP No.'.$RFP_info->id.':</strong><br />Reference Name: '.$RFP_info->projectName.'<br />Industry Solicited: '.$ind_solicited.'<br/>RFP Close Date & Time: '.$RFP_info->proposalDueDate.'   '.$RFP_info->proposalDueTime.'<br />Location where work is to be performed: '.$RFP_info->work_perform.'<br />Projected Contract Term: '.$RFP_info->frequency.'							</td>
							<td style="width:300px; font-size:21px; text-align:left;"><hr width="210px" /><strong><br />Proposal Overview Details:</strong><br />Proposals Submitted:  <strong>'.$BID_info->Submitted.'</strong><br />Alt.Proposals Submitted:  <strong>'.$altproposals_submitted.'</strong><br />High Bid: <strong>$'.$Max_bid.'</strong><br />Low Bid: <strong>$'.$Min_bid.'</strong><br />Average Bid: <strong>$'.$Avg_bid.'</strong><br />
							</td>
						</tr>
						<tr style="height:5px;"><td align="left" colspan="2" style="font-size:5px;"><hr width="550px" /><br /></td></tr>
						';
		$htmlcontent .='<tr align="center"><td width="550px" bgcolor="#7ab800" colspan="2" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:22px;  vertical-align:middle; height:19px;">Alternate Proposals - See below for alternate proposals provided by vendors:</td></tr>';				
		/***eof table pan****/
		
		/**** sof table pan****/
			$htmlcontent .= '<tr><td colspan="2"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr>';
							  $cnt=count($BID_Vendors_info);
							  if($cnt>0)
							  {
							  for($v=(4*$loop_start); $v<(4*$loop_stop); $v++) {
							  if($v<$total){
							  $full = $total-$remainder;
							  if( $v < $full){
			$htmlcontent .=  '<td width="25%" align="left" valign="middle">';
								} else if($remainder == 1){
			$htmlcontent .=  '<td width="25%" align="left" valign="middle">';								
								}
								else if($remainder == 2){
			$htmlcontent .=  '<td width="25%" align="left" valign="middle">';								
								}
								else if($remainder == 3){
			$htmlcontent .=  '<td width="25%" align="left" valign="middle">';								
								}
								else if($remainder == 0){
			$htmlcontent .=  '<td width="100%" align="left" valign="middle">';								
								}
			$htmlcontent .=   '<table width="100%" border="1" cellspacing="0" cellpadding="3">';
							  if($v%2 == 0)
							  $class = "#21314d";  
							  else 
							  $class = "#7ab800";
							  $vid = $v+1;
	
							  if($BID_Vendors_info[$v]->company_name == '')
							  $BID_Vendors_info[$v]->company_name = '---';
			$htmlcontent .= '<tr align="center"><td bgcolor="'.$class.'" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px; height:15px;">VENDOR '.$vid.'</td></tr>';
			//if($BID_Vendors_info[$v]->image != '') $image = $BID_Vendors_info[$v]->image; else $image = 'noimage1.gif'; 
			
					// Start checking whether the file exists in the path or not anil_16-08-2011
							if($BID_Vendors_info[$v]->image != ''){ 
								$vendor_image = $pat.'vendors/pdf_resized/'.$BID_Vendors_info[$v]->image;
								if (!file_exists($vendor_image)) { 
									$image = 'noimage1.gif'; 
									} else 
									$image = $BID_Vendors_info[$v]->image; 
							 } else { $image = 'noimage1.gif'; }
					// End checking whether the file exists in the path or not anil_16-08-2011
	$BID_Vendors_info[$v]->company_phone = explode('-',$BID_Vendors_info[$v]->company_phone) ;
	$BID_Vendors_info[$v]->company_phone = '('.$BID_Vendors_info[$v]->company_phone[0].') '.$BID_Vendors_info[$v]->company_phone[1].'-'.$BID_Vendors_info[$v]->company_phone[2];
	$altphone = "Alt.Phone: ";
	$altphoneext = "Alt.Extension: ";
	$BID_Vendors_info[$v]->alt_phone = explode('-',$BID_Vendors_info[$v]->alt_phone) ;
	$BID_Vendors_info[$v]->alt_phone = '('.$BID_Vendors_info[$v]->alt_phone[0].') '.$BID_Vendors_info[$v]->alt_phone[1].'-'.$BID_Vendors_info[$v]->alt_phone[2];
	$cellphone = "Mobile Phone: ";
	$BID_Vendors_info[$v]->cellphone = explode('-',$BID_Vendors_info[$v]->cellphone) ;
	$BID_Vendors_info[$v]->cellphone = $cellphone.'('.$BID_Vendors_info[$v]->cellphone[0].') '.$BID_Vendors_info[$v]->cellphone[1].'-'.$BID_Vendors_info[$v]->cellphone[2];
	/*$phone ='Phone: ';
	$BID_Vendors_info[$v]->phone = explode('-',$BID_Vendors_info[$v]->phone) ;
	$BID_Vendors_info[$v]->phone = $phone.'('.$BID_Vendors_info[$v]->phone[0].') '.$BID_Vendors_info[$v]->phone[1].'-'.$BID_Vendors_info[$v]->phone[2];*/
	$BID_Vendors_info[$v]->proposal_total_price = number_format( $BID_Vendors_info[$v]->proposal_total_price , 2 , '.' ,',' );
	$Alt_Price = number_format( $Alt_Price , 2 , '.' ,',' );
	$db = JFactory::getDBO();
	$vstate="SELECT state_name FROM #__state where id='".$BID_Vendors_info[$v]->state."'";
	$db->Setquery($vstate);
	$vstate = $db->loadResult();
	//echo '<pre>'; print_r($vstate); exit; 
	//echo '<pre>'; print_r($BID_Vendors_info[$v]); exit;
	//echo "<pre>"; print_r($BID_Vendors_info[$v]->company_phone); exit;
	//echo $image; exit;
	$rateimage= 'https://camassistant.com/live'.DS.'components'.DS.'com_camassistant'.DS.'assets'.DS.'images'.DS.'rating'.DS;
			$db = JFactory::getDBO();
			$rating = "SELECT rating_sum FROM #__content_rating where content_id =".$BID_Vendors_info[$v]->proposedvendorid;
			$db->Setquery($rating);
			$rating = $db->loadResult();
			if ($rating > 0 && $rating <= 0.50)
			{ $rate_image = $rateimage.'5.png'; }
			elseif ($rating > 0.50 && $rating <= 1.00)
			{ $rate_image = $rateimage.'10.png'; }
			elseif ($rating > 1.00 && $rating <= 1.50)
			{ $rate_image = $rateimage.'15.png'; }
			elseif ($rating > 1.50 && $rating <= 2.00)
			{ $rate_image = $rateimage.'20.png'; }
			elseif ($rating > 2.00 && $rating <= 2.50)
			{ $rate_image = $rateimage.'25.png'; }
			elseif ($rating > 2.50 && $rating <= 3.00)
			{ $rate_image = $rateimage.'30.png'; }
			elseif ($rating > 3.00 && $rating <= 3.50)
			{ $rate_image = $rateimage.'35.png'; } 
			elseif ($rating > 3.50 && $rating <= 4.00)
			{ $rate_image = $rateimage.'40.png'; }
			elseif ($rating > 4.00 && $rating <= 4.50)
			{ $rate_image = $rateimage.'45.png'; }
			elseif ($rating > 4.50 && $rating <= 5.00)
			{ $rate_image = $rateimage.'50.png'; }
			else 
			{ $rate_image = $rateimage.'0.png'; }
			$htmlcontent .= '<tr><td align="center"> <img src="components/com_camassistant/assets/images/vendors/pdf_resized/'.$image.'"  />  </td></tr>';
			$htmlcontent .= '<tr><td height="30" align="center" style="font-size:19px ; text-align: center; ">'.$BID_Vendors_info[$v]->company_name.'</td></tr>'; 
			/*  '.$rating=plgVotitaly($BID_Vendors_info[$v]->proposedvendorid,$limitstart).' */
			/* <img src="templates/camassistant_left/images/rating.gif" width="75" height="15" /> */
			$htmlcontent .= '<tr><td border="0" style="font-size:19px ;text-align: center;">
			Vendor Apple Rating:<br>
			<img src="'.$rate_image.'" /></td></tr>
							<tr><td height="15" style="font-size:19px ; text-align: center; ">'.$BID_Vendors_info[$v]->company_address.',<br />'.$BID_Vendors_info[$v]->city.',<br />'.$vstate.' '.$BID_Vendors_info[$v]->zipcode.'</td>  </tr>
							<tr><td height="15" style="font-size:19px ; text-align: center; ">In-House Vendor? <strong>'. $BID_Vendors_info[$v]->in_house_vendor.'</strong></td></tr>
							
							<tr><td height="15" style="font-size:19px ; text-align: center; ">Company Phone: '. $BID_Vendors_info[$v]->company_phone.'</td>  </tr>';
							 if($BID_Vendors_info[$v]->phone_ext != '') $phone_ext = 'Extension: '.$BID_Vendors_info[$v]->phone_ext; else $phone_ext = 'Extension: N/A'; 
			 $htmlcontent .= '<tr><td height="15" style="font-size:19px ; text-align: center; ">'.$phone_ext.'</td></tr>';
							if($BID_Vendors_info[$v]->alt_phone != '') $alt_ext = $altphone.$BID_Vendors_info[$v]->alt_phone; else $alt_ext = 'Alt.Phone: N/A';
			 $htmlcontent .= '<tr><td height="15" style="font-size:19px ; text-align: center; ">'.$alt_ext.'</td></tr>';
							 if($BID_Vendors_info[$v]->alt_phone_ext != '') $alt_phone_ext = $altphoneext.$BID_Vendors_info[$v]->alt_phone_ext; else $alt_phone_ext = 'Alt.Extension: N/A';
			 $htmlcontent .= '<tr><td  height="15" style="font-size:19px ; text-align: center; ">'.$alt_phone_ext.'</td></tr>
							 <tr><td height="15" style="font-size:19px ; text-align: center;">Year Business Established: '.$BID_Vendors_info[$v]->established_year.'</td>
		  </tr>
							<tr><td height="30" style="font-size:19px ;text-align: center; ">Contact: '.$BID_Vendors_info[$v]->name.' '.$BID_Vendors_info[$v]->lastname.'</td></tr>
							<tr><td height="15" style="font-size:19px ;text-align: center; ">E-mail: '.$BID_Vendors_info[$v]->email.'</td></tr>';		
							/*if($BID_Vendors_info[$v]->extension != '') $extension = 'Extension: '.$BID_Vendors_info[$v]->extension; else $extension = 'Extension: N/A';
			  $htmlcontent .= '<tr><td height="15" style="font-size:19px ;text-align: center; ">'.$extension.'</td></tr>';*/
							if($BID_Vendors_info[$v]->cellphone != '') $cellphone = $BID_Vendors_info[$v]->cellphone; else $cellphone = 'Mobile Phone: N/A';
			 $htmlcontent .= '<tr><td height="15" style="font-size:19px ;text-align: center; ">'.$cellphone.'</td></tr>';
							if($v%2 == 0) $class = "#7ab800";  else $class = "#21314d";
		   $htmlcontent .= '<tr><td height="15" bgcolor="'.$class.'" style="color:#FFF; font-size:21px; font-weight:bold; font-family:ArialBlack; text-align: center; ">TOTAL AMOUNT PROPOSED</td></tr>';
							/*if($v%2 == 0) */
							$class = "color:#21314d; font-size:21px; font-weight:bold; font-family:ArialBlack; text-align: center; ";
							/*else $class = "color:#7ab800; font-size:21px; font-weight:bold;  font-family:ArialBlack;text-align:center";*/
							$addexp="SELECT count(*) FROM #__cam_rfpsow_addexception where rfp_id='".$RFP_info->id."' AND vendor_id='".$BID_Vendors_info[$v]->proposedvendorid."' ";
							$db->Setquery($addexp);
							$addexp = $db->loadResult();
							//echo '<pre>'; print_r($addexp); exit;
			$EXCEPTION_summary = $this->Alt_EXCEPTION_summary;
			if($EXCEPTION_summary[0]->task_exception){
			$as = '<font color="red">* </font>';
			}
			else {
			$as = '';
			}
							
							if ($addexp >'0'){
							$BID_Vendors_info[$v]->proposal_total_price = $BID_Vendors_info[$v]->proposal_total_price.'<font style="color:#FF0000;"> '.*.'</font>';
							}
		  $htmlcontent .= '<tr><td height="15" style="'.$class.'">$'.$BID_Vendors_info[$v]->proposal_total_price.'</td></tr>
						<tr><td height="15" style="font-size:19px ;text-align: center;">Alternate Proposal Provided?</td></tr>';
							$db = JFactory::getDBO();
							$sql = "SELECT proposal_total_price FROM #__cam_vendor_proposals where Alt_bid = 'yes' AND rfpno = ".sprintf('%d', $RFP_info->id)." AND proposedvendorid 	=".$BID_Vendors_info[$v]->proposedvendorid;
							$db->Setquery($sql);
							$Alt_Price = $db->loadResult();  if($Alt_Price != '') 
							{$res = 'Yes'; } else $res = 'No';
			$htmlcontent .=  '<tr><td height="15" style="font-size:19px ;text-align: center; color:#464646; font-weight:bold;  font-family:ArialBlack;">'.$res.'</td></tr>';
			if($Alt_Price != '')
			$Alt_Price = number_format( $Alt_Price ,2,'.',',' );
			if($Alt_Price != '') $Alt_Price = 'Alt.Price: $'.$Alt_Price; else $Alt_Price = 'Alt.Price: N/A';
			$htmlcontent .= '<tr><td height="15" style="font-size:19px ; text-align: center; color:#464646; font-weight:bold; font-family:ArialBlack;">'.$Alt_Price.'</td>
		  </tr>';				 
			$htmlcontent .= '</table></td>';
								}//inner if loop
							  }//end for loop 
							 }//if loop 

		
			$htmlcontent .= '</tr></table></td></tr><tr><td align="left" style="font-size:17px; "><br /><font color="red">*</font>Designates exception for 1 or more line items. 	Please see vendor notes for details.</td></tr></table>';
			// echo $htmlcontent; exit;
			$style = array('color' => array(220, 220, 220));
			$style7 = array('width' => 0.1, 'color' => array(220, 220, 220));
			$pdf->SetLineStyle($style7);
		$pdf->writeHTML($htmlcontent, true, 0, true, 0);
		
		// echo $htmlcontent; 
		if($loop_start < $loop_iterator-1){
		$pdf->AddPage();
		}
		/************************************************************End of 4th Page TASKS SUMMARY*************************************************************/
     }//end - for($loop_start=0, $loop_stop=1; $loop_start<count($BID_Vendors_info); $loop_start++,$loop_stop++)
	 
	/********************************************************** code to display vendor info htmlcontent ***************************************************/ 
	
	 /***********************************************RFP LINE ITEMS ADN VENDOR RESPONSES*************************************************************/
		
		$TASKS_summary = $this->Alt_TASKS_summary;
		$NOTES_summary = $this->Alt_NOTES_summary;
		$EXCEPTION_summary = $this->Alt_EXCEPTION_summary;
		$RFP_NOTES_summary = $this->RFP_NOTES_summary;
		$vendors_cnt = $this->vendors_cnt;
		
		//echo "<pre>"; print_r($TASKS_summary); exit;
			// add a page
		    $pdf->AddPage();
			$htmlcontent3 = '<table width="550px" border="0" cellspacing="0" cellpadding="3" align="center" style="padding-top:40px">'.
			$pdf->Image($pat.'properymanager/'.$RFP_info->comp_logopath, 10, 10, $width, $height, "", "", "", true, 550,'', false, false, 0, false, false, false); 
			$htmlcontent3 ='<tr><td width="235px" height="50" align="left" ></td>
							<td width="315px" align="right" style="text-align: right; font-size:21px;"><img width="50" height="12" src="templates/camassistant_left/images/mc_headicons.jpg" /><br/><strong><br/>'.$RFP_info->comp_name.'</strong><br />
		'.$RFP_info->mailaddress.'<br />'.$RFP_info->comp_city.','.$state_name.' '.$RFP_info->comp_zip.'<br /><strong>P</strong>: ('.$com_phone[0].')'.$com_phone[1].'-'.$com_phone[2].'</td>
			</tr>';
		
			$htmlcontent3 .='<tr><td colspan="2" height="15" bgcolor="#7ab800" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px ; text-align: center; ">RFP TASKS REQUESTED</td></tr>';
			
			$htmlcontent3 .= '<tr><td colspan="2">';
							 $line_cnt=count($RFP_NOTES_summary);
							 if($line_cnt>0)
							 { 
							 for($li=0; $li<$line_cnt; $li++)
							 {
							 $lid = $li+1;
							 if($RFP_NOTES_summary[$li]->title == '')
							 $RFP_NOTES_summary[$li]->title = 'NONE';
			$htmlcontent3 .='<tr><td colspan="2" style="font-size:20px; text-align: left;"><span style="color:#21314d; font-weight:bold;"><br /><br />LINE ITEM #'.$lid.':</span> '.$RFP_NOTES_summary[$li]->task_desc.'<p style="color:#7ab800; font-weight:bold;">Attachment #'.$lid.': '.$RFP_NOTES_summary[$li]->title.'</p></td></tr>';
			
			
							// for($v=(6*$loop_start); $v<(6*$loop_stop); $v++)
							for($v=0; $v<count($BID_Vendors_info); $v++)
							{
							 $x = 0;
							 if($v%2 == 0)
							 $class = "#7ab800";  
							  else 
							  $class = "#21314d";
							 $vid = $v+1;
			$htmlcontent3 .='<table width="100%" border="0" cellpadding="3" cellspacing="3">';
			$htmlcontent3 .='<tr><td height="15" width="22%"  bgcolor="'.$class.'" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px ; text-align: center; ">VENDOR '.$vid.' NOTES:</td></tr>';	
			/******************************************code to display NOTES*******************************************/
							$cnt_tasks=count($NOTES_summary); 
							if($cnt_tasks>0)
							{
							$flag = 0;
							$htmlcontent3 .= '<tr><td border="1" width="100%" height="15" style="font-size:19px ;text-align: left; ">';
								 for($T=0; $T<$cnt_tasks; $T++)
								 {
								   if($RFP_NOTES_summary[$li]->task_id == $NOTES_summary[$T]->task_id)
								   {
									 $cnt_notes = count($NOTES_summary[$T]->task_notes); 
									 //echo "<pre>"; print_r($NOTES_summary[$T]->task_notes); 
									 for($N=0; $N<$cnt_notes; $N++)
									 {
										if($NOTES_summary[$T]->task_notes[$N]->vendor_id == $BID_Vendors_info[$v]->proposedvendorid  )
										{
										  if($NOTES_summary[$T]->task_notes[$N]->add_notes != '')
									      {
										  $htmlcontent3 .= '<b>NOTES :</b><p>'.nl2br($NOTES_summary[$T]->task_notes[$N]->add_notes).'</p>';		
										  }
										  else
										  {
										  $htmlcontent3 .= '<b>NOTES : </b><p>NONE</p>';		
										  }
									    }
									 } 
								 } 
								} 
							}
				/******************************************code to display EXCEPTION *******************************************/
				$cnt_excep=count($EXCEPTION_summary); 
					if($cnt_excep>0)
							{
							$flag = 0;
								 for($E=0; $E<$cnt_excep; $E++)
								 {
								   if($RFP_NOTES_summary[$li]->task_id == $EXCEPTION_summary[$E]->task_id)
								   {
									 $cnt_Excep = count($EXCEPTION_summary[$E]->task_exception); 
									 for($F=0; $F<$cnt_Excep; $F++)
									 {
									    if($EXCEPTION_summary[$E]->task_exception[$F]->vendor_id == $BID_Vendors_info[$v]->proposedvendorid  )
										{
										  if($EXCEPTION_summary[$E]->task_exception[$F]->add_exception != '')
									      {
										  $htmlcontent3 .= '<p style="color:#FF0000"><b>EXCEPTION(S) :</b>&nbsp;<br />'.nl2br($EXCEPTION_summary[$E]->task_exception[$F]->add_exception).'</p>';		
										  }
										  else
										  {
										  $htmlcontent3 .= '<p style="color:#FF0000"><b>EXCEPTION(S) :</b>&nbsp;NONE</p>';		
										  }
									  }
									 } 
								 } 
								} 
							}
				/******************************************code to display vendor uploaded files *******************************************/	
				$cnt_uploades=count($TASKS_summary); 
					if($cnt_uploades>0)
							{
							$flag = 0;
								 for($A=0; $A<$cnt_uploades; $A++)
								 {
								   if($RFP_NOTES_summary[$li]->task_id == $TASKS_summary[$A]->task_id)
								   {
									 $cnt_Attachments = count($TASKS_summary[$A]->vendor_uploads); 
									 for($B=0; $B<$cnt_Attachments; $B++)
									 {
									    if($TASKS_summary[$A]->vendor_uploads[$B]->vendor_id == $BID_Vendors_info[$v]->proposedvendorid  )
										{
										  if($TASKS_summary[$A]->vendor_uploads[$B]->upload_doc != '')
									      {
										  $htmlcontent3 .= '<p><b>ATTACHMENT(S) :</b>&nbsp;<br />'.$TASKS_summary[$A]->vendor_uploads[$B]->title.'</p>';		
										  }
										  else
										  {
										  $htmlcontent3 .= '<p><b>ATTACHMENT(S) :</b>&nbsp;NONE</p>';		
										  }
									  }
									 } 
								 } 
								} 
							}	
				/******************************************code to display vendor line item prices *******************************************/	
				$cnt_prices=count($TASKS_summary); 
					if($cnt_prices>0)
							{
							$flag = 0;
								 for($TP=0; $TP<$cnt_prices; $TP++)
								 {
								   if($RFP_NOTES_summary[$li]->task_id == $TASKS_summary[$TP]->task_id)
								   {
									 $cnt_Task_Prices = count($TASKS_summary[$TP]->task_price); 
									 for($B=0; $B<$cnt_Task_Prices; $B++)
									 {
									    if($TASKS_summary[$TP]->task_price[$B]->vendor_id == $BID_Vendors_info[$v]->proposedvendorid  )
										{
										  if($TASKS_summary[$TP]->task_price[$B]->item_price != '')
									      {
										  $htmlcontent3 .= '<p><b>LINE ITEM PRICE :</b>&nbsp;<br />$ '.$TASKS_summary[$TP]->task_price[$B]->item_price.'</p>';		
										  }
										  else
										  {
										  $htmlcontent3 .= '<p><b>LINE ITEM PRICE :</b>&nbsp;NONE</p>';		
										  }
									  }
									 } 
								 } 
								} 
							}	
											
									
							$htmlcontent3 .='</td></tr>';
							$htmlcontent3 .= '</table>';
							}//end inner for loop 
							}//end main for loop 
							}//if($line_cnt>0)
		    $htmlcontent3 .= '</td></tr>';
			$htmlcontent3 .= '</table>'; 
			
			
		// echo $htmlcontent3; exit;
		$pdf->writeHTML($htmlcontent3, true, 0, true, 0);	
		// add a page
		//$pdf->AddPage();				 
		/**************************************************END RFP LINE ITEMS AND VENDOR RESPONSES*************************************************************/
		 $pdf->AddPage();
		 $vendors_cnt = $vendor_ids;
		 //echo "<pre>"; print_r($BID_AltVendors_info);
		
			$warranrtyinformation = '<table width="100%" border="0" cellspacing="0" cellpadding="3" align="center" style="padding-top:40px">';
								
			$warranrtyinformation .='<tr><td colspan="2" height="15" bgcolor="#21314d" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px ; text-align: center; ">WARRANTY INFORMATION</td></tr>';
			//$htmlcontentotherprice .='<tr><td colspan="2"><table border="1" width="100%" cellspacing="0" cellpadding="3"><tr><td style="font-size:19px; text-align: left; ">';	
			
							 
							$warranrtyinformation .= '<br/>';
							$count=count($BID_Vendors_info);
							if($BID_Vendors_info>0){ 
														
							for($w=0; $w<count($BID_Vendors_info); $w++) { 
							
							$db =& JFactory::getDBO();
			 $sql = "SELECT warranty_filepath,warranty_file_text,warranty_file_area FROM #__cam_vendor_proposals where rfpno = ".$RFP_info->id." AND Alt_bid='yes' AND proposedvendorid=".$BID_Vendors_info[$w]->proposedvendorid;
				$db->Setquery($sql);
				$warranty = $db->loadObjectList();
				//echo '<pre>'; print_r($warranty);
				$x = 0;
							 if($w%2 == 0)
							 $class = "#7ab800";  
							  else 
							  $class = "#21314d";
							 $wid = $w+1;
							 	$warranrtyinformation .='<tr><td height="15" width="35%" bgcolor="'.$class.'" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px ; text-align: left; ">VENDOR '.$wid.' warranrtyinformation:</td></tr>';
							$warrantylink='<a style="color:#7AB800; text-decoration:none;" href="'.JURI::root().'index2.php?option=com_camassistant&controller=proposals&task=downloadfile&title='.$warranty[0]->warranty_file_text.'&path='.$warranty[0]->warranty_filepath.'">'.$warranty[0]->warranty_file_text.'</a>';
				 if($warranty[0]->warranty_file_text != '' && $warranty[0]->warranty_filepath != '')
				{
				$warrantylink1 = $warrantylink;
				}
				else {
				$warrantylink1 = 'No Files';
				}
				if($warranty[0]->warranty_file_area != '')
				{
				$warranty_file_area = $warranty[0]->warranty_file_area;
				}
				else{
				$warranty_file_area = 'No text entered. If no attachment is provided, please contact vendor.';
				}
							
							$warranrtyinformation .= '<tr><td border="1" width="100%" height="15" style="font-size:19px ;text-align: left; ">';
							$warranrtyinformation .= 'WARRANTY-INFO: '.$warrantylink1.'<br/>'; 
							$warranrtyinformation .= 'Warranty: '.$warranty_file_area.'</td></tr>'; 
							//$warranrtyinformation .=  '<tr><td bgcolor="'.$class.'" style="color:#ffffff; font-color:#ffffff; font-weight:bold; font-family:ArialBlack; font-size:16px; height:15px; border:1px solid gray; text-align: left;" width="10%">WARRANTY-INFO: '.$cnt.':</td><td width="20%" style="text-align: left;"  style="border:1px solid gray; color:gray; font-size:16px; font-weight:bold;">$ '.$other_price.' </td></tr>';
									
							 } 

							}
			$warranrtyinformation .='<tr><td>&nbsp;</td></tr>'; 
		    $warranrtyinformation .= '</table>';	
			
//echo 'anand__';
	 //$warranrtyinformation;  
	// exit;
		$pdf->writeHTML($warranrtyinformation, true, 0, true, 0);	
				 $pdf->AddPage();
		 //$vendors_cnt = $vendor_ids;
		  $vendors_cnt = $this->vendors_cnt; 
		
			$htmlaltotherprice = '<table width="100%" border="0" cellspacing="0" cellpadding="3" align="center" style="padding-top:40px">';
								
			$htmlaltotherprice .='<tr><td colspan="2" height="15" bgcolor="#21314d" style="color:#FFF; font-weight:bold; font-family:ArialBlack; font-size:21px ; text-align: center; ">All other items, charges & fees not itemized above</td></tr>';
			//$htmlcontentotherprice .='<tr><td colspan="2"><table border="1" width="100%" cellspacing="0" cellpadding="3"><tr><td style="font-size:19px; text-align: left; ">';	
			
							$htmlaltotherprice .= '<br/><br/>';
							//$count=count($BID_AltVendors_info);
							$vendors_cnt=count($BID_Vendors_info);
							if($vendors_cnt>0){ 
														
							for($z=0; $z<count($BID_Vendors_info); $z++) { 
							//echo '<pre>'; print_r($BID_Vendors_info[$z]);
							$db =& JFactory::getDBO();
							$other_price_sql = "SELECT `price_other_items` FROM #__cam_vendor_proposals  where rfpno='".$RFP_info->id."' AND proposedvendorid  ='".$BID_Vendors_info[$z]->proposedvendorid. "' AND Alt_bid = 'yes' "; 
							$db->setQuery($other_price_sql); 
							$other_price = $db->loadResult();  
							if(!$other_price)
							$other_price = '0.00';
							else
							//$other_price = $other_price;
							$other_price = number_format( $other_price , 2 , '.' ,',' );
					echo "PRICE".$other_price;
							//exit;
							
							$cnt = $z+1;
							 if($z%2 == 0)
							 $class = "#7ab800";  
							  else 
							  $class = "#21314d";
							  if($z != 0)
							$htmlaltotherprice .= '<br/>';
							$htmlaltotherprice .=  '<tr><td bgcolor="'.$class.'" style="color:#ffffff; font-color:#ffffff; font-weight:bold; font-family:ArialBlack; font-size:16px; height:15px; border:1px solid gray; text-align: left;" width="10%">VENDOR '.$cnt.':</td><td width="20%" style="text-align: left;"  style="border:1px solid gray; color:gray; font-size:16px; font-weight:bold;"> $ '.$other_price.' </td></tr>';
									
							 } 

							}
		//	$htmlcontentotherprice .='</td></tr></table>'; 
		    $htmlaltotherprice .= '</table>';	
			
//echo 'anand__';
//echo $htmlaltotherprice; 
		$pdf->writeHTML($htmlaltotherprice, true, 0, true, 0);	

	} //end - if(count($BID_Vendors_info)>0)
	if(count($this->BiddedVendorsInfo)== 0 && count($this->Alt_BiddedVendorsInfo) == 0 )
	{
	$htmlcontent = "<font>No Proposals are Available for this RFP.  If you have questions or need assistance, please contact the CAMassistant Customer Support Team at 561-246-3830.  Thank you.</font>";
	$pdf->writeHTML($htmlcontent, true, 0, true, 0);
	}
	
	/******* eof table pan********/
	
	
	$pdf->lastPage();
	$title= $RFP_info->comp_name.'.pdf'; //set title
	$pdf->SetTitle($title);//set title
	ob_end_clean();
	$upl_file_name=$pdf->Output($title, 'I');
	//$upl_file_name=$pdf->Output($title, 'D');

 ?>
