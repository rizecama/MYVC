<?php
/**
 * @version		1.0.0 camassistant $
 * @package		camassistant
 * @copyright	Copyright © 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');

jimport( 'joomla.application.component.model' );

class rfpModelProperty extends Jmodel
{
	function __construct()
	{
		parent::__construct();
		global $mainframe, $context;
		//initialize class property
	  	$this->_table_prefix = '#__cam_property';	
		//DEVNOTE: Get the pagination request variables
		$limit = $mainframe->getUserStateFromRequest( $context.'limit', 'limit', $mainframe->getCfg('list_limit'), 0);
		$limitstart = JRequest::getVar('limitstart', 0, '', 'int');
		if($limit==0 && $limitstart>0 && $limitstart!=$lmit)
		{
			$limitstart=0;
			$limit=0;
		}
		$this->setState('limit', $limit);
		$this->setState('limitstart', $limitstart);
	}
	//function to display Properties list in the Dropdown
	function getProperties() 
	{
		global $mainframe;
		$db=&JFactory::getDBO();
		$query = "SELECT id as value,property_name as text FROM #__cam_property ORDER BY id ASC";
		$db->setQuery($query);
		$propertyList = $db->loadObjectList();
		return $propertyList;
	}
	//function to get Tax ids list
	function getProperty_TaxIDs() 
	{
		global $mainframe;
		$db=&JFactory::getDBO();
		$query = "SELECT tax_id FROM #__cam_property ORDER BY id ASC";
		$db->setQuery($query);
		$ptaxid = $db->loadObjectList();
		return $ptaxid;
	}
	//
	function store($data)
	{
		// give me JTable object			 	
		$row =& $this->getTable('property');
		//JTable::addIncludePath(JPATH_ADMINISTRATOR.DS.'components'.DS.'com_camassistant'.DS.'tables');
		//$row =& JTable::getInstance('recipes', 'Table');
	
		// Bind the form fields to the  table
		if (!$row->bind($data)) {
			$this->setError($this->_db->getErrorMsg());
			return false;
		}

		// Store the  detail record into the database
		if (!$row->store()) {
			$this->setError($this->_db->getErrorMsg()); 
			return false;
		}
		return true;
	}

}
?>