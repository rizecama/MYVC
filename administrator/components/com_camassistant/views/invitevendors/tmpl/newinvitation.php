<?php  $user =& JFactory::getUser();
/**
 * @version		1.0.0 cam assistant $
 * @package		cam_assistant
 * @copyright	Copyright © 2010 - All rights reserved.
 * @license		GNU/GPL
 * @author		
 * @author mail	nobody@nobody.com
 *
 *
 * @MVC architecture generated by MVC generator tool at http://www.alphaplug.com
 */

// no direct access
defined('_JEXEC') or die('Restricted access');

// Your custom code here


?>
<link href="<?php JPATH_SITE ?>components/com_camassistant/assets/popup.css" rel="stylesheet" type="text/css"/>

<script type="text/javascript" src="components/com_camassistant/editor/ed.js"></script>  
<link rel="stylesheet" media="all" type="text/css" href="<?php echo Juri::base(); ?>components/com_camassistant/skin/css/jquery1.css" />		
<script type="text/javascript" src="<?php echo Juri::base(); ?>components/com_camassistant/skin/js/jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="<?php echo Juri::base(); ?>components/com_camassistant/skin/js/jquery-ui-1.8.6.custom.min.js"></script>
<script type="text/javascript" src="<?php echo Juri::base(); ?>components/com_camassistant/skin/js/jquery-ui-timepicker-addon.js"></script>
<script type="text/javascript">
H = jQuery.noConflict();
function exclude(){
alert("can");
var tax1=H("#tax1").val();
var tax2=H("#tax2").val();
if(tax1 == '' || tax2 ==''){
alert("Please enter TAX ID.");
return false;
}
else{
document.forms["newinvite"].submit();
}
}
function checkemail(){
var email=H("#inhouse").val();
var user=H("#camid").val();
if(email){
		H.post("index2.php?option=com_camassistant&controller=invitevendors&task=verfiryemailid&userval="+user+"", {queryString: ""+email+""}, function(data){
		
		if(data == 'invalid'){
		 var firstline = 'Sorry, you have already assigned a Vendor Status to this email address.';
		 var secondline = '  To assign a different status to this vendor, you must click \"Remove Vendor\" to clear the vendor\'s status, and then re-invite/exclude them.';
		 var thirdline = firstline+'\n\n'+secondline;
 		alert(thirdline);
		return false;
		}
		else
		{
		document.forms["newinvite"].submit();
		}
			});
			}
else{
var tax1=H("#tax1").val();
var tax2=H("#tax2").val();
var tax=tax1+-+tax2;
H.post("index2.php?option=com_camassistant&controller=invitevendors&task=verfiryexcludeid&userval="+user+"", {queryString: ""+tax+""}, function(data){
		if(data == 'invalid'){
		alert("Already, the vendor with this TAX ID excluded by you.");
		return false;
		}
		else{
		document.forms["newinvite"].submit();
		}
		});

}
			
}

function geturl(){
var article=H("#articletype").val();
H.post("index2.php?option=com_camassistant&controller=invitevendors&task=article", {queryString: ""+article+""}, function(data){
document.getElementById('mytxtarea').value=data;
});
}
</script>
<script type="text/javascript">

  function invite_type(type){
  if(type=='inhouse' || type=='preferred'){
  document.getElementById('form_row_invite').style.display='';
  document.getElementById('txt_box_midbg_invitation').style.display='';
  document.getElementById('semdInvitation').style.display=''; 
   document.getElementById('excludevendor').style.display='none';  
  document.getElementById('form_row').style.display='none';  
  document.getElementById('txt_box_midbg').style.display='none';   
  }
  if(type=='exclude'){
  document.getElementById('form_row').style.display='';  
  document.getElementById('txt_box_midbg').style.display='';   
  document.getElementById('excludevendor').style.display='';  
  document.getElementById('form_row_invite').style.display='none';
  document.getElementById('txt_box_midbg_invitation').style.display='none';   
  document.getElementById('semdInvitation').style.display='none';  
  }
  
  }
  function getuser(user){
  document.getElementById('userid').value = user;
  }
	</script>

<div id="l_box">
<form style="padding:0px; margin:0px;" action="<?php echo JRoute::_( 'index.php' ); ?>" method="post" name="mailform" id="newinvite" >
<div id="l_box_topcurve">
  <div id="l_box_close"></div><div class="form_text">All Managers:</div>
 <select name="camid" id="camid" onchange="javascript:getuser(this.value);">
 <option value="0">Select Manager</option>
<?php 

for ($i=0; $i<count($this->managers); $i++){
$custmers = $this->managers[$i];   ?>
<option value="<?php echo $custmers->id; ?>"><?php echo $custmers->name.' '.$custmers->lastname; ?> </option>
<?php }  ?>
 </select> 
</div>


<div id="l_box_topcurve">
  <div id="l_box_close"></div><div class="form_text">Vendor Type:</div>
 <select id="vendortype" name="vendortype" onchange="javascript:invite_type(this.value);">
 <option value="0">Select Type</option>
 <option value="inhouse">In House Vendor</option>
 <option value="preferred">Preferred Vendor</option>
 <option value="exclude">Exclude Vendor</option>
 </select>
</div>
<div id="l_box_topcurve">
  <div id="l_box_close"></div><div class="form_text">Article Type:</div>
 <select id="articletype" name="articletype" onchange="javascript:geturl();">
 <option value="0">Please Select</option>
 <option value="normal">Normal Article</option>
 <option value="high">High Level Article</option>
 </select>
</div>

<div id="l_box_midbg">
<!--Excluding.....................-->
<div class="form_row" id="form_row" style="display:none;"><div class="form_text">Vendor Tax ID:</div><label></label>
<input value="" maxlength="2" type="text" name="tax1" id="tax1" style="width:40px; height:24px; text-align:center;"/>&nbsp;&nbsp;
<input value="" maxlength="7" type="text" name="tax2" id="tax2" style="width:100px; height:24px; text-align:center" />
<div class="clear"></div></div>
<!--Excluding.....................-->
<!--Sencidng invitation.....................-->
<div class="form_row_invite" id="form_row_invite" style="display:none;"><div class="form_text">To:</div><label></label>
<input value="" type="text" id="inhouse" name="inhouse" style="width:390px;" onblur="verifyemailid();"/>
<div class="clear"></div></div>
<!--Sencidng invitation form completed.....................-->

<div class="form_row_button">
<div class="form_text">&nbsp;</div>
<div id="txt_box">
<!--<div id="txt_box_topcurve"></div>-->
<div id="txt_box_midbg" style="display:none;"><!--<h1>Enter your text here:</h1>-->
<!--<script>edToolbar('mytxtarea'); </script>-->
<div class="clear"></div>
<?php 
$data = $data.'<br><br>Note that you can get the tax ID for the Vendor you wish to block from either the W-9 included with any proposal submitted through CAMassistant, or from the State`s Department of Corporations or equivalent.<br><br> ';
$tags = array("<p>","</p>","<br>","<br />");
$rtags = array("","\n","\n","\n");
$data = str_replace($tags, $rtags, $data);
//echo $data;
 ?>
<textarea name="inhousetext" id="mytxtareaf" class="ed" style=" width:361px; height:150px;" readonly="readonly"  ><?php echo $data; ?></textarea>
<div class="clear"></div>
<textarea name="inhousetext1" id="mytxtarea1"  type="hidden"  style=" display:none; width:361px; height:150px;"  ><?php //echo $this->tdata; ?></textarea>
<div class="clear"></div>
</div>

<div id="txt_box_midbg_invitation" style="display:none">
<div class="clear"></div>
<?php $tags = array("<p>","</p>","<br>","<br />");
$rtags = array("","\n","\n","\n");
$msg = str_replace($tags, $rtags, $this->msg);
$msg = str_replace('Preferred','',$msg);
?>
<textarea name="inhousetext" id="mytxtarea" readonly="readonly" class="ed" style=" width:388px; height:150px;"  ><?php echo $msg; ?></textarea>
<div class="clear"></div>
<textarea name="inhousetext1" id="mytxtarea1"  type="hidden"  style=" display:none; width:388px; height:150px;"  ><?php echo $this->tdata; ?></textarea>
<div class="clear"></div>
</div>
<!--<input type="image" src="images/send_invitation.png" id="semdInvitation" style="display:none" onclick="javascript:checkemail();" />-->
<img src="images/send_invitation.png" id="semdInvitation" style="display:none" onclick="javascript:checkemail();"/>
<img src="images/submittaxid.png" id="excludevendor" style="display:none" onclick="javascript:checkemail();"/>
<!--<input type="image" src="images/submittaxid.png" id="excludevendor" style="display:none" />-->
<input type="hidden" name="option" value="com_camassistant" />
<input type="hidden" name="controller" value="invitevendors" />
<input type="hidden" id="userid" name="userid" value="" />
<input type="hidden" name="task" value="inhousevendors"/>
<input type="hidden" name="Itemid" value="<?php echo $_REQUEST['Itemid']; ?>" />
<?php echo JHTML::_( 'form.token' ); ?>


<!--<div id="txt_box_botomcurve"></div>-->
</div>
<div class="clear"></div></div>

<div class="form_row">
<div id="txt_box"></div>
<div class="clear"></div>
</div>

<div class="clear"></div>
</div>
</form>

<!--<div id="l_box_botomcurve"></div>-->

</div>
<?php exit; ?>
</div>
</body>
</html>
